<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>AT Driver</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 3f621ba99, updated Mon Jul 28 15:38:36 2025 -0700" name="generator">
  <link href="https://w3c.github.io/at-driver/" rel="canonical">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <meta content="3e15ec4aeee6fab7010664e46cc84c989a74b314" name="revision">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
table { border-collapse: collapse; border-style: hidden hidden none hidden; }
table thead, table tbody { border-bottom: solid; }
table tbody th { text-align: left; }
table tbody th:first-child { border-left: solid; }
table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
</style>
<style>
table { border-collapse: collapse; border-style: hidden hidden none hidden; }
table thead, table tbody { border-bottom: solid; }
table tbody th { text-align: left; }
table tbody th:first-child { border-left: solid; }
table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }

kbd:not(:has(kbd)) {
  border-radius: 0.2em;
  padding: 0.2em;
  border: 1px solid rgba(0, 0, 0, 0.4);
  background-color: rgba(0, 0, 0, 0.05);
}
</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-cddl-highlighting */
pre.cddl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
</a>
</p>
   <h1 class="p-name no-ref" id="title">AT Driver</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types/#ED">Editor’s Draft</a>,
    <time class="dt-updated" datetime="2025-09-04">4 September 2025</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/at-driver/">https://w3c.github.io/at-driver/</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/w3c/at-driver/issues/">GitHub</a>
      <dd><a href="#issues-index">Inline In Spec</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mike@bocoup.com">Mike Pennisi</a> (<a class="p-org org" href="https://bocoup.com">Bocoup</a>)
      <dt class="editor">Former Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:simon@bocoup.com">Simon Pieters</a> (<a class="p-org org" href="https://bocoup.com">Bocoup</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2025 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply.
</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>A protocol for introspection and remote control of assistive technology software</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p>
  <em>This section describes the status of this document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> standards and drafts index</a>.</em>
</p>
   <p>
  <a href="https://github.com/w3c/at-driver/issues">GitHub Issues</a> are preferred for discussion of this specification. Alternatively, you can send comments to the Browser Testing and Tools Working Group’s mailing list, <a href="mailto:public-browser-tools-testing@w3.org">public-browser-tools-testing@w3.org</a> (<a href="https://lists.w3.org/Archives/Public/public-browser-tools-testing/">archives</a>).
</p>
   <p>
  This document was published by the <a href="https://www.w3.org/groups/wg/browser-tools-testing/">Browser Testing and Tools Working Group</a> as an Editor’s Draft.
</p>
   <p>
  Publication as an Editor’s Draft does not imply endorsement by
    <abbr title="World Wide Web Consortium">W3C</abbr> and its Members.
</p>
   <p>
  This is a draft document and may be updated, replaced, or obsoleted by other documents at any time.
  It is inappropriate to cite this document as other than a work in progress.
</p>
   <p>
  This document was produced by a group operating under the <a class="css" data-link-type="property" href="https://www.w3.org/policies/patent-policy/" id="sotd_patent">W3C Patent Policy</a>.
  <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/groups/wg/browser-tools-testing/ipr/" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent that the individual believes contains <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
</p>
   <p>
  This document is governed by the <a href="https://www.w3.org/policies/process/20250818/" id="w3c_process_revision">18 August 2025 W3C Process Document</a>.
</p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#explainer"><span class="secno">2</span> <span class="content">Explainer</span></a>
     <ol class="toc">
      <li><a href="#explainer-example"><span class="secno">2.1</span> <span class="content">Example</span></a>
     </ol>
    <li><a href="#infra"><span class="secno">3</span> <span class="content">Infrastructure</span></a>
    <li><a href="#nodes"><span class="secno">4</span> <span class="content">Nodes</span></a>
    <li>
     <a href="#protocol"><span class="secno">5</span> <span class="content">Protocol</span></a>
     <ol class="toc">
      <li><a href="#protocol-definition"><span class="secno">5.1</span> <span class="content">Definition</span></a>
      <li><a href="#protocol-capabilities"><span class="secno">5.2</span> <span class="content">Capabilities</span></a>
      <li><a href="#protocol-session"><span class="secno">5.3</span> <span class="content">Session</span></a>
      <li><a href="#protocol-modules"><span class="secno">5.4</span> <span class="content">Modules</span></a>
      <li><a href="#protocol-commands"><span class="secno">5.5</span> <span class="content">Commands</span></a>
      <li><a href="#protocol-events"><span class="secno">5.6</span> <span class="content">Events</span></a>
      <li><a href="#protocol-errors"><span class="secno">5.7</span> <span class="content">Errors</span></a>
      <li><a href="#security-checks"><span class="secno">5.8</span> <span class="content">Security checks</span></a>
     </ol>
    <li>
     <a href="#transport"><span class="secno">6</span> <span class="content">Transport</span></a>
     <ol class="toc">
      <li><a href="#transport-establishing"><span class="secno">6.1</span> <span class="content">Establishing a Connection</span></a>
     </ol>
    <li>
     <a href="#modules"><span class="secno">7</span> <span class="content">Modules</span></a>
     <ol class="toc">
      <li>
       <a href="#module-session"><span class="secno">7.1</span> <span class="content">The session Module</span></a>
       <ol class="toc">
        <li><a href="#module-session-definition"><span class="secno">7.1.1</span> <span class="content">Definition</span></a>
        <li>
         <a href="#module-session-types"><span class="secno">7.1.2</span> <span class="content">Types</span></a>
         <ol class="toc">
          <li><a href="#module-session-CapabilitiesRequest"><span class="secno">7.1.2.1</span> <span class="content">The session.CapabilitiesRequest Type</span></a>
         </ol>
        <li>
         <a href="#module-session-commands"><span class="secno">7.1.3</span> <span class="content">Commands</span></a>
         <ol class="toc">
          <li><a href="#module-session-new"><span class="secno">7.1.3.1</span> <span class="content">The session.new Command</span></a>
         </ol>
       </ol>
      <li>
       <a href="#module-settings"><span class="secno">7.2</span> <span class="content">The settings Module</span></a>
       <ol class="toc">
        <li><a href="#module-settings-definition"><span class="secno">7.2.1</span> <span class="content">Definition</span></a>
        <li>
         <a href="#module-settings-types"><span class="secno">7.2.2</span> <span class="content">Types</span></a>
         <ol class="toc">
          <li><a href="#module-settings-get-settings-result"><span class="secno">7.2.2.1</span> <span class="content">The SettingsGetSettingsResult type</span></a>
         </ol>
        <li>
         <a href="#module-settings-commands"><span class="secno">7.2.3</span> <span class="content">Commands</span></a>
         <ol class="toc">
          <li><a href="#command-settings-set-settings"><span class="secno">7.2.3.1</span> <span class="content">The settings.setSettings Command</span></a>
          <li><a href="#command-settings-get-settings"><span class="secno">7.2.3.2</span> <span class="content">The settings.getSettings Command</span></a>
          <li><a href="#command-settings-get-supported-settings"><span class="secno">7.2.3.3</span> <span class="content">The settings.getSupportedSettings Command</span></a>
         </ol>
        <li><a href="#module-settings-events"><span class="secno">7.2.4</span> <span class="content">Events</span></a>
       </ol>
      <li>
       <a href="#module-interaction"><span class="secno">7.3</span> <span class="content">The Interaction Module</span></a>
       <ol class="toc">
        <li><a href="#module-interaction-definition"><span class="secno">7.3.1</span> <span class="content">Definition</span></a>
        <li><a href="#module-interaction-types"><span class="secno">7.3.2</span> <span class="content">Types</span></a>
        <li>
         <a href="#module-interaction-commands"><span class="secno">7.3.3</span> <span class="content">Commands</span></a>
         <ol class="toc">
          <li><a href="#module-interaction-userintent"><span class="secno">7.3.3.1</span> <span class="content">The interaction.userIntent Command</span></a>
         </ol>
        <li>
         <a href="#module-interaction-events"><span class="secno">7.3.4</span> <span class="content">Events</span></a>
         <ol class="toc">
          <li><a href="#event-interaction-capturedOutput"><span class="secno">7.3.4.1</span> <span class="content">The interaction.capturedOutput Event</span></a>
         </ol>
       </ol>
     </ol>
    <li><a href="#privacy"><span class="secno">8</span> <span class="content">Privacy</span></a>
    <li><a href="#security"><span class="secno">9</span> <span class="content">Security</span></a>
    <li><a href="#schemas"><span class="secno"></span> <span class="content">Appendix A: Schemas</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li>
     <a href="#cddl-index"><span class="secno"></span> <span class="content">CDDL Index</span></a>
     <ol class="toc">
      <li><a href="#cddl-index-cddl-module-remote-end-definition"><span class="secno"></span> <span class="content">Remote end definition</span></a>
      <li><a href="#cddl-index-cddl-module-local-end-definition"><span class="secno"></span> <span class="content">Local end definition</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>AT Driver defines a protocol for introspection and remote control of assistive technology software, using a bidirectional communication channel.</p>
   <h2 class="heading settled" data-level="2" id="explainer"><span class="secno">2. </span><span class="content">Explainer</span><a class="self-link" href="#explainer"></a></h2>
   <p>Specify a protocol using WebSocket that maximally reuses concepts and conventions from <a href="https://w3c.github.io/webdriver-bidi/">WebDriver BiDi</a>.</p>
   <p>A connection has two endpoints: remote and local. The remote end can control and read from the screen reader, which can either be implemented as a standalone application or be implemented as part of the AT software. The local end is what the test interfaces with, usually in the form of language-specific libraries providing an API.</p>
   <p>There should only be the WebSocket form of communication -- as in <a href="https://w3c.github.io/webdriver-bidi/#supports-bidi-only-sessions">BiDi-only sessions for WebDriver BiDi</a>.</p>
   <p>A connection can have 0 or more <a data-link-type="dfn" href="#session" id="ref-for-session">sessions</a>. Each session corresponds to an instance of an AT. We may limit the maximum number of sessions per AT to 1 initially.</p>
   <p>When a remote end supports multiple sessions, it does not necessarily mean that there will be multiple ATs running at the same time in the same instance of an OS. Some ATs might not be able to function properly if there are other ATs running at the same time. The AT Driver <a data-link-type="dfn" href="#session" id="ref-for-session①">session</a> concept can still be used by having the remote end run in a separate environment and each AT is run in its own OS instance (for example in a virtual machine), and the remote end proxies messages in some fashion.</p>
   <p>Commands are grouped into <a data-link-type="dfn" href="#module" id="ref-for-module">modules</a>. The modules could be: Sessions, Settings, Actions.</p>
   <p>Message transport is provided using the WebSocket protocol.</p>
   <p>The protocol is defined using a Concise Data Definition Language (CDDL) definition. The serialization is JSON.</p>
   <h3 class="heading settled" data-level="2.1" id="explainer-example"><span class="secno">2.1. </span><span class="content">Example</span><a class="self-link" href="#explainer-example"></a></h3>
   <p>First, the local end would establish a WebSocket connection.</p>
   <p>The local end then creates a session by sending</p>
<pre class="language-json highlight"><c- p>{</c-><c- f>"method"</c-><c- p>:</c-><c- u>"session.new"</c-><c- p>,</c-><c- f>"params"</c-><c- p>:{</c->...<c- p>}}</c->
</pre>
   <p>The local end can then send commands to change settings or send key press actions for that session. The local end assigns a command id (which is included in the message). The remote end sends a message back with the result and the command id, so the local end knows which command the message applies to.</p>
   <p>When the screen reader speaks, the remote end will send a message as to the local end with the spoken text. This could be in the form of an event, which is not tied to any particular command.</p>
   <h2 class="heading settled" data-level="3" id="infra"><span class="secno">3. </span><span class="content">Infrastructure</span><a class="self-link" href="#infra"></a></h2>
   <p>This specification depends on the Infra Standard. <a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a></p>
   <p>Network protocol messages are defined using CDDL. <a data-link-type="biblio" href="#biblio-rfc8610" title="Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures">[RFC8610]</a></p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="UUID" data-noexport id="uuid">Universally Unique Identifier (UUID)</dfn> is a 128 bits long URN that requires no central registration process. <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="generating-a-uuid">Generating a UUID</dfn> means creating a <i>UUID Version 4</i> value and converting it to the string representation. <a data-link-type="biblio" href="#biblio-rfc9562" title="Universally Unique IDentifiers (UUIDs)">[RFC9562]</a></p>
   <p>Where algorithms that return values are fallible, they are written in terms of returning either <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="success">success</dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="error">error</dfn>. A <a data-link-type="dfn" href="#success" id="ref-for-success">success</a> value has an associated data field which encapsulates the value returned, whereas an <a data-link-type="dfn" href="#error" id="ref-for-error">error</a> response has an associated <a data-link-type="dfn" href="#error-code" id="ref-for-error-code">error code</a>.</p>
   <p>When calling a fallible algorithm, the construct "Let <var>result</var> be the result of <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="try|trying" data-noexport id="try">trying</dfn> to call <var>algorithm</var>" is equivalent to:</p>
   <ol>
    <li data-md>
     <p>Let <var>temp</var> be the result of calling <var>algorithm</var>.</p>
    <li data-md>
     <p>If <var>temp</var> is an <a data-link-type="dfn" href="#error" id="ref-for-error①">error</a>, then return <var>temp</var>. Otherwise, let <var>result</var> be <var>temp</var>’s data field.</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> This means that errors are propagated upwards when using "trying".</p>
   <h2 class="heading settled" data-level="4" id="nodes"><span class="secno">4. </span><span class="content">Nodes</span><a class="self-link" href="#nodes"></a></h2>
   <p>The AT Driver protocol consists of communication between:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="local-end">local end</dfn>
    <dd data-md>
     <p>The local end represents the client side of the protocol, which is usually in the form of language-specific libraries providing an API on top of the AT Driver protocol. This specification does not place any restrictions on the details of those libraries above the level of the wire protocol.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="remote-end">remote end</dfn>
    <dd data-md>
     <p>The remote end hosts the server side of the protocol. The remote end is responsible for driving and listening to the assistive technology and sending information to the local end as defined in this specification.</p>
   </dl>
   <h2 class="heading settled" data-level="5" id="protocol"><span class="secno">5. </span><span class="content">Protocol</span><a class="self-link" href="#protocol"></a></h2>
   <p>This section defines the basic concepts of the AT Driver protocol. These terms are distinct from their representation at the transport layer.</p>
   <p>The protocol is defined using a CDDL definition. For the convenience of implementors two separate CDDL definitions are defined; the <dfn class="dfn-paneled" data-dfn-type="cddl-module" data-lt="Remote end definition|remote end definition|remote-cddl" data-noexport id="cddl-module-remote-end-definition">remote end definition</dfn> which defines the format of messages produced on the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end">local end</a> and consumed on the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end">remote end</a>, and the <dfn class="dfn-paneled" data-dfn-type="cddl-module" data-lt="Local end definition|local end definition|local-cddl" data-noexport id="cddl-module-local-end-definition">local end definition</dfn> which defines the format of messages produced on the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①">remote end</a> and consumed on the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end①">local end</a>.</p>
   <h3 class="heading settled" data-level="5.1" id="protocol-definition"><span class="secno">5.1. </span><span class="content">Definition</span><a class="self-link" href="#protocol-definition"></a></h3>
   <p>This section gives the initial contents of the remote end definition and local end definition. These are augmented by the definition fragments defined in the remainder of the specification.</p>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition">Remote end definition</a></code></p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-command"><code>Command</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="Command" data-dfn-type="cddl-key" data-lt="id|&quot;id&quot;" data-noexport id="cddl-key-command-id"><code>id</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D">uint</a>,
  <a data-link-type="cddl" href="#cddl-type-commanddata" id="ref-for-cddl-type-commanddata">CommandData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible">Extensible</a>,
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-commanddata"><code>CommandData</code></dfn> = (
  <a data-link-type="cddl" href="#cddl-type-sessioncommand" id="ref-for-cddl-type-sessioncommand">SessionCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingscommand" id="ref-for-cddl-type-settingscommand">SettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-interactioncommand" id="ref-for-cddl-type-interactioncommand">InteractionCommand</a>
)

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-emptyparams"><code>EmptyParams</code></dfn> = { <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible①">Extensible</a> }
</pre>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition">Local end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-message"><code>Message</code></dfn> = (
  <a data-link-type="cddl" href="#cddl-type-commandresponse" id="ref-for-cddl-type-commandresponse">CommandResponse</a> //
  <a data-link-type="cddl" href="#cddl-type-errorresponse" id="ref-for-cddl-type-errorresponse">ErrorResponse</a> //
  <a data-link-type="cddl" href="#cddl-type-event" id="ref-for-cddl-type-event">Event</a>
)

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-commandresponse"><code>CommandResponse</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="CommandResponse" data-dfn-type="cddl-key" data-lt="id|&quot;id&quot;" data-noexport id="cddl-key-commandresponse-id"><code>id</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①">uint</a>,
  <dfn class="dfn-paneled" data-dfn-for="CommandResponse" data-dfn-type="cddl-key" data-lt="result|&quot;result&quot;" data-noexport id="cddl-key-commandresponse-result"><code>result</code></dfn>: <a data-link-type="cddl" href="#cddl-type-resultdata" id="ref-for-cddl-type-resultdata">ResultData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible②">Extensible</a>,
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-errorresponse"><code>ErrorResponse</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="ErrorResponse" data-dfn-type="cddl-key" data-lt="id|&quot;id&quot;" data-noexport id="cddl-key-errorresponse-id"><code>id</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D②">uint</a> / <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D③">null</a>,
  <dfn class="dfn-paneled" data-dfn-for="ErrorResponse" data-dfn-type="cddl-key" data-lt="error|&quot;error&quot;" data-noexport id="cddl-key-errorresponse-error"><code>error</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="ErrorResponse/error" data-dfn-type="cddl-value" data-lt="unknown error|&quot;unknown error&quot;" data-noexport id="cddl-value-errorresponse-error-unknown-error"><code>"unknown error"</code></dfn> / <dfn class="dfn-paneled" data-dfn-for="ErrorResponse/error" data-dfn-type="cddl-value" data-lt="unknown command|&quot;unknown command&quot;" data-noexport id="cddl-value-errorresponse-error-unknown-command"><code>"unknown command"</code></dfn> / <dfn class="dfn-paneled" data-dfn-for="ErrorResponse/error" data-dfn-type="cddl-value" data-lt="invalid argument|&quot;invalid argument&quot;" data-noexport id="cddl-value-errorresponse-error-invalid-argument"><code>"invalid argument"</code></dfn> / <dfn class="dfn-paneled" data-dfn-for="ErrorResponse/error" data-dfn-type="cddl-value" data-lt="session not created|&quot;session not created&quot;" data-noexport id="cddl-value-errorresponse-error-session-not-created"><code>"session not created"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="ErrorResponse" data-dfn-type="cddl-key" data-lt="message|&quot;message&quot;" data-noexport id="cddl-key-errorresponse-message"><code>message</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D④">text</a>,
  ?<dfn class="dfn-paneled" data-dfn-for="ErrorResponse" data-dfn-type="cddl-key" data-lt="stacktrace|&quot;stacktrace&quot;" data-noexport id="cddl-key-errorresponse-stacktrace"><code>stacktrace</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D⑤">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible③">Extensible</a>,
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-resultdata"><code>ResultData</code></dfn> = (
  <a data-link-type="cddl" href="#cddl-type-emptyresult" id="ref-for-cddl-type-emptyresult">EmptyResult</a> /
  <a data-link-type="cddl" href="#cddl-type-sessionresult" id="ref-for-cddl-type-sessionresult">SessionResult</a> /
  <a data-link-type="cddl" href="#cddl-type-settingsresult" id="ref-for-cddl-type-settingsresult">SettingsResult</a>
)

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-emptyresult"><code>EmptyResult</code></dfn> = {}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-event"><code>Event</code></dfn> = {
  <a data-link-type="cddl" href="#cddl-type-eventdata" id="ref-for-cddl-type-eventdata">EventData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible④">Extensible</a>,
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-eventdata"><code>EventData</code></dfn> = (
  <a data-link-type="cddl" href="#cddl-type-interactionevent" id="ref-for-cddl-type-interactionevent">InteractionEvent</a>
)
</pre>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition①">Remote end definition</a></code> and <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition①">local end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl,local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-extensible"><code>Extensible</code></dfn> = {
  *<a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D⑥">text</a> => <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D⑦">any</a>
}
</pre>
   <h3 class="heading settled" data-level="5.2" id="protocol-capabilities"><span class="secno">5.2. </span><span class="content">Capabilities</span><a class="self-link" href="#protocol-capabilities"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="capabilities">Capabilities</dfn> are used to communicate the features supported by a given implementation. The <a data-link-type="dfn" href="#local-end" id="ref-for-local-end②">local end</a> may use capabilities to define which features it requires the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②">remote end</a> to satisfy when creating a new <a data-link-type="dfn" href="#session" id="ref-for-session②">session</a>. Likewise, the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end③">remote end</a> uses capabilities to describe the full feature set for a <a data-link-type="dfn" href="#session" id="ref-for-session③">session</a>.</p>
   <p>The following table of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="standard-capabilities">standard capabilities</dfn> enumerates the capabilities each implementation must support.</p>
   <table>
    <caption>Standard capabilities</caption>
    <tbody>
     <tr>
      <th>Capability
    
      <th>Key
    
      <th>Value type
    
      <th>Description
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="standard capabilities" data-dfn-type="dfn" data-noexport id="standard-capabilities-at-name">AT name</dfn>
    
      <td>"<code>atName</code>"
    
      <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a>
    
      <td>Identifies the assistive technology.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="standard capabilities" data-dfn-type="dfn" data-noexport id="standard-capabilities-at-version">AT version</dfn>
    
      <td>"<code>atVersion</code>"
    
      <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a>
    
      <td>Identifies the version of the assistive technology.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="standard capabilities" data-dfn-type="dfn" data-noexport id="standard-capabilities-platform">Platform</dfn>
    
      <td>"<code>platformName</code>"
    
      <td><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a>
    
      <td>Identifies the operating system of the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end④">remote end</a>.

   </table>
   <p><a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end⑤">Remote ends</a> may introduce <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="extension-capabilities">extension capabilities</dfn> that are extra capabilities used to provide configuration or fulfill other vendor-specific needs. Extension capabilities' key must contain a "<code>:</code>" (colon) character, denoting an implementation specific namespace. The value can be arbitrary JSON types.</p>
   <div class="algorithm" data-algorithm="process capabilities">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="process-capabilities">process capabilities</dfn> with argument <var>parameters</var>, the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end⑥">remote end</a> must:</p>
    <ol>
     <li data-md>
      <p>If <var>parameters</var>["<code>capabilities</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a> and <var>parameters</var>["<code>capabilities</code>"]["<code>alwaysMatch</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exists</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>required capabilities</var> be <var>parameters</var>["<code>capabilities</code>"]["<code>alwaysMatch</code>"].</p>
      </ol>
     <li data-md>
      <p>Otherwise:</p>
      <ol>
       <li data-md>
        <p>Let <var>required capabilities</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a>.</p>
      </ol>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="#match-capabilities" id="ref-for-match-capabilities">match capabilities</a> given <var>required capabilities</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="match capabilities">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-capabilities">match capabilities</dfn> given <var>requested capabilities</var>, the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end⑦">remote end</a> must:</p>
    <ol>
     <li data-md>
      <p>Let <var>matched capabilities</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">map</a> with the following entries:</p>
      <dl>
       <dt data-md>"<code>atName</code>"
       <dd data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase" id="ref-for-ascii-lowercase">ASCII lowercase</a> name of the assistive technology as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">string</a>.</p>
       <dt data-md>"<code>atVersion</code>"
       <dd data-md>
        <p>The assistive technology version, as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">string</a>.</p>
       <dt data-md>"<code>platformName</code>"
       <dd data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase" id="ref-for-ascii-lowercase①">ASCII lowercase</a> name of the current platform as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑤">string</a>.</p>
      </dl>
     <li data-md>
      <p>Optionally add <a data-link-type="dfn" href="#extension-capabilities" id="ref-for-extension-capabilities">extension capabilities</a> as entries to <var>matched capabilities</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-iterate" id="ref-for-map-iterate">For each</a> <var>key</var> → <var>value</var> of <var>requested capabilities</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>match value</var> be <var>value</var>.</p>
       <li data-md>
        <p>Switch on <var>key</var>:</p>
        <dl>
         <dt data-md>"<code>atName</code>"
         <dd data-md>
          <p>If <var>value</var> is not equal to <var>matched capabilities</var>["<code>atName</code>"], then return <a data-link-type="dfn" href="#success" id="ref-for-success①">success</a> with data null.</p>
         <dt data-md>"<code>atVersion</code>"
         <dd data-md>
          <p>Compare <var>value</var> to <var>matched capabilities</var>["<code>browserVersion</code>"] using an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a> comparison algorithm. The comparison is to accept a value that places constraints on the version using the "<code>&lt;</code>", "<code>&lt;=</code>", "<code>></code>", and "<code>>=</code>" operators.</p>
         <dt data-md>"<code>platformName</code>"
         <dd data-md>
          <p>If <var>value</var> is not equal to <var>matched capabilities</var>["<code>platformName</code>"], then return <a data-link-type="dfn" href="#success" id="ref-for-success②">success</a> with data null.</p>
         <dt data-md>Otherwise
         <dd data-md>
          <p>If <var>key</var> is the key of an <a data-link-type="dfn" href="#extension-capabilities" id="ref-for-extension-capabilities①">extension capability</a>, set <var>match value</var> to the result of <a data-link-type="dfn" href="#try" id="ref-for-try">trying</a> implementation-specific steps to match on <var>key</var> with <var>value</var>. If the match is not successful, return <a data-link-type="dfn" href="#success" id="ref-for-success③">success</a> with data null.</p>
        </dl>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> <var>matched capabilities</var>[<var>key</var>] to <var>match value</var>.</p>
      </ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success④">success</a> with data <var>matched capabilities</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.3" id="protocol-session"><span class="secno">5.3. </span><span class="content">Session</span><a class="self-link" href="#protocol-session"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="session">session</dfn> represents the connection between a <a data-link-type="dfn" href="#local-end" id="ref-for-local-end③">local end</a> and a specific <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end⑧">remote end</a>.</p>
   <p>A <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end⑨">remote end</a> has an associated list of <dfn class="dfn-paneled" data-dfn-for="remote end" data-dfn-type="dfn" data-noexport id="remote-end-active-sessions">active sessions</dfn>, which is a list of all <a data-link-type="dfn" href="#session" id="ref-for-session④">sessions</a> that are currently started. A remote end has at most one <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions">active session</a> at a given time.</p>
   <p>A <a data-link-type="dfn" href="#session" id="ref-for-session⑤">session</a> has an associated <dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-session-id">session ID</dfn> (a string representation of a <a data-link-type="dfn" href="#uuid" id="ref-for-uuid">UUID</a>) used to uniquely identify this session. Unless stated otherwise it is null.</p>
   <h3 class="heading settled" data-level="5.4" id="protocol-modules"><span class="secno">5.4. </span><span class="content">Modules</span><a class="self-link" href="#protocol-modules"></a></h3>
   <p>The AT Driver protocol is organized into modules.</p>
   <p>Each <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="module">module</dfn> represents a collection of related <a data-link-type="dfn" href="#command" id="ref-for-command">commands</a> and <a data-link-type="dfn" href="#event" id="ref-for-event">events</a> pertaining to a certain aspect of the assistive technology.</p>
   <p>Each module has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="module-name">module name</dfn> which is a string. The <a data-link-type="dfn" href="#command-name" id="ref-for-command-name">command name</a> and <a data-link-type="dfn" href="#event-name" id="ref-for-event-name">event name</a> for commands and events defined in the module start with the <a data-link-type="dfn" href="#module-name" id="ref-for-module-name">module name</a> followed by a period "<code>.</code>".</p>
   <p>Modules which contain <a data-link-type="dfn" href="#command" id="ref-for-command①">commands</a> define <code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition②">remote end definition</a></code> fragments.</p>
   <p>An implementation may define <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="extension-modules">extension modules</dfn>. These must have a module name that contains a single colon "<code>:</code>" character. The part before the colon is the prefix; this is typically the same for all extension modules specific to a given implementation and should be unique for a given implementation. Such modules extend the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition②">local end definition</a></code> and <code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition③">remote end definition</a></code> providing additional groups as choices for the defined <a data-link-type="dfn" href="#command" id="ref-for-command②">commands</a> and <a data-link-type="dfn" href="#event" id="ref-for-event①">events</a>.</p>
   <h3 class="heading settled" data-level="5.5" id="protocol-commands"><span class="secno">5.5. </span><span class="content">Commands</span><a class="self-link" href="#protocol-commands"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="command">command</dfn> is an asynchronous operation, requested by the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end④">local end</a> and run on the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⓪">remote end</a>, resulting in either a <a data-link-type="dfn" href="#success" id="ref-for-success⑤">success</a> or an <a data-link-type="dfn" href="#error" id="ref-for-error②">error</a> being returned to the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end⑤">local end</a>. Multiple commands can run at the same time, and commands can potentially be long-running. As a consequence, commands can finish out-of-order.</p>
   <p>Each <a data-link-type="dfn" href="#command" id="ref-for-command③">command</a> is defined by:</p>
   <ul>
    <li data-md>
     <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="command-type">command type</dfn> which is defined by a <code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition④">remote end definition</a></code> fragment containing a group. Each such group has two fields:</p>
     <ul>
      <li data-md>
       <p><code>method</code> which is a string literal in the form <code>[module name].[method name]</code>. This is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="command-name">command name</dfn>.</p>
      <li data-md>
       <p><code>params</code> which defines a mapping containing data that to be passed into the command. The populated value of this map is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="command-parameters">command parameters</dfn>.</p>
     </ul>
    <li data-md>
     <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="result-type">result type</dfn>, which is defined by the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition③">local end definition</a></code> fragment.</p>
    <li data-md>
     <p>A set of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="remote-end-steps">remote end steps</dfn> which define the actions to take for a command given a <a data-link-type="dfn" href="#session" id="ref-for-session⑥">session</a> and <a data-link-type="dfn" href="#command-parameters" id="ref-for-command-parameters">command parameters</a> and return an instance of the command <a data-link-type="dfn" href="#result-type" id="ref-for-result-type">result type</a>.</p>
   </ul>
   <p>A command that can run without an active session is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="static-command">static command</dfn>. Commands are not static commands unless stated in their definition.</p>
   <p>When commands are sent from the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end⑥">local end</a> they have a command id. This is an identifier used by the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end⑦">local end</a> to identify the response from a particular command. From the point of view of the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①①">remote end</a> this identifier is opaque and cannot be used internally to identify the command.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-of-all-command-names">set of all command names</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">set</a> containing all the defined <a data-link-type="dfn" href="#command-name" id="ref-for-command-name①">command names</a>, including any belonging to <a data-link-type="dfn" href="#extension-modules" id="ref-for-extension-modules">extension modules</a>.</p>
   <h3 class="heading settled" data-level="5.6" id="protocol-events"><span class="secno">5.6. </span><span class="content">Events</span><a class="self-link" href="#protocol-events"></a></h3>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event">event</dfn> is a notification, sent by the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①②">remote end</a> to the <a data-link-type="dfn" href="#local-end" id="ref-for-local-end⑧">local end</a>, signaling that something of interest has occurred on the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①③">remote end</a>.</p>
   <ul>
    <li data-md>
     <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-type">event type</dfn> is defined by a <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition④">local end definition</a></code> fragment containing a group. Each such group has two fields:</p>
     <ul>
      <li data-md>
       <p><code>method</code> which is a string literal of the form <code>[module name].[event name]</code>. This is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-name">event name</dfn>.</p>
      <li data-md>
       <p><code>params</code> which defines a mapping containing event data. The populated value of this map is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-parameters">event parameters</dfn>.</p>
     </ul>
    <li data-md>
     <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="remote-end-event-trigger">remote end event trigger</dfn> which defines when the event is triggered and steps to construct the <a data-link-type="dfn" href="#event-type" id="ref-for-event-type">event type</a> data.</p>
   </ul>
   <h3 class="heading settled" data-level="5.7" id="protocol-errors"><span class="secno">5.7. </span><span class="content">Errors</span><a class="self-link" href="#protocol-errors"></a></h3>
   <p>The following table lists each <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="error-code">error code</dfn>, its associated JSON <code>error</code> code, and a non-normative description of the error.</p>
   <table>
    <caption>Error codes</caption>
    <tbody>
     <tr>
      <th>Error code
    
      <th>JSON error code
    
      <th>Description
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-invalid-argument">invalid argument</dfn>
    
      <td><code>invalid argument</code>
    
      <td>The arguments passed to a <a data-link-type="dfn" href="#command" id="ref-for-command④">command</a> are either invalid or malformed.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-invalid-session-id">invalid session id</dfn>
    
      <td><code>invalid session id</code>
    
      <td>The <a data-link-type="dfn" href="#session" id="ref-for-session⑦">session</a> either does not exist or it’s not active.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-unknown-command">unknown command</dfn>
    
      <td><code>unknown command</code>
    
      <td>A <a data-link-type="dfn" href="#command" id="ref-for-command⑤">command</a> could not be executed because the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①④">remote end</a> is not aware of it.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-session-not-created">session not created</dfn>
    
      <td><code>session not created</code>
    
      <td>A new <a data-link-type="dfn" href="#session" id="ref-for-session⑧">session</a> could not be created.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-unknown-user-intent">unknown user intent</dfn>
    
      <td><code>unknown user intent</code>
    
      <td>The remote end does not support a user intent with the provided name.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-cannot-simulate-keyboard-interaction">cannot simulate keyboard interaction</dfn>
    
      <td><code>cannot simulate keyboard interaction</code>
    
      <td>The <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⑤">remote end</a> cannot simulate keyboard interaction.
  
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="error code" data-dfn-type="dfn" data-noexport id="error-code-invalid-os-focus-state">invalid OS focus state</dfn>
    
      <td><code>invalid OS focus state</code>
    
      <td>The application that currently has OS focus is not one of the expected applications.

   </table>
   <h3 class="heading settled" data-level="5.8" id="security-checks"><span class="secno">5.8. </span><span class="content">Security checks</span><a class="self-link" href="#security-checks"></a></h3>
   <p>In order to mitigate security risks when using this API, there are some security checks for certain commands.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-that-keyboard-interaction-can-be-simulated">check that keyboard interaction can be simulated</dfn>:</p>
   <ol>
    <li data-md>
     <p>If the remote end cannot simulate keyboard interaction for any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①">implementation-defined</a> reason, then return an <a data-link-type="dfn" href="#error" id="ref-for-error③">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code①">error code</a> <a data-link-type="dfn" href="#error-code-cannot-simulate-keyboard-interaction" id="ref-for-error-code-cannot-simulate-keyboard-interaction">cannot simulate keyboard interaction</a>.</p>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success⑥">success</a> with data null.</p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="check-that-one-of-the-expected-applications-has-focus">check that one of the expected applications has focus</dfn>:</p>
   <ol>
    <li data-md>
     <p>If the application that currently has OS focus (and so could act on simulated key presses from this API) is not one of the expected applications, then return an <a data-link-type="dfn" href="#error" id="ref-for-error④">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code②">error code</a> <a data-link-type="dfn" href="#error-code-invalid-os-focus-state" id="ref-for-error-code-invalid-os-focus-state">invalid OS focus state</a>. Which applications are expected is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined②">implementation-defined</a>.</p>
     <p class="issue" id="issue-e10bf837"><a class="self-link" href="#issue-e10bf837"></a> Is the "OS focus" check a viable security restriction for "send keys"? <a href="https://github.com/w3c/at-driver/issues/77">[Issue #77]</a></p>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success⑦">success</a> with data null.</p>
   </ol>
   <p>To determine whether a string <var>text</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="should-be-withheld">should be withheld</dfn>:</p>
   <ol>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⑥">remote end</a> determines that it is unsafe to expose <var>text</var> to an external process for any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined③">implementation-defined</a> reason:</p>
     <ol start="2">
      <li data-md>
       <p>Return true.</p>
     </ol>
    <li data-md>
     <p>Return false.</p>
   </ol>
   <h2 class="heading settled" data-level="6" id="transport"><span class="secno">6. </span><span class="content">Transport</span><a class="self-link" href="#transport"></a></h2>
   <p>Message transport is provided using the WebSocket protocol. <a data-link-type="biblio" href="#biblio-rfc6455" title="The WebSocket Protocol">[RFC6455]</a></p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="websocket-listener">WebSocket listener</dfn> is a network endpoint that is able to accept incoming WebSocket connections.</p>
   <p>A <a data-link-type="dfn" href="#websocket-listener" id="ref-for-websocket-listener">WebSocket listener</a> has a <dfn class="dfn-paneled" data-dfn-for="WebSocket listener" data-dfn-type="dfn" data-noexport id="websocket-listener-host">host</dfn>,
a <dfn class="dfn-paneled" data-dfn-for="WebSocket listener" data-dfn-type="dfn" data-noexport id="websocket-listener-port">port</dfn>,
and a <dfn class="dfn-paneled" data-dfn-for="WebSocket listener" data-dfn-type="dfn" data-noexport id="websocket-listener-secure-flag">secure flag</dfn>.</p>
   <p>When a <a data-link-type="dfn" href="#websocket-listener" id="ref-for-websocket-listener①">WebSocket listener</a> <var>listener</var> is created, a <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⑦">remote end</a> must start to listen for WebSocket connections on the host and port given by <var>listener</var>’s host and port. If <var>listener</var>’s <a data-link-type="dfn" href="#websocket-listener-secure-flag" id="ref-for-websocket-listener-secure-flag">secure flag</a> is set, then connections established from <var>listener</var> must be TLS encrypted.</p>
   <p>A <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⑧">remote end</a> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">set</a> of <a data-link-type="dfn" href="#websocket-listener" id="ref-for-websocket-listener②">WebSocket listeners</a> <dfn class="dfn-paneled" data-dfn-for="remote end" data-dfn-type="dfn" data-noexport id="remote-end-active-listeners">active listeners</dfn>, which is initially empty.</p>
   <p>A <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end①⑨">remote end</a> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">set</a> of <dfn class="dfn-paneled" data-dfn-for="remote end" data-dfn-type="dfn" data-noexport id="remote-end-websocket-connections-not-associated-with-a-session">WebSocket connections not associated with a session</dfn>, which is initially empty.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="websocket-connection">WebSocket connection</dfn> is a network connection that follows the requirements of the WebSocket protocol. <a data-link-type="biblio" href="#biblio-rfc6455" title="The WebSocket Protocol">[RFC6455]</a></p>
   <p>A <a data-link-type="dfn" href="#session" id="ref-for-session⑨">session</a> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">set</a> of <dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-session-websocket-connections">session WebSocket connections</dfn> whose elements are <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection">WebSocket connections</a>. This is initially empty.</p>
   <p>A <a data-link-type="dfn" href="#session" id="ref-for-session①⓪">session</a> <var>session</var> is <dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-associated-with-connection">associated with connection</dfn> <var>connection</var> if <var>session</var>’s <a data-link-type="dfn" href="#session-session-websocket-connections" id="ref-for-session-session-websocket-connections">session WebSocket connections</a> contains <var>connection</var>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Each <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection①">WebSocket connection</a> is associated with at most one <a data-link-type="dfn" href="#session" id="ref-for-session①①">session</a>.</p>
   <p>When a client <a href="https://tools.ietf.org/html/rfc6455#section-4.1">establishes a WebSocket connection</a> <var>connection</var> by connecting to one of the set of <a data-link-type="dfn" href="#remote-end-active-listeners" id="ref-for-remote-end-active-listeners">active listeners</a> <var>listener</var>, the implementation must proceed according to the <a href="https://tools.ietf.org/html/rfc6455#section-4.2">WebSocket server-side requirements</a>, with the following steps run when deciding whether to accept the incoming connection:</p>
   <ol>
    <li data-md>
     <p>Let <var>resource name</var> be the resource name from <a href="https://tools.ietf.org/html/rfc6455#section-4.2.1">reading the client’s opening handshake</a>. If <var>resource name</var> is not "<code>/session</code>", then stop running these steps and act as if the requested service is not available.</p>
    <li data-md>
     <p>Run any other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined④">implementation-defined</a> steps to decide if the connection should be accepted, and if it is not stop running these steps and act as if the requested service is not available.</p>
    <li data-md>
     <p>Add the connection to the set of <a data-link-type="dfn" href="#remote-end-websocket-connections-not-associated-with-a-session" id="ref-for-remote-end-websocket-connections-not-associated-with-a-session">WebSocket connections not associated with a session</a>.</p>
   </ol>
   <p>When a <a href="https://tools.ietf.org/html/rfc6455#section-6.2">WebSocket message has been received</a> for a <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection②">WebSocket connection</a> <var>connection</var> with type <var>type</var> and data <var>data</var>, a <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⓪">remote end</a> must <a data-link-type="dfn" href="#handle-an-incoming-message" id="ref-for-handle-an-incoming-message">handle an incoming message</a> given <var>connection</var>, <var>type</var> and <var>data</var>.</p>
   <p>When the <a href="https://tools.ietf.org/html/rfc6455#section-7.1.3">WebSocket closing handshake is started</a> or when the <a href="https://tools.ietf.org/html/rfc6455#section-7.1.4">WebSocket connection is closed</a> for a <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection③">WebSocket connection</a> <var>connection</var>, a <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②①">remote end</a> must <a data-link-type="dfn" href="#handle-a-connection-closing" id="ref-for-handle-a-connection-closing">handle a connection closing</a> given <var>connection</var>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Both conditions are needed because it is possible for a WebSocket connection to be closed without a closing handshake.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="start-listening-for-a-websocket-connection">start listening for a WebSocket connection</dfn>:</p>
   <ol>
    <li data-md>
     <p>Let <var>listener</var> be a new <a data-link-type="dfn" href="#websocket-listener" id="ref-for-websocket-listener③">WebSocket listener</a> with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined⑤">implementation-defined</a> <a data-link-type="dfn" href="#websocket-listener-host" id="ref-for-websocket-listener-host">host</a>, <a data-link-type="dfn" href="#websocket-listener-port" id="ref-for-websocket-listener-port">port</a>, and <a data-link-type="dfn" href="#websocket-listener-secure-flag" id="ref-for-websocket-listener-secure-flag①">secure flag</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>listener</var> to the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②②">remote end</a>’s <a data-link-type="dfn" href="#remote-end-active-listeners" id="ref-for-remote-end-active-listeners①">active listeners</a>.</p>
    <li data-md>
     <p>Return <var>listener</var>.</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> a future iteration of this specification may allow multiple connections, to support <a href="https://w3c.github.io/webdriver/#dfn-intermediary-nodes">intermediary nodes like in WebDriver</a>.</p>
   <div class="algorithm" data-algorithm="handle an incoming message">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-an-incoming-message">handle an incoming message</dfn> given a <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection④">WebSocket connection</a> <var>connection</var>, type <var>type</var> and data <var>data</var>:</p>
    <ol>
     <li data-md>
      <p>If <var>type</var> is not <a href="https://tools.ietf.org/html/rfc6455#section-5.2">text</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="#send-an-error-response" id="ref-for-send-an-error-response">Send an error response</a> given <var>connection</var>, null, and <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument">invalid argument</a>.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert">Assert</a>: <var>data</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#scalar-value-string" id="ref-for-scalar-value-string">scalar value string</a>, because the <a href="https://tools.ietf.org/html/rfc6455#section-8.1">WebSocket handling errors in UTF-8-encoded data</a> would already have <a href="https://tools.ietf.org/html/rfc6455#section-7.1.7">failed the WebSocket connection</a> otherwise.</p>
     <li data-md>
      <p>If there is a <a data-link-type="dfn" href="#session" id="ref-for-session①②">session</a> <a data-link-type="dfn" href="#session-associated-with-connection" id="ref-for-session-associated-with-connection">associated with connection</a> <var>connection</var>, let <var>session</var> be that session. Otherwise if <var>connection</var> is in the set of <a data-link-type="dfn" href="#remote-end-websocket-connections-not-associated-with-a-session" id="ref-for-remote-end-websocket-connections-not-associated-with-a-session①">WebSocket connections not associated with a session</a>, let <var>session</var> be null. Otherwise, return.</p>
     <li data-md>
      <p>Let <var>parsed</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value" id="ref-for-parse-a-json-string-to-an-infra-value">parsing JSON into Infra values</a> given <var>data</var>. If this throws an exception, then <a data-link-type="dfn" href="#send-an-error-response" id="ref-for-send-an-error-response①">send an error response</a> given <var>connection</var>, null, and <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument①">invalid argument</a>, and finally return.</p>
     <li data-md>
      <p>Match <var>parsed</var> against the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition⑤">remote end definition</a></code>. If this results in a match:</p>
      <ol>
       <li data-md>
        <p>Let <var>matched</var> be the map representing the matched data.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert①">Assert</a>: <var>matched</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">contains</a> "<code>id</code>", "<code>method</code>", and "<code>params</code>".</p>
       <li data-md>
        <p>Let <var>command id</var> be <var>matched</var>["<code>id</code>"].</p>
       <li data-md>
        <p>Let <var>method</var> be <var>matched</var>["<code>method</code>"].</p>
       <li data-md>
        <p>Let <var>command</var> be the command with <a data-link-type="dfn" href="#command-name" id="ref-for-command-name②">command name</a> <var>method</var>.</p>
       <li data-md>
        <p>If <var>session</var> is null and <var>command</var> is not a <a data-link-type="dfn" href="#static-command" id="ref-for-static-command">static command</a>:</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="#send-an-error-response" id="ref-for-send-an-error-response②">Send an error response</a> given <var>connection</var>, <var>command id</var>, and <a data-link-type="dfn" href="#error-code-invalid-session-id" id="ref-for-error-code-invalid-session-id">invalid session id</a>.</p>
         <li data-md>
          <p>Return.</p>
        </ol>
       <li data-md>
        <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
        <ol>
         <li data-md>
          <p>Let <var>result</var> be the result of running the <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps">remote end steps</a> for <var>command</var> given <var>session</var> and <a data-link-type="dfn" href="#command-parameters" id="ref-for-command-parameters①">command parameters</a> <var>matched</var>["<code>params</code>"].</p>
         <li data-md>
          <p>If <var>result</var> is an <a data-link-type="dfn" href="#error" id="ref-for-error⑤">error</a>:</p>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="#send-an-error-response" id="ref-for-send-an-error-response③">Send an error response</a> given <var>connection</var>, <var>command id</var>, and <var>result</var>’s <a data-link-type="dfn" href="#error-code" id="ref-for-error-code③">error code</a>.</p>
           <li data-md>
            <p>Return.</p>
          </ol>
         <li data-md>
          <p>Let <var>value</var> be <var>result</var>’s data.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert②">Assert</a>: <var>value</var> matches the definition for the <a data-link-type="dfn" href="#result-type" id="ref-for-result-type①">result type</a> corresponding to the command with <a data-link-type="dfn" href="#command-name" id="ref-for-command-name③">command name</a> <var>method</var>.</p>
         <li data-md>
          <p>If <var>method</var> is "<code>session.new</code>":</p>
          <ol>
           <li data-md>
            <p>Let <var>session</var> be the entry in the list of <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions①">active sessions</a> whose <a data-link-type="dfn" href="#session-session-id" id="ref-for-session-session-id">session ID</a> is equal to the "<code>sessionId</code>" property of <var>value</var>.</p>
           <li data-md>
            <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①">Append</a> <var>connection</var> to <var>session</var>’s <a data-link-type="dfn" href="#session-session-websocket-connections" id="ref-for-session-session-websocket-connections①">session WebSocket connections</a>.</p>
           <li data-md>
            <p>Remove <var>connection</var> from the set of <a data-link-type="dfn" href="#remote-end-websocket-connections-not-associated-with-a-session" id="ref-for-remote-end-websocket-connections-not-associated-with-a-session②">WebSocket connections not associated with a session</a>.</p>
          </ol>
         <li data-md>
          <p>Let <var>response</var> be a new map matching the <code>CommandResponse</code> production in the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition⑤">local end definition</a></code> with the <code>id</code> field set to <var>command id</var> and the <code>value</code> field set to <var>value</var>.</p>
         <li data-md>
          <p>Let <var>serialized</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to JSON bytes</a> given <var>response</var>.</p>
         <li data-md>
          <p><a href="https://tools.ietf.org/html/rfc6455#section-6.1">Send a WebSocket message</a> comprised of <var>serialized</var> over <var>connection</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Otherwise:</p>
      <ol>
       <li data-md>
        <p>Let <var>command id</var> be null.</p>
       <li data-md>
        <p>If <var>parsed</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">map</a> and <var>parsed</var>["<code>id</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">exists</a> and is an integer greater than or equal to zero, set <var>command id</var> to that integer.</p>
       <li data-md>
        <p>Let <var>error code</var> be <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument②">invalid argument</a>.</p>
       <li data-md>
        <p>If <var>parsed</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">map</a> and <var>parsed</var>["<code>method</code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">exists</a> and is a string, but <var>parsed</var>["<code>method</code>"] is not in the <a data-link-type="dfn" href="#set-of-all-command-names" id="ref-for-set-of-all-command-names">set of all command names</a>, set <var>error code</var> to <a data-link-type="dfn" href="#error-code-unknown-command" id="ref-for-error-code-unknown-command">unknown command</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#send-an-error-response" id="ref-for-send-an-error-response④">Send an error response</a> given <var>connection</var>, <var>command id</var>, and <var>error code</var>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="emit an event">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="emit-an-event">emit an event</dfn> given <var>session</var>, and <var>body</var>:</p>
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert③">Assert</a>: <var>body</var> has <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-size" id="ref-for-map-size">size</a> 2 and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑤">contains</a> "<code>method</code>" and "<code>params</code>".</p>
     <li data-md>
      <p>Let <var>serialized</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes①">serialize an infra value to JSON bytes</a> given <var>body</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>connection</var> in <var>session</var>’s <a data-link-type="dfn" href="#session-session-websocket-connections" id="ref-for-session-session-websocket-connections②">session WebSocket connections</a>:</p>
      <ol>
       <li data-md>
        <p><a href="https://tools.ietf.org/html/rfc6455#section-6.1">Send a WebSocket message</a> comprised of <var>serialized</var> over <var>connection</var>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="send an error response">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="send-an-error-response">send an error response</dfn> given a <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection⑤">WebSocket connection</a> <var>connection</var>, <var>command id</var>, and <var>error code</var>:</p>
    <ol>
     <li data-md>
      <p>Let <var>error data</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map④">map</a> matching the <code>ErrorResponse</code> production in the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition⑥">local end definition</a></code>, with the <code>id</code> field set to <var>command id</var>, the <code>error</code> field set to <var>error code</var>, the <code>message</code> field set to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined⑥">implementation-defined</a> string containing a human-readable definition of the error that occurred and the <code>stacktrace</code> field optionally set to an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined⑦">implementation-defined</a> string containing a stack trace report of the active stack frames at the time when the error occurred.</p>
     <li data-md>
      <p>Let <var>response</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes②">serialize an infra value to JSON bytes</a> given <var>error data</var>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> <var>command id</var> can be null, in which case the <code>id</code> field will also be set to null, not omitted from <var>response</var>.</p>
     <li data-md>
      <p><a href="https://tools.ietf.org/html/rfc6455#section-6.1">Send a WebSocket message</a> comprised of <var>response</var> over <var>connection</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="handle a connection closing">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handle-a-connection-closing">handle a connection closing</dfn> given a <a data-link-type="dfn" href="#websocket-connection" id="ref-for-websocket-connection⑥">WebSocket connection</a> <var>connection</var>:</p>
    <ol>
     <li data-md>
      <p>If there is a <a data-link-type="dfn" href="#session" id="ref-for-session①③">session</a> <a data-link-type="dfn" href="#session-associated-with-connection" id="ref-for-session-associated-with-connection①">associated with connection</a> <var>connection</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>session</var> be the <a data-link-type="dfn" href="#session" id="ref-for-session①④">session</a> <a data-link-type="dfn" href="#session-associated-with-connection" id="ref-for-session-associated-with-connection②">associated with connection</a> <var>connection</var>.</p>
       <li data-md>
        <p>Remove <var>connection</var> from <var>session</var>’s <a data-link-type="dfn" href="#session-session-websocket-connections" id="ref-for-session-session-websocket-connections③">session WebSocket connections</a>.</p>
       <li data-md>
        <p>If <var>session</var>’s <a data-link-type="dfn" href="#session-session-websocket-connections" id="ref-for-session-session-websocket-connections④">session WebSocket connections</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a>:</p>
        <ol>
         <li data-md>
          <p>Remove <var>session</var> from <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions②">active sessions</a>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Otherwise, if the set of <a data-link-type="dfn" href="#remote-end-websocket-connections-not-associated-with-a-session" id="ref-for-remote-end-websocket-connections-not-associated-with-a-session③">WebSocket connections not associated with a session</a> contains <var>connection</var>, remove <var>connection</var> from that set.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.1" id="transport-establishing"><span class="secno">6.1. </span><span class="content">Establishing a Connection</span><a class="self-link" href="#transport-establishing"></a></h3>
   <p>The URL to the WebSocket server is communicated out-of-band. When an implementation is ready to accept requests to start an AT Driver session, it must:</p>
   <ol>
    <li data-md>
     <p><a data-link-type="dfn" href="#start-listening-for-a-websocket-connection" id="ref-for-start-listening-for-a-websocket-connection">Start listening for a WebSocket connection</a>.</p>
   </ol>
   <h2 class="heading settled" data-level="7" id="modules"><span class="secno">7. </span><span class="content">Modules</span><a class="self-link" href="#modules"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="module-session"><span class="secno">7.1. </span><span class="content">The session Module</span><a class="self-link" href="#module-session"></a></h3>
   <h4 class="heading settled" data-level="7.1.1" id="module-session-definition"><span class="secno">7.1.1. </span><span class="content">Definition</span><a class="self-link" href="#module-session-definition"></a></h4>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition⑥">Remote end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-sessioncommand"><code>SessionCommand</code></dfn> = (<a data-link-type="cddl" href="#cddl-type-sessionnewcommand" id="ref-for-cddl-type-sessionnewcommand">SessionNewCommand</a>)
</pre>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition⑦">Local end definition</a></code></p>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-sessionresult"><code>SessionResult</code></dfn> = (<a data-link-type="cddl" href="#cddl-type-sessionnewresult" id="ref-for-cddl-type-sessionnewresult">SessionNewResult</a>)
</pre>
   <h4 class="heading settled" data-level="7.1.2" id="module-session-types"><span class="secno">7.1.2. </span><span class="content">Types</span><a class="self-link" href="#module-session-types"></a></h4>
   <h5 class="heading settled" data-level="7.1.2.1" id="module-session-CapabilitiesRequest"><span class="secno">7.1.2.1. </span><span class="content">The session.CapabilitiesRequest Type</span><a class="self-link" href="#module-session-CapabilitiesRequest"></a></h5>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition⑦">Remote end definition</a></code> and <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition⑧">local end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl,local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-capabilitiesrequest"><code>CapabilitiesRequest</code></dfn> = {
  ?<dfn class="dfn-paneled" data-dfn-for="CapabilitiesRequest" data-dfn-type="cddl-key" data-lt="atName|&quot;atName&quot;" data-noexport id="cddl-key-capabilitiesrequest-atname"><code>atName</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D⑧">text</a>,
  ?<dfn class="dfn-paneled" data-dfn-for="CapabilitiesRequest" data-dfn-type="cddl-key" data-lt="atVersion|&quot;atVersion&quot;" data-noexport id="cddl-key-capabilitiesrequest-atversion"><code>atVersion</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D⑨">text</a>,
  ?<dfn class="dfn-paneled" data-dfn-for="CapabilitiesRequest" data-dfn-type="cddl-key" data-lt="platformName|&quot;platformName&quot;" data-noexport id="cddl-key-capabilitiesrequest-platformname"><code>platformName</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⓪">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible⑤">Extensible</a>,
}
</pre>
   <p>The <code>CapabilitiesRequest</code> type represents capabilities requested for a session.</p>
   <h4 class="heading settled" data-level="7.1.3" id="module-session-commands"><span class="secno">7.1.3. </span><span class="content">Commands</span><a class="self-link" href="#module-session-commands"></a></h4>
   <h5 class="heading settled" data-level="7.1.3.1" id="module-session-new"><span class="secno">7.1.3.1. </span><span class="content">The session.new Command</span><a class="self-link" href="#module-session-new"></a></h5>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sessionnew">session.new</dfn> command allows creating a new <a data-link-type="dfn" href="#session" id="ref-for-session①⑤">session</a>. This is a <a data-link-type="dfn" href="#static-command" id="ref-for-static-command①">static command</a>.</p>
   <dl>
    <dt><a data-link-type="dfn" href="#command-type" id="ref-for-command-type">Command Type</a>
  
    <dd>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-sessionnewcommand"><code>SessionNewCommand</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SessionNewCommand" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-sessionnewcommand-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="SessionNewCommand/method" data-dfn-type="cddl-value" data-lt="session.new|&quot;session.new&quot;" data-noexport id="cddl-value-sessionnewcommand-method-sessionnew"><code>"session.new"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="SessionNewCommand" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-sessionnewcommand-params"><code>params</code></dfn>: {<dfn class="dfn-paneled" data-dfn-for="SessionNewCommand/params" data-dfn-type="cddl-key" data-lt="capabilities|&quot;capabilities&quot;" data-noexport id="cddl-key-sessionnewcommand-params-capabilities"><code>capabilities</code></dfn>: <a data-link-type="cddl" href="#cddl-type-capabilitiesrequestparameters" id="ref-for-cddl-type-capabilitiesrequestparameters">CapabilitiesRequestParameters</a>},
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-capabilitiesrequestparameters"><code>CapabilitiesRequestParameters</code></dfn> = {
  ?<dfn class="dfn-paneled" data-dfn-for="CapabilitiesRequestParameters" data-dfn-type="cddl-key" data-lt="alwaysMatch|&quot;alwaysMatch&quot;" data-noexport id="cddl-key-capabilitiesrequestparameters-alwaysmatch"><code>alwaysMatch</code></dfn>: <a data-link-type="cddl" href="#cddl-type-capabilitiesrequest" id="ref-for-cddl-type-capabilitiesrequest">CapabilitiesRequest</a>,
}
</pre>
     <p class="note" role="note"><span class="marker">Note:</span> <code>firstMatch</code> is not included currently to reduce complexity.</p>
    <dt><a data-link-type="dfn" href="#result-type" id="ref-for-result-type②">Result Type</a>
  
    <dd>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-sessionnewresult"><code>SessionNewResult</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SessionNewResult" data-dfn-type="cddl-key" data-lt="sessionId|&quot;sessionId&quot;" data-noexport id="cddl-key-sessionnewresult-sessionid"><code>sessionId</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①①">text</a>,
  <dfn class="dfn-paneled" data-dfn-for="SessionNewResult" data-dfn-type="cddl-key" data-lt="capabilities|&quot;capabilities&quot;" data-noexport id="cddl-key-sessionnewresult-capabilities"><code>capabilities</code></dfn>: {
    <dfn class="dfn-paneled" data-dfn-for="SessionNewResult/capabilities" data-dfn-type="cddl-key" data-lt="atName|&quot;atName&quot;" data-noexport id="cddl-key-sessionnewresult-capabilities-atname"><code>atName</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①②">text</a>,
    <dfn class="dfn-paneled" data-dfn-for="SessionNewResult/capabilities" data-dfn-type="cddl-key" data-lt="atVersion|&quot;atVersion&quot;" data-noexport id="cddl-key-sessionnewresult-capabilities-atversion"><code>atVersion</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①③">text</a>,
    <dfn class="dfn-paneled" data-dfn-for="SessionNewResult/capabilities" data-dfn-type="cddl-key" data-lt="platformName|&quot;platformName&quot;" data-noexport id="cddl-key-sessionnewresult-capabilities-platformname"><code>platformName</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①④">text</a>,
    <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible⑥">Extensible</a>,
  }
}
</pre>
   </dl>
   <div class="algorithm" data-algorithm="remote end steps for session.new">
    <p>The <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps①">remote end steps</a> given <var>session</var> and <var>command parameters</var> are:</p>
    <ol>
     <li data-md>
      <p>If <var>session</var> is not null, return an <a data-link-type="dfn" href="#error" id="ref-for-error⑥">error</a> with error code <a data-link-type="dfn" href="#error-code-session-not-created" id="ref-for-error-code-session-not-created">session not created</a>.</p>
     <li data-md>
      <p>If the list of <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions③">active sessions</a> is not empty, then return <a data-link-type="dfn" href="#error" id="ref-for-error⑦">error</a> with error code <a data-link-type="dfn" href="#error-code-session-not-created" id="ref-for-error-code-session-not-created①">session not created</a>.</p>
     <li data-md>
      <p>If the implementation is unable to start a new session for any reason, return an <a data-link-type="dfn" href="#error" id="ref-for-error⑧">error</a> with error code <a data-link-type="dfn" href="#error-code-session-not-created" id="ref-for-error-code-session-not-created②">session not created</a>.</p>
     <li data-md>
      <p>Let <var>capabilities</var> be the result of <a data-link-type="dfn" href="#try" id="ref-for-try①">trying</a> to <a data-link-type="dfn" href="#process-capabilities" id="ref-for-process-capabilities">process capabilities</a> with <var>command parameters</var>.</p>
     <li data-md>
      <p>If <var>capabilities</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error⑨">error</a> with error code <a data-link-type="dfn" href="#error-code-session-not-created" id="ref-for-error-code-session-not-created③">session not created</a>.</p>
     <li data-md>
      <p>Let <var>session id</var> be the result of <a data-link-type="dfn" href="#generating-a-uuid" id="ref-for-generating-a-uuid">generating a UUID</a>.</p>
     <li data-md>
      <p>Let <var>session</var> be a new <a data-link-type="dfn" href="#session" id="ref-for-session①⑥">session</a> with the <a data-link-type="dfn" href="#session-session-id" id="ref-for-session-session-id①">session ID</a> of <var>session id</var>.</p>
     <li data-md>
      <p>Append <var>session</var> to <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions④">active sessions</a>.</p>
     <li data-md>
      <p>Start an instance of the appropriate assistive technology, given <var>capabilities</var>.</p>
     <li data-md>
      <p>Let <var>body</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑤">map</a> matching the <code>SessionNewResult</code> production, with the <code>sessionId</code> field set to <var>session</var>’s <a data-link-type="dfn" href="#session-session-id" id="ref-for-session-session-id②">session ID</a>, and the <code>capabilities</code> field set to <var>capabilities</var>.</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success⑧">success</a> with data <var>body</var>.</p>
    </ol>
   </div>
   <div class="example" id="example-7c859f78">
    <a class="self-link" href="#example-7c859f78"></a>
A <a data-link-type="dfn" href="#local-end" id="ref-for-local-end⑨">local end</a> that wishes to create a new <a data-link-type="dfn" href="#session" id="ref-for-session①⑦">Session</a> which is furnished with
an assistive technology named <code>NVDA</code> might send a Command such as:


<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>24601</c-><c- p>,</c->
  <c- f>"method"</c-><c- p>:</c-> <c- u>"session.new"</c-><c- p>,</c->
  <c- f>"params"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"capabilities"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"alwaysMatch"</c-><c- p>:</c-> <c- p>{</c->
        <c- f>"atName"</c-><c- p>:</c-> <c- u>"NVDA"</c-><c- p>,</c->
        <c- f>"user-defined property"</c-><c- p>:</c-> <c- u>"user-defined value"</c->
      <c- p>}</c->
    <c- p>}</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>And the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②③">remote end</a> which receives that Command could respond with the
following Message:</p>
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>24601</c-><c- p>,</c->
  <c- f>"result"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"sessionId"</c-><c- p>:</c-> <c- u>"4f974515-cac5-4e45-9604-95d918116e83"</c-><c- p>,</c->
    <c- f>"capabilities"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"atName"</c-><c- p>:</c-> <c- u>"NVDA"</c-><c- p>,</c->
      <c- f>"atVersion"</c-><c- p>:</c-> <c- u>"2025.1"</c-><c- p>,</c->
      <c- f>"platformName"</c-><c- p>:</c-> <c- u>"Windows"</c->
    <c- p>}</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="7.2" id="module-settings"><span class="secno">7.2. </span><span class="content">The settings Module</span><a class="self-link" href="#module-settings"></a></h3>
   <p>Currently, there are no standardized settings. Implementations are strongly encouraged to review the security implications of each setting they offer to end users, and only expose the settings that they deem safe. This specification does not define what constitutes a setting, but the settings module is designed to control user preferences such as the default voice, or the default rate of speech.</p>
   <p>A <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②④">remote end</a> has an associated set of <dfn class="dfn-paneled" data-dfn-for="remote end" data-dfn-type="dfn" data-noexport id="remote-end-supported-settings">supported settings</dfn>, which is either null or a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set④">set</a> of strings which contains the name of every setting that may be referenced by this <a data-link-type="dfn" href="#module" id="ref-for-module①">module</a>.</p>
   <div class="algorithm" data-algorithm="validate setting name">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="validate-setting-name">validate setting name</dfn> given string <var>name</var>:</p>
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#remote-end-supported-settings" id="ref-for-remote-end-supported-settings">supported settings</a> is null:</p>
      <ol>
       <li data-md>
        <p>Return <code>"unknown"</code>.</p>
      </ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#remote-end-supported-settings" id="ref-for-remote-end-supported-settings①">supported settings</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contains</a> <var>name</var>:</p>
      <ol>
       <li data-md>
        <p>Return <code>"valid"</code>.</p>
      </ol>
     <li data-md>
      <p>Return <code>"invalid"</code>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get settings">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="get-settings">get settings</dfn> given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of strings <var>names</var>:</p>
    <ol>
     <li data-md>
      <p>Let <var>items</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <var>name</var> of <var>names</var>:</p>
      <ol>
       <li data-md>
        <p>If <a data-link-type="dfn" href="#validate-setting-name" id="ref-for-validate-setting-name">validate setting name</a> given <var>name</var> is <code>"invalid"</code>:</p>
        <ol>
         <li data-md>
          <p>Return an <a data-link-type="dfn" href="#error" id="ref-for-error①⓪">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code④">error code</a> <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument③">invalid argument</a>.</p>
        </ol>
       <li data-md>
        <p>Let <var>value</var> be the value of the setting named <var>name</var>.</p>
       <li data-md>
        <p>Let <var>item</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑥">map</a> matching the <code>SettingsGetSettingsResultItem</code> production in the <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition⑨">local end definition</a></code> with the <code>name</code> field set to <var>name</var> and the <code>value</code> field set to <var>value</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>item</var> to <var>items</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>body</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑦">map</a> matching the <code>SettingsGetSettingsResult</code> production, with the <code>settings</code> field set to <var>items</var>.</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success⑨">success</a> with data <var>body</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="modify setting">
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="modify-setting">modify setting</dfn> given string <var>name</var> and <var>value</var>:</p>
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#validate-setting-name" id="ref-for-validate-setting-name①">validate setting name</a> given <var>name</var> is <code>"invalid"</code>:</p>
      <ol>
       <li data-md>
        <p>Return an <a data-link-type="dfn" href="#error" id="ref-for-error①①">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code⑤">error code</a> <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument④">invalid argument</a>.</p>
      </ol>
     <li data-md>
      <p>Take any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined⑧">implementation-defined</a> steps to change the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⑤">remote end</a> setting named <var>name</var> to the value <var>value</var>.</p>
     <li data-md>
      <p>If there is any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined⑨">implementation-defined</a> indication that the setting named <var>name</var> does not hold the value <var>value</var>:</p>
      <ol>
       <li data-md>
        <p>Return an <a data-link-type="dfn" href="#error" id="ref-for-error①②">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code⑥">error code</a> <a data-link-type="dfn" href="#error-code-invalid-argument" id="ref-for-error-code-invalid-argument⑤">invalid argument</a>.</p>
      </ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success①⓪">success</a> with data null.</p>
    </ol>
   </div>
   <p class="note" role="note"><span class="marker">Note:</span> Today’s implementations may not be able to detect invalid setting names or values, limiting their ability to report when operations do not model authentic interactions with the internal state. The algorithms in this <a data-link-type="dfn" href="#module" id="ref-for-module②">module</a> are designed to reflect this.</p>
   <p class="issue" id="issue-b4b3c071"><a class="self-link" href="#issue-b4b3c071"></a> Require implementations to maintain a static list of supported settings.</p>
   <h4 class="heading settled" data-level="7.2.1" id="module-settings-definition"><span class="secno">7.2.1. </span><span class="content">Definition</span><a class="self-link" href="#module-settings-definition"></a></h4>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition⑧">Remote end definition</a></code></p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingscommand"><code>SettingsCommand</code></dfn> = {
  <a data-link-type="cddl" href="#cddl-type-settingssetsettingscommand" id="ref-for-cddl-type-settingssetsettingscommand">SettingsSetSettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingsgetsettingscommand" id="ref-for-cddl-type-settingsgetsettingscommand">SettingsGetSettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingsgetsupportedsettingscommand" id="ref-for-cddl-type-settingsgetsupportedsettingscommand">SettingsGetSupportedSettingsCommand</a>
}
</pre>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition①⓪">Local end definition</a></code></p>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsresult"><code>SettingsResult</code></dfn> = {
  <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsresult" id="ref-for-cddl-type-settingsgetsettingsresult">SettingsGetSettingsResult</a>
}
</pre>
   <h4 class="heading settled" data-level="7.2.2" id="module-settings-types"><span class="secno">7.2.2. </span><span class="content">Types</span><a class="self-link" href="#module-settings-types"></a></h4>
   <h5 class="heading settled" data-level="7.2.2.1" id="module-settings-get-settings-result"><span class="secno">7.2.2.1. </span><span class="content">The SettingsGetSettingsResult type</span><a class="self-link" href="#module-settings-get-settings-result"></a></h5>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition①①">Local end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsettingsresult"><code>SettingsGetSettingsResult</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsResult" data-dfn-type="cddl-key" data-lt="settings|&quot;settings&quot;" data-noexport id="cddl-key-settingsgetsettingsresult-settings"><code>settings</code></dfn>: [1* <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsresultitem" id="ref-for-cddl-type-settingsgetsettingsresultitem">SettingsGetSettingsResultItem</a> ],
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsettingsresultitem"><code>SettingsGetSettingsResultItem</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsResultItem" data-dfn-type="cddl-key" data-lt="name|&quot;name&quot;" data-noexport id="cddl-key-settingsgetsettingsresultitem-name"><code>name</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⑤">text</a>,
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsResultItem" data-dfn-type="cddl-key" data-lt="value|&quot;value&quot;" data-noexport id="cddl-key-settingsgetsettingsresultitem-value"><code>value</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⑥">any</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible⑦">Extensible</a>,
}
</pre>
   <p>The <code>SettingsGetSettingsResult</code> type contains a list of settings and their values.</p>
   <h4 class="heading settled" data-level="7.2.3" id="module-settings-commands"><span class="secno">7.2.3. </span><span class="content">Commands</span><a class="self-link" href="#module-settings-commands"></a></h4>
   <h5 class="heading settled" data-level="7.2.3.1" id="command-settings-set-settings"><span class="secno">7.2.3.1. </span><span class="content">The settings.setSettings Command</span><a class="self-link" href="#command-settings-set-settings"></a></h5>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="settingssetsettings">settings.setSettings</dfn> command sets the values of one or more settings.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Today’s implementations may not be able to detect failed modification operations. <a data-link-type="dfn" href="#settingssetsettings" id="ref-for-settingssetsettings">settings.setSettings</a> is designed to reflect that reality. Clients should therefore interpret <a data-link-type="dfn" href="#success" id="ref-for-success①①">successes</a> with some skepticism as such results do not necessarily indicate that the referenced setting has the desired value.</p>
   <p class="issue" id="issue-c41981a9"><a class="self-link" href="#issue-c41981a9"></a> Require implementations to report failures in settings modification operations.</p>
   <dl>
    <dt><a data-link-type="dfn" href="#command-type" id="ref-for-command-type①">Command Type</a>
    <dd>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingssetsettingscommand"><code>SettingsSetSettingsCommand</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsCommand" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-settingssetsettingscommand-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsCommand/method" data-dfn-type="cddl-value" data-lt="settings.setSettings|&quot;settings.setSettings&quot;" data-noexport id="cddl-value-settingssetsettingscommand-method-settingssetsettings"><code>"settings.setSettings"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsCommand" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-settingssetsettingscommand-params"><code>params</code></dfn>: <a data-link-type="cddl" href="#cddl-type-settingssetsettingsparameters" id="ref-for-cddl-type-settingssetsettingsparameters">SettingsSetSettingsParameters</a>
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingssetsettingsparameters"><code>SettingsSetSettingsParameters</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsParameters" data-dfn-type="cddl-key" data-lt="settings|&quot;settings&quot;" data-noexport id="cddl-key-settingssetsettingsparameters-settings"><code>settings</code></dfn>: [1* <a data-link-type="cddl" href="#cddl-type-settingssetsettingsparametersitem" id="ref-for-cddl-type-settingssetsettingsparametersitem">SettingsSetSettingsParametersItem</a> ],
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingssetsettingsparametersitem"><code>SettingsSetSettingsParametersItem</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsParametersItem" data-dfn-type="cddl-key" data-lt="name|&quot;name&quot;" data-noexport id="cddl-key-settingssetsettingsparametersitem-name"><code>name</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⑦">text</a>,
  <dfn class="dfn-paneled" data-dfn-for="SettingsSetSettingsParametersItem" data-dfn-type="cddl-key" data-lt="value|&quot;value&quot;" data-noexport id="cddl-key-settingssetsettingsparametersitem-value"><code>value</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⑧">any</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible⑧">Extensible</a>,
}
</pre>
    <dt><a data-link-type="dfn" href="#result-type" id="ref-for-result-type③">Result Type</a>
    <dd>
    <code>
    EmptyResult
    </code>
  
   </dl>
   <div class="algorithm" data-algorithm="remote end steps for settings.setSettings">
    <p>The <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps②">remote end steps</a> given <var>session</var> and <var>command parameters</var> are:</p>
    <ol>
     <li data-md>
      <p>Let <var>settings</var> be the value of the <code>settings</code> field of <var>command parameters</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate②">For each</a> <var>setting</var> of <var>settings</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>name</var> be the value of the <code>name</code> field of <var>setting</var>.</p>
       <li data-md>
        <p>Let <var>value</var> be the value of the <code>value</code> field of <var>setting</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="#try" id="ref-for-try②">Try</a> to <a data-link-type="dfn" href="#modify-setting" id="ref-for-modify-setting">modify setting</a> with <var>name</var> and <var>value</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>body</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑧">map</a>.</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success①②">success</a> with data <var>body</var>.</p>
    </ol>
   </div>
   <div class="example" id="example-d4f3c6c0">
    <a class="self-link" href="#example-d4f3c6c0"></a>
A <a data-link-type="dfn" href="#local-end" id="ref-for-local-end①⓪">local end</a> that wishes to modify the value of settings named
<code>readEntirePage</code> and <code>speed</code> might send a Command such as:


<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>1776</c-><c- p>,</c->
  <c- f>"method"</c-><c- p>:</c-> <c- u>"settings.setSettings"</c-><c- p>,</c->
  <c- f>"params"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"settings"</c-><c- p>:</c-> <c- p>[</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"readEntirePage"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- kc>false</c->
      <c- p>},</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"speed"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- mf>0.8</c->
      <c- p>}</c->
    <c- p>]</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>And the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⑥">remote end</a> which receives that Command could respond with the
following Message:</p>
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>1776</c-><c- p>,</c->
  <c- f>"result"</c-><c- p>:</c-> <c- p>{}</c->
<c- p>}</c->
</pre>
   </div>
   <h5 class="heading settled" data-level="7.2.3.2" id="command-settings-get-settings"><span class="secno">7.2.3.2. </span><span class="content">The settings.getSettings Command</span><a class="self-link" href="#command-settings-get-settings"></a></h5>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="settingsgetsettings-command">settings.getSettings command</dfn> returns a list of the requested settings and their values.</p>
   <dl>
    <dt><a data-link-type="dfn" href="#command-type" id="ref-for-command-type②">Command Type</a>
    <dd>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsettingscommand"><code>SettingsGetSettingsCommand</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsCommand" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-settingsgetsettingscommand-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsCommand/method" data-dfn-type="cddl-value" data-lt="settings.getSettings|&quot;settings.getSettings&quot;" data-noexport id="cddl-value-settingsgetsettingscommand-method-settingsgetsettings"><code>"settings.getSettings"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsCommand" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-settingsgetsettingscommand-params"><code>params</code></dfn>: <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsparameters" id="ref-for-cddl-type-settingsgetsettingsparameters">SettingsGetSettingsParameters</a>
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsettingsparameters"><code>SettingsGetSettingsParameters</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsParameters" data-dfn-type="cddl-key" data-lt="settings|&quot;settings&quot;" data-noexport id="cddl-key-settingsgetsettingsparameters-settings"><code>settings</code></dfn>: [1* <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsparametersitem" id="ref-for-cddl-type-settingsgetsettingsparametersitem">SettingsGetSettingsParametersItem</a> ],
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsettingsparametersitem"><code>SettingsGetSettingsParametersItem</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSettingsParametersItem" data-dfn-type="cddl-key" data-lt="name|&quot;name&quot;" data-noexport id="cddl-key-settingsgetsettingsparametersitem-name"><code>name</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D①⑨">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible⑨">Extensible</a>,
}
</pre>
    <dt><a data-link-type="dfn" href="#result-type" id="ref-for-result-type④">Result Type</a>
    <dd>
    <code>
    SettingsGetSettingsResult
    </code>
  
   </dl>
   <div class="algorithm" data-algorithm="remote end steps for settings.getSettings">
    <p>The <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps③">remote end steps</a> given <var>session</var> and <var>command parameters</var> are:</p>
    <ol>
     <li data-md>
      <p>Let <var>names</var> be the value of the <code>settings</code> field of <var>command parameters</var>.</p>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="#get-settings" id="ref-for-get-settings">get settings</a> with <var>names</var>.</p>
    </ol>
   </div>
   <div class="example" id="example-33730975">
    <a class="self-link" href="#example-33730975"></a>
A <a data-link-type="dfn" href="#local-end" id="ref-for-local-end①①">local end</a> that wishes to retrieve the value of settings named
<code>virtualBuffers.passThroughAudioIndication</code> and <code>cursor</code> might send a Command
such as:


<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>8675309</c-><c- p>,</c->
  <c- f>"method"</c-><c- p>:</c-> <c- u>"settings.getSettings"</c-><c- p>,</c->
  <c- f>"params"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"settings"</c-><c- p>:</c-> <c- p>[</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"virtualBuffers.passThroughAudioIndication"</c->
      <c- p>},</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"cursor"</c->
      <c- p>}</c->
    <c- p>]</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>And the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⑦">remote end</a> which receives that Command could respond with the
following Message:</p>
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>8675309</c-><c- p>,</c->
  <c- f>"result"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"settings"</c-><c- p>:</c-> <c- p>[</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"virtualBuffers.passThroughAudioIndication"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- kc>true</c->
      <c- p>},</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"cursor"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- u>"VPC"</c->
      <c- p>}</c->
    <c- p>]</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h5 class="heading settled" data-level="7.2.3.3" id="command-settings-get-supported-settings"><span class="secno">7.2.3.3. </span><span class="content">The settings.getSupportedSettings Command</span><a class="self-link" href="#command-settings-get-supported-settings"></a></h5>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="settingsgetsupportedsettings-command">settings.getSupportedSettings command</dfn> returns a list of all settings that the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⑧">remote end</a> supports, and their values.</p>
   <dl>
    <dt><a data-link-type="dfn" href="#command-type" id="ref-for-command-type③">Command Type</a>
    <dd>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-settingsgetsupportedsettingscommand"><code>SettingsGetSupportedSettingsCommand</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSupportedSettingsCommand" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-settingsgetsupportedsettingscommand-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="SettingsGetSupportedSettingsCommand/method" data-dfn-type="cddl-value" data-lt="settings.getSupportedSettings|&quot;settings.getSupportedSettings&quot;" data-noexport id="cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings"><code>"settings.getSupportedSettings"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="SettingsGetSupportedSettingsCommand" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-settingsgetsupportedsettingscommand-params"><code>params</code></dfn>: <a data-link-type="cddl" href="#cddl-type-emptyparams" id="ref-for-cddl-type-emptyparams">EmptyParams</a>
}
</pre>
    <dt><a data-link-type="dfn" href="#result-type" id="ref-for-result-type⑤">Result Type</a>
    <dd>
    <code>
    SettingsGetSettingsResult
    </code>
  
   </dl>
   <div class="algorithm" data-algorithm="remote end steps for settings.getSupportedSettings">
    <p>The <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps④">remote end steps</a> given <var>session</var> and <var>command parameters</var> are:</p>
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#remote-end-supported-settings" id="ref-for-remote-end-supported-settings②">supported settings</a> is null:</p>
      <ol>
       <li data-md>
        <p>Let <var>names</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise:</p>
      <ol>
       <li data-md>
        <p>Let <var>names</var> be <a data-link-type="dfn" href="#remote-end-supported-settings" id="ref-for-remote-end-supported-settings③">supported settings</a>.</p>
      </ol>
     <li data-md>
      <p>Let <var>result</var> be the result of <a data-link-type="dfn" href="#get-settings" id="ref-for-get-settings①">get settings</a> with <var>names</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#assert" id="ref-for-assert④">Assert</a>: <var>result</var> is a <a data-link-type="dfn" href="#success" id="ref-for-success①③">success</a> value.</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <div class="example" id="example-bb07fc52">
    <a class="self-link" href="#example-bb07fc52"></a>
A <a data-link-type="dfn" href="#local-end" id="ref-for-local-end①②">local end</a> that wishes to discover the settings available on a given
<a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end②⑨">remote end</a> might send a Command such as:


<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>781</c-><c- p>,</c->
  <c- f>"method"</c-><c- p>:</c-> <c- u>"settings.getSupportedSettings"</c-><c- p>,</c->
  <c- f>"params"</c-><c- p>:</c-> <c- p>{}</c->
<c- p>}</c->
</pre>
    <p>And the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end③⓪">remote end</a> which receives that Command could respond with the
following Message:</p>
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>781</c-><c- p>,</c->
  <c- f>"result"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"settings"</c-><c- p>:</c-> <c- p>[</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"virtualBuffers.passThroughAudioIndication"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- kc>true</c->
      <c- p>},</c->
      <c- p>{</c->
        <c- f>"name"</c-><c- p>:</c-> <c- u>"cursor"</c-><c- p>,</c->
        <c- f>"value"</c-><c- p>:</c-> <c- u>"VPC"</c->
      <c- p>}</c->
    <c- p>]</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="7.2.4" id="module-settings-events"><span class="secno">7.2.4. </span><span class="content">Events</span><a class="self-link" href="#module-settings-events"></a></h4>
   <p class="issue" id="issue-0b79b3d5"><a class="self-link" href="#issue-0b79b3d5"></a> Do we need a "setting changed" event?</p>
   <h3 class="heading settled" data-level="7.3" id="module-interaction"><span class="secno">7.3. </span><span class="content">The Interaction Module</span><a class="self-link" href="#module-interaction"></a></h3>
   <p>The following <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="table-of-standard-user-intents">table of standard user intents</dfn> enumerates the user intents each implementation must support.</p>
   <table>
    <caption>Standard user intents</caption>
    <tbody>
     <tr>
      <th>Name
    
      <th>Algorithm
  
     <tr>
      <td>"<code>pressKeys</code>"
    
      <td><a data-link-type="dfn" href="#press-keys" id="ref-for-press-keys">press keys</a>

   </table>
   <p>A <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end③①">remote end</a> has a <dfn class="dfn-paneled" data-dfn-for="remote end" data-dfn-type="dfn" data-noexport id="remote-end-table-of-extension-user-intents">table of extension user intents</dfn>, which is a mapping of zero or more string names of user intents and algorithms for simulating the named intents. Extension user intents' names must contain a "<code>:</code>" (colon) character, denoting an implementation specific namespace.</p>
   <div class="algorithm" data-algorithm="press keys">
    <p class="note" role="note"><span class="marker">Note:</span> Each string in <code>KeyCombination</code> represents a "raw key" consisting of a
single code point with the same meaning as in <a href="https://w3c.github.io/webdriver/#keyboard-actions">WebDriver’s keyboard
actions</a>. For example, <code>["\uE008", "a"]</code> means holding the left shift key
and pressing "a", and then releasing the left shift key. <a data-link-type="biblio" href="#biblio-webdriver" title="WebDriver">[WEBDRIVER]</a></p>
    <p class="issue" id="issue-e5a6d243"><a class="self-link" href="#issue-e5a6d243"></a> This algorithm does not yet have a means for indicating a screen-reader specific modifier key (or keys). <a href="https://github.com/w3c/at-driver/issues/34">[Issue #34]</a></p>
    <p class="issue" id="issue-1bd3afd8"><a class="self-link" href="#issue-1bd3afd8"></a> This algorithm only supports one specific kind of press/release sequence, and it is not clear if that is sufficient to express all keyboard commands in all implementations. <a href="https://github.com/w3c/at-driver/issues/51">[Issue #51]</a></p>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="press-keys">press keys</dfn> given <var>command parameters</var>:</p>
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="#try" id="ref-for-try③">Try</a> to <a data-link-type="dfn" href="#check-that-keyboard-interaction-can-be-simulated" id="ref-for-check-that-keyboard-interaction-can-be-simulated">check that keyboard interaction can be simulated</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#try" id="ref-for-try④">Try</a> to <a data-link-type="dfn" href="#check-that-one-of-the-expected-applications-has-focus" id="ref-for-check-that-one-of-the-expected-applications-has-focus">check that one of the expected applications has focus</a>.</p>
     <li data-md>
      <p>Let <var>keys</var> be the value of the <code>keys</code> field of <var>command
parameters</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate③">For each</a> <var>key</var> of <var>keys</var>:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①⓪">implementation-defined</a> steps to simulate depressing <var>key</var>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate④">For each</a> <var>key</var> of <var>keys</var> in reverse <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">List</a> order:</p>
      <ol>
       <li data-md>
        <p>Run <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined①①">implementation-defined</a> steps to simulate releasing <var>key</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>body</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map⑨">map</a>.</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="#success" id="ref-for-success①④">success</a> with data <var>body</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="7.3.1" id="module-interaction-definition"><span class="secno">7.3.1. </span><span class="content">Definition</span><a class="self-link" href="#module-interaction-definition"></a></h4>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition⑨">Remote end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactioncommand"><code>InteractionCommand</code></dfn> = (<a data-link-type="cddl" href="#cddl-type-interactionuserintentcommand" id="ref-for-cddl-type-interactionuserintentcommand">InteractionUserIntentCommand</a>)
</pre>
   <p><code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition①②">Local end definition</a></code>:</p>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactionevent"><code>InteractionEvent</code></dfn> = (<a data-link-type="cddl" href="#cddl-type-interactioncapturedoutputevent" id="ref-for-cddl-type-interactioncapturedoutputevent">InteractionCapturedOutputEvent</a>)

</pre>
   <h4 class="heading settled" data-level="7.3.2" id="module-interaction-types"><span class="secno">7.3.2. </span><span class="content">Types</span><a class="self-link" href="#module-interaction-types"></a></h4>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactioncapturedoutputparameters"><code>InteractionCapturedOutputParameters</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="InteractionCapturedOutputParameters" data-dfn-type="cddl-key" data-lt="data|&quot;data&quot;" data-noexport id="cddl-key-interactioncapturedoutputparameters-data"><code>data</code></dfn>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D②⓪">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible①⓪">Extensible</a>,
}
</pre>
   <h4 class="heading settled" data-level="7.3.3" id="module-interaction-commands"><span class="secno">7.3.3. </span><span class="content">Commands</span><a class="self-link" href="#module-interaction-commands"></a></h4>
   <h5 class="heading settled" data-level="7.3.3.1" id="module-interaction-userintent"><span class="secno">7.3.3.1. </span><span class="content">The interaction.userIntent Command</span><a class="self-link" href="#module-interaction-userintent"></a></h5>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interactionuserintent">interaction.userIntent</dfn> command simulates pressing a key combination on a keyboard.</p>
   <dl>
    <dt><a data-link-type="dfn" href="#command-type" id="ref-for-command-type④">Command Type</a>
  
    <dd>
<pre class="cddl highlight def" data-cddl-module="remote-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactionuserintentcommand"><code>InteractionUserIntentCommand</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="InteractionUserIntentCommand" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-interactionuserintentcommand-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="InteractionUserIntentCommand/method" data-dfn-type="cddl-value" data-lt="interaction.userIntent|&quot;interaction.userIntent&quot;" data-noexport id="cddl-value-interactionuserintentcommand-method-interactionuserintent"><code>"interaction.userIntent"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="InteractionUserIntentCommand" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-interactionuserintentcommand-params"><code>params</code></dfn>: <a data-link-type="cddl" href="#cddl-type-interactionuserintentparameters" id="ref-for-cddl-type-interactionuserintentparameters">InteractionUserIntentParameters</a>
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactionuserintentparameters"><code>InteractionUserIntentParameters</code></dfn> = (
  <a data-link-type="cddl" href="#cddl-type-presskeysintentparameters" id="ref-for-cddl-type-presskeysintentparameters">PressKeysIntentParameters</a> /
  <a data-link-type="cddl" href="#cddl-type-extensionintentparameters" id="ref-for-cddl-type-extensionintentparameters">ExtensionIntentParameters</a>
)

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-presskeysintentparameters"><code>PressKeysIntentParameters</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="PressKeysIntentParameters" data-dfn-type="cddl-key" data-lt="name|&quot;name&quot;" data-noexport id="cddl-key-presskeysintentparameters-name"><code>"name"</code></dfn> => <dfn class="dfn-paneled" data-dfn-for="PressKeysIntentParameters/name" data-dfn-type="cddl-value" data-lt="pressKeys|&quot;pressKeys&quot;" data-noexport id="cddl-value-presskeysintentparameters-name-presskeys"><code>"pressKeys"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="PressKeysIntentParameters" data-dfn-type="cddl-key" data-lt="keys|&quot;keys&quot;" data-noexport id="cddl-key-presskeysintentparameters-keys"><code>"keys"</code></dfn> => <a data-link-type="cddl" href="#cddl-type-keycombination" id="ref-for-cddl-type-keycombination">KeyCombination</a>,
}

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-keycombination"><code>KeyCombination</code></dfn> = [
  1* <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D②①">text</a>
]

<dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-extensionintentparameters"><code>ExtensionIntentParameters</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="ExtensionIntentParameters" data-dfn-type="cddl-key" data-lt="name|&quot;name&quot;" data-noexport id="cddl-key-extensionintentparameters-name"><code>"name"</code></dfn> => <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D" id="ref-for-appendix-D②②">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible" id="ref-for-cddl-type-extensible①①">Extensible</a>,
}
</pre>
    <dt>Result Type
  
    <dd>
     <p><code>
  EmptyResult
  </code></p>
   </dl>
   <div class="algorithm" data-algorithm="remote end steps for interaction.userIntent">
    <p>The <a data-link-type="dfn" href="#remote-end-steps" id="ref-for-remote-end-steps⑤">remote end steps</a> given <var>session</var> and <var>command parameters</var> are:</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the value of the <code>name</code> field of <var>command
parameters</var>.</p>
     <li data-md>
      <p>If there is an entry in the <a data-link-type="dfn" href="#table-of-standard-user-intents" id="ref-for-table-of-standard-user-intents">table of standard user intents</a> with name <var>name</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>algorithm</var> be the algorithm associated with user intent <var>name</var> in the <a data-link-type="dfn" href="#table-of-standard-user-intents" id="ref-for-table-of-standard-user-intents①">table of standard user intents</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise, if there is an entry in the <a data-link-type="dfn" href="#remote-end-table-of-extension-user-intents" id="ref-for-remote-end-table-of-extension-user-intents">table of extension user intents</a> with name <var>name</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>algorithm</var> be the algorithm associated with user intent <var>name</var> in the <a data-link-type="dfn" href="#remote-end-table-of-extension-user-intents" id="ref-for-remote-end-table-of-extension-user-intents①">table of extension user intents</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise:</p>
      <ol>
       <li data-md>
        <p>Return an <a data-link-type="dfn" href="#error" id="ref-for-error①③">error</a> with <a data-link-type="dfn" href="#error-code" id="ref-for-error-code⑦">error code</a> <a data-link-type="dfn" href="#error-code-unknown-user-intent" id="ref-for-error-code-unknown-user-intent">unknown user intent</a>.</p>
      </ol>
     <li data-md>
      <p>Return the result of evaluating <var>algorithm</var> given <var>command parameters</var>.</p>
    </ol>
   </div>
   <div class="example" id="example-62193e21">
    <a class="self-link" href="#example-62193e21"></a>
A <a data-link-type="dfn" href="#local-end" id="ref-for-local-end①③">local end</a> that wishes to simulate pressing
<kbd><kbd>Control</kbd>+<kbd>h</kbd></kbd> (or, stated more formally:
depressing the <kbd>Control</kbd> key, depressing the <kbd>h</kbd> key,
releasing the <kbd>h</kbd> key, and finally releasing the <kbd>Control</kbd>
key) might send a Command such as:


<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>19860814</c-><c- p>,</c->
  <c- f>"method"</c-><c- p>:</c-> <c- u>"interaction.userIntent"</c-><c- p>,</c->
  <c- f>"params"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"name"</c-><c- p>:</c-> <c- u>"pressKeys"</c-><c- p>,</c->
    <c- f>"keys"</c-><c- p>:</c-> <c- p>[</c-><c- u>"\uE009"</c-><c- p>,</c-> <c- u>"h"</c-><c- p>]</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>And the <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end③②">remote end</a> which receives that Command could respond with the
following Message:</p>
<pre class="language-json highlight"><c- p>{</c->
  <c- f>"id"</c-><c- p>:</c-> <c- mi>19860814</c-><c- p>,</c->
  <c- f>"result"</c-><c- p>:</c-> <c- p>{}</c->
<c- p>}</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="7.3.4" id="module-interaction-events"><span class="secno">7.3.4. </span><span class="content">Events</span><a class="self-link" href="#module-interaction-events"></a></h4>
   <h5 class="heading settled" data-level="7.3.4.1" id="event-interaction-capturedOutput"><span class="secno">7.3.4.1. </span><span class="content">The interaction.capturedOutput Event</span><a class="self-link" href="#event-interaction-capturedOutput"></a></h5>
   <dl>
    <dt>Event Type
  
    <dd>
<pre class="cddl highlight def" data-cddl-module="local-cddl"><dfn class="dfn-paneled" data-dfn-type="cddl-type" data-noexport id="cddl-type-interactioncapturedoutputevent"><code>InteractionCapturedOutputEvent</code></dfn> = {
  <dfn class="dfn-paneled" data-dfn-for="InteractionCapturedOutputEvent" data-dfn-type="cddl-key" data-lt="method|&quot;method&quot;" data-noexport id="cddl-key-interactioncapturedoutputevent-method"><code>method</code></dfn>: <dfn class="dfn-paneled" data-dfn-for="InteractionCapturedOutputEvent/method" data-dfn-type="cddl-value" data-lt="interaction.capturedOutput|&quot;interaction.capturedOutput&quot;" data-noexport id="cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput"><code>"interaction.capturedOutput"</code></dfn>,
  <dfn class="dfn-paneled" data-dfn-for="InteractionCapturedOutputEvent" data-dfn-type="cddl-key" data-lt="params|&quot;params&quot;" data-noexport id="cddl-key-interactioncapturedoutputevent-params"><code>params</code></dfn>: <a data-link-type="cddl" href="#cddl-type-interactioncapturedoutputparameters" id="ref-for-cddl-type-interactioncapturedoutputparameters">InteractionCapturedOutputParameters</a>
}
</pre>
   </dl>
   <div class="algorithm" data-algorithm="remote end event trigger for interaction.capturedOutput">
    <p>The <a data-link-type="dfn" href="#remote-end-event-trigger" id="ref-for-remote-end-event-trigger">remote end event trigger</a> is:</p>
    <p>When the assistive technology would send some text <var>data</var> (a string, without speech-specific markup or annotations) to the Text-To-Speech system, or equivalent for non-speech assistive technology software, run these steps:</p>
    <ol>
     <li data-md>
      <p>If <var>data</var> <a data-link-type="dfn" href="#should-be-withheld" id="ref-for-should-be-withheld">should be withheld</a>:</p>
      <ol>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>Let <var>params</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①⓪">map</a> matching the <code>InteractionCapturedOutputParameters</code> production with the <code>data</code> field set to <var>data</var>.</p>
     <li data-md>
      <p>Let <var>body</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①①">map</a> matching the <code>InteractionCapturedOutputEvent</code> production with the <code>params</code> field set to <var>params</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate⑤">For each</a> <var>session</var> of <a data-link-type="dfn" href="#remote-end-active-sessions" id="ref-for-remote-end-active-sessions⑤">active sessions</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="#emit-an-event" id="ref-for-emit-an-event">Emit an event</a> with <var>session</var> and <var>body</var>.</p>
      </ol>
    </ol>
   </div>
   <h2 class="heading settled" data-level="8" id="privacy"><span class="secno">8. </span><span class="content">Privacy</span><a class="self-link" href="#privacy"></a></h2>
   <p>It is advisable that <a data-link-type="dfn" href="#remote-end" id="ref-for-remote-end③③">remote ends</a> create a new profile when creating a new session. This prevents potentially sensitive session data from being accessible to new sessions, ensuring both privacy and preventing state from bleeding through to the next session.</p>
   <h2 class="heading settled" data-level="9" id="security"><span class="secno">9. </span><span class="content">Security</span><a class="self-link" href="#security"></a></h2>
   <p>An assistive technology can rely on a command-line flag or a configuration option to test whether to enable AT Driver, or alternatively make the assistive technology initiate or confirm the connection through a privileged content document or control widget, in case the assistive technology does not directly implement the WebSocket endpoints.</p>
   <p>It is strongly suggested that assistive technology require users to take explicit action to enable AT Driver, and that AT Driver remains disabled in publicly consumed versions of the assistive technology.</p>
   <p>To prevent arbitrary machines on the network from connecting and creating sessions, it is suggested that only connections from loopback devices are allowed by default.</p>
   <p>The remote end can include a configuration option to limit the accepted IP range allowed to connect and make requests. The default setting for this might be to limit connections to the IPv4 localhost CIDR range 127.0.0.0/8 and the IPv6 localhost address ::1. <a data-link-type="biblio" href="#biblio-rfc4632" title="Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan">[RFC4632]</a></p>
   <p>It is also suggested that assistive technologies make an effort to indicate that a session that is under control of AT Driver. The indication should be accessible also for non-visual users. For example, this can be done through an OS-level notification or alert dialog.</p>
   <p class="issue" id="issue-f9e956aa"><a class="self-link" href="#issue-f9e956aa"></a> TODO sandbox (limit availability to information that apps usually can’t access, e.g. login screen).</p>
   <p class="issue" id="issue-0225dc78"><a class="self-link" href="#issue-0225dc78"></a> TODO no HID level simulated keypresses.</p>
   <p class="issue" id="issue-fbd6fc51"><a class="self-link" href="#issue-fbd6fc51"></a> TODO exclude access to any security-sensitive settings.</p>
   <p class="issue" id="issue-398c181d"><a class="self-link" href="#issue-398c181d"></a> TODO exclude access to any security-sensitive commands.</p>
   <h2 class="heading settled" id="schemas"><span class="content">Appendix A: Schemas</span><a class="self-link" href="#schemas"></a></h2>
   <p>The <code class="cddl"><a data-link-type="cddl" href="#cddl-module-remote-end-definition" id="ref-for-cddl-module-remote-end-definition①⓪">remote end definition</a></code> and <code class="cddl"><a data-link-type="cddl" href="#cddl-module-local-end-definition" id="ref-for-cddl-module-local-end-definition①③">local end definition</a></code> are available as non-normative CDDL and JSON Schema schemas:</p>
   <ul>
    <li data-md>
     <p><a href="schemas/at-driver-remote.cddl">at-driver-remote.cddl</a></p>
    <li data-md>
     <p><a href="schemas/at-driver-local.cddl">at-driver-local.cddl</a></p>
    <li data-md>
     <p><a href="schemas/at-driver-remote.json">at-driver-remote.json</a></p>
    <li data-md>
     <p><a href="schemas/at-driver-local.json">at-driver-local.json</a></p>
   </ul>
   <p class="issue" id="issue-f906273a"><a class="self-link" href="#issue-f906273a"></a> The JSON Schema files are not yet generated from the CDDL and so might be out of date. <a href="https://github.com/w3c/at-driver/issues/23">[Issue #23]</a></p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification.

    </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a>

    </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this:

    </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a>
        
    <p>This is an example of an informative example.
    </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this:

    </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm.

    </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize.
</p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#remote-end-active-listeners">active listeners</a><span>, in § 6</span>
   <li><a href="#remote-end-active-sessions">active sessions</a><span>, in § 5.3</span>
   <li><a href="#cddl-key-capabilitiesrequestparameters-alwaysmatch">"alwaysMatch"</a><span>, in § 7.1.3.1</span>
   <li><a href="#cddl-key-capabilitiesrequestparameters-alwaysmatch">alwaysMatch</a><span>, in § 7.1.3.1</span>
   <li><a href="#session-associated-with-connection">associated with connection</a><span>, in § 6</span>
   <li>
    "atName"
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-atname">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-atname">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#standard-capabilities-at-name">AT name</a><span>, in § 5.2</span>
   <li>
    atName
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-atname">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-atname">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li>
    "atVersion"
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-atversion">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-atversion">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#standard-capabilities-at-version">AT version</a><span>, in § 5.2</span>
   <li>
    atVersion
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-atversion">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-atversion">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#error-code-cannot-simulate-keyboard-interaction">cannot simulate keyboard interaction</a><span>, in § 5.7</span>
   <li>
    "capabilities"
    <ul>
     <li><a href="#cddl-key-sessionnewcommand-params-capabilities">cddl-key for SessionNewCommand/params</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities">cddl-key for SessionNewResult</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#capabilities">Capabilities</a><span>, in § 5.2</span>
   <li>
    capabilities
    <ul>
     <li><a href="#cddl-key-sessionnewcommand-params-capabilities">cddl-key for SessionNewCommand/params</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities">cddl-key for SessionNewResult</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#cddl-type-capabilitiesrequest">CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
   <li><a href="#cddl-type-capabilitiesrequestparameters">CapabilitiesRequestParameters</a><span>, in § 7.1.3.1</span>
   <li><a href="#check-that-keyboard-interaction-can-be-simulated">check that keyboard interaction can be simulated</a><span>, in § 5.8</span>
   <li><a href="#check-that-one-of-the-expected-applications-has-focus">check that one of the expected applications has focus</a><span>, in § 5.8</span>
   <li><a href="#cddl-type-command">Command</a><span>, in § 5.1</span>
   <li><a href="#command">command</a><span>, in § 5.5</span>
   <li><a href="#cddl-type-commanddata">CommandData</a><span>, in § 5.1</span>
   <li><a href="#command-name">command name</a><span>, in § 5.5</span>
   <li><a href="#command-parameters">command parameters</a><span>, in § 5.5</span>
   <li><a href="#cddl-type-commandresponse">CommandResponse</a><span>, in § 5.1</span>
   <li><a href="#command-type">command type</a><span>, in § 5.5</span>
   <li><a href="#cddl-key-interactioncapturedoutputparameters-data">"data"</a><span>, in § 7.3.2</span>
   <li><a href="#cddl-key-interactioncapturedoutputparameters-data">data</a><span>, in § 7.3.2</span>
   <li><a href="#emit-an-event">emit an event</a><span>, in § 6</span>
   <li><a href="#cddl-type-emptyparams">EmptyParams</a><span>, in § 5.1</span>
   <li><a href="#cddl-type-emptyresult">EmptyResult</a><span>, in § 5.1</span>
   <li><a href="#cddl-key-errorresponse-error">"error"</a><span>, in § 5.1</span>
   <li>
    error
    <ul>
     <li><a href="#cddl-key-errorresponse-error">cddl-key for ErrorResponse</a><span>, in § 5.1</span>
     <li><a href="#error">definition of</a><span>, in § 3</span>
    </ul>
   <li><a href="#error-code">error code</a><span>, in § 5.7</span>
   <li><a href="#cddl-type-errorresponse">ErrorResponse</a><span>, in § 5.1</span>
   <li><a href="#cddl-type-event">Event</a><span>, in § 5.1</span>
   <li><a href="#event">event</a><span>, in § 5.6</span>
   <li><a href="#cddl-type-eventdata">EventData</a><span>, in § 5.1</span>
   <li><a href="#event-name">event name</a><span>, in § 5.6</span>
   <li><a href="#event-parameters">event parameters</a><span>, in § 5.6</span>
   <li><a href="#event-type">event type</a><span>, in § 5.6</span>
   <li><a href="#cddl-type-extensible">Extensible</a><span>, in § 5.1</span>
   <li><a href="#extension-capabilities">extension capabilities</a><span>, in § 5.2</span>
   <li><a href="#cddl-type-extensionintentparameters">ExtensionIntentParameters</a><span>, in § 7.3.3.1</span>
   <li><a href="#extension-modules">extension modules</a><span>, in § 5.4</span>
   <li><a href="#generating-a-uuid">Generating a UUID</a><span>, in § 3</span>
   <li><a href="#get-settings">get settings</a><span>, in § 7.2</span>
   <li><a href="#handle-a-connection-closing">handle a connection closing</a><span>, in § 6</span>
   <li><a href="#handle-an-incoming-message">handle an incoming message</a><span>, in § 6</span>
   <li><a href="#websocket-listener-host">host</a><span>, in § 6</span>
   <li>
    "id"
    <ul>
     <li><a href="#cddl-key-command-id">cddl-key for Command</a><span>, in § 5.1</span>
     <li><a href="#cddl-key-commandresponse-id">cddl-key for CommandResponse</a><span>, in § 5.1</span>
     <li><a href="#cddl-key-errorresponse-id">cddl-key for ErrorResponse</a><span>, in § 5.1</span>
    </ul>
   <li>
    id
    <ul>
     <li><a href="#cddl-key-command-id">cddl-key for Command</a><span>, in § 5.1</span>
     <li><a href="#cddl-key-commandresponse-id">cddl-key for CommandResponse</a><span>, in § 5.1</span>
     <li><a href="#cddl-key-errorresponse-id">cddl-key for ErrorResponse</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput">"interaction.capturedOutput"</a><span>, in § 7.3.4.1</span>
   <li><a href="#cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput">interaction.capturedOutput</a><span>, in § 7.3.4.1</span>
   <li><a href="#cddl-type-interactioncapturedoutputevent">InteractionCapturedOutputEvent</a><span>, in § 7.3.4.1</span>
   <li><a href="#cddl-type-interactioncapturedoutputparameters">InteractionCapturedOutputParameters</a><span>, in § 7.3.2</span>
   <li><a href="#cddl-type-interactioncommand">InteractionCommand</a><span>, in § 7.3.1</span>
   <li><a href="#cddl-type-interactionevent">InteractionEvent</a><span>, in § 7.3.1</span>
   <li><a href="#cddl-value-interactionuserintentcommand-method-interactionuserintent">"interaction.userIntent"</a><span>, in § 7.3.3.1</span>
   <li>
    interaction.userIntent
    <ul>
     <li><a href="#cddl-value-interactionuserintentcommand-method-interactionuserintent">cddl-value for InteractionUserIntentCommand/method</a><span>, in § 7.3.3.1</span>
     <li><a href="#interactionuserintent">definition of</a><span>, in § 7.3.3.1</span>
    </ul>
   <li><a href="#cddl-type-interactionuserintentcommand">InteractionUserIntentCommand</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-type-interactionuserintentparameters">InteractionUserIntentParameters</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-value-errorresponse-error-invalid-argument">"invalid argument"</a><span>, in § 5.1</span>
   <li>
    invalid argument
    <ul>
     <li><a href="#cddl-value-errorresponse-error-invalid-argument">cddl-value for ErrorResponse/error</a><span>, in § 5.1</span>
     <li><a href="#error-code-invalid-argument">dfn for error code</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#error-code-invalid-os-focus-state">invalid OS focus state</a><span>, in § 5.7</span>
   <li><a href="#error-code-invalid-session-id">invalid session id</a><span>, in § 5.7</span>
   <li><a href="#cddl-type-keycombination">KeyCombination</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-key-presskeysintentparameters-keys">"keys"</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-key-presskeysintentparameters-keys">keys</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-module-local-end-definition">local-cddl</a><span>, in § 5</span>
   <li><a href="#local-end">local end</a><span>, in § 4</span>
   <li><a href="#cddl-module-local-end-definition">Local end definition</a><span>, in § 5</span>
   <li><a href="#cddl-module-local-end-definition">local end definition</a><span>, in § 5</span>
   <li><a href="#match-capabilities">match capabilities</a><span>, in § 5.2</span>
   <li><a href="#cddl-key-errorresponse-message">"message"</a><span>, in § 5.1</span>
   <li><a href="#cddl-type-message">Message</a><span>, in § 5.1</span>
   <li><a href="#cddl-key-errorresponse-message">message</a><span>, in § 5.1</span>
   <li>
    "method"
    <ul>
     <li><a href="#cddl-key-interactioncapturedoutputevent-method">cddl-key for InteractionCapturedOutputEvent</a><span>, in § 7.3.4.1</span>
     <li><a href="#cddl-key-interactionuserintentcommand-method">cddl-key for InteractionUserIntentCommand</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-sessionnewcommand-method">cddl-key for SessionNewCommand</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingscommand-method">cddl-key for SettingsGetSettingsCommand</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsupportedsettingscommand-method">cddl-key for SettingsGetSupportedSettingsCommand</a><span>, in § 7.2.3.3</span>
     <li><a href="#cddl-key-settingssetsettingscommand-method">cddl-key for SettingsSetSettingsCommand</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    method
    <ul>
     <li><a href="#cddl-key-interactioncapturedoutputevent-method">cddl-key for InteractionCapturedOutputEvent</a><span>, in § 7.3.4.1</span>
     <li><a href="#cddl-key-interactionuserintentcommand-method">cddl-key for InteractionUserIntentCommand</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-sessionnewcommand-method">cddl-key for SessionNewCommand</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingscommand-method">cddl-key for SettingsGetSettingsCommand</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsupportedsettingscommand-method">cddl-key for SettingsGetSupportedSettingsCommand</a><span>, in § 7.2.3.3</span>
     <li><a href="#cddl-key-settingssetsettingscommand-method">cddl-key for SettingsSetSettingsCommand</a><span>, in § 7.2.3.1</span>
    </ul>
   <li><a href="#modify-setting">modify setting</a><span>, in § 7.2</span>
   <li><a href="#module">module</a><span>, in § 5.4</span>
   <li><a href="#module-name">module name</a><span>, in § 5.4</span>
   <li>
    "name"
    <ul>
     <li><a href="#cddl-key-extensionintentparameters-name">cddl-key for ExtensionIntentParameters</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-presskeysintentparameters-name">cddl-key for PressKeysIntentParameters</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingsparametersitem-name">cddl-key for SettingsGetSettingsParametersItem</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsettingsresultitem-name">cddl-key for SettingsGetSettingsResultItem</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparametersitem-name">cddl-key for SettingsSetSettingsParametersItem</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    name
    <ul>
     <li><a href="#cddl-key-extensionintentparameters-name">cddl-key for ExtensionIntentParameters</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-presskeysintentparameters-name">cddl-key for PressKeysIntentParameters</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingsparametersitem-name">cddl-key for SettingsGetSettingsParametersItem</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsettingsresultitem-name">cddl-key for SettingsGetSettingsResultItem</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparametersitem-name">cddl-key for SettingsSetSettingsParametersItem</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    "params"
    <ul>
     <li><a href="#cddl-key-interactioncapturedoutputevent-params">cddl-key for InteractionCapturedOutputEvent</a><span>, in § 7.3.4.1</span>
     <li><a href="#cddl-key-interactionuserintentcommand-params">cddl-key for InteractionUserIntentCommand</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-sessionnewcommand-params">cddl-key for SessionNewCommand</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingscommand-params">cddl-key for SettingsGetSettingsCommand</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsupportedsettingscommand-params">cddl-key for SettingsGetSupportedSettingsCommand</a><span>, in § 7.2.3.3</span>
     <li><a href="#cddl-key-settingssetsettingscommand-params">cddl-key for SettingsSetSettingsCommand</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    params
    <ul>
     <li><a href="#cddl-key-interactioncapturedoutputevent-params">cddl-key for InteractionCapturedOutputEvent</a><span>, in § 7.3.4.1</span>
     <li><a href="#cddl-key-interactionuserintentcommand-params">cddl-key for InteractionUserIntentCommand</a><span>, in § 7.3.3.1</span>
     <li><a href="#cddl-key-sessionnewcommand-params">cddl-key for SessionNewCommand</a><span>, in § 7.1.3.1</span>
     <li><a href="#cddl-key-settingsgetsettingscommand-params">cddl-key for SettingsGetSettingsCommand</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsupportedsettingscommand-params">cddl-key for SettingsGetSupportedSettingsCommand</a><span>, in § 7.2.3.3</span>
     <li><a href="#cddl-key-settingssetsettingscommand-params">cddl-key for SettingsSetSettingsCommand</a><span>, in § 7.2.3.1</span>
    </ul>
   <li><a href="#standard-capabilities-platform">Platform</a><span>, in § 5.2</span>
   <li>
    "platformName"
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-platformname">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-platformname">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li>
    platformName
    <ul>
     <li><a href="#cddl-key-capabilitiesrequest-platformname">cddl-key for CapabilitiesRequest</a><span>, in § 7.1.2.1</span>
     <li><a href="#cddl-key-sessionnewresult-capabilities-platformname">cddl-key for SessionNewResult/capabilities</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#websocket-listener-port">port</a><span>, in § 6</span>
   <li><a href="#cddl-value-presskeysintentparameters-name-presskeys">"pressKeys"</a><span>, in § 7.3.3.1</span>
   <li><a href="#press-keys">press keys</a><span>, in § 7.3</span>
   <li><a href="#cddl-value-presskeysintentparameters-name-presskeys">pressKeys</a><span>, in § 7.3.3.1</span>
   <li><a href="#cddl-type-presskeysintentparameters">PressKeysIntentParameters</a><span>, in § 7.3.3.1</span>
   <li><a href="#process-capabilities">process capabilities</a><span>, in § 5.2</span>
   <li><a href="#cddl-module-remote-end-definition">remote-cddl</a><span>, in § 5</span>
   <li><a href="#remote-end">remote end</a><span>, in § 4</span>
   <li><a href="#cddl-module-remote-end-definition">Remote end definition</a><span>, in § 5</span>
   <li><a href="#cddl-module-remote-end-definition">remote end definition</a><span>, in § 5</span>
   <li><a href="#remote-end-event-trigger">remote end event trigger</a><span>, in § 5.6</span>
   <li><a href="#remote-end-steps">remote end steps</a><span>, in § 5.5</span>
   <li><a href="#cddl-key-commandresponse-result">"result"</a><span>, in § 5.1</span>
   <li><a href="#cddl-key-commandresponse-result">result</a><span>, in § 5.1</span>
   <li><a href="#cddl-type-resultdata">ResultData</a><span>, in § 5.1</span>
   <li><a href="#result-type">result type</a><span>, in § 5.5</span>
   <li><a href="#websocket-listener-secure-flag">secure flag</a><span>, in § 6</span>
   <li><a href="#send-an-error-response">send an error response</a><span>, in § 6</span>
   <li><a href="#session">session</a><span>, in § 5.3</span>
   <li><a href="#cddl-type-sessioncommand">SessionCommand</a><span>, in § 7.1.1</span>
   <li><a href="#cddl-key-sessionnewresult-sessionid">"sessionId"</a><span>, in § 7.1.3.1</span>
   <li><a href="#session-session-id">session ID</a><span>, in § 5.3</span>
   <li><a href="#cddl-key-sessionnewresult-sessionid">sessionId</a><span>, in § 7.1.3.1</span>
   <li><a href="#cddl-value-sessionnewcommand-method-sessionnew">"session.new"</a><span>, in § 7.1.3.1</span>
   <li>
    session.new
    <ul>
     <li><a href="#cddl-value-sessionnewcommand-method-sessionnew">cddl-value for SessionNewCommand/method</a><span>, in § 7.1.3.1</span>
     <li><a href="#sessionnew">definition of</a><span>, in § 7.1.3.1</span>
    </ul>
   <li><a href="#cddl-type-sessionnewcommand">SessionNewCommand</a><span>, in § 7.1.3.1</span>
   <li><a href="#cddl-type-sessionnewresult">SessionNewResult</a><span>, in § 7.1.3.1</span>
   <li><a href="#cddl-value-errorresponse-error-session-not-created">"session not created"</a><span>, in § 5.1</span>
   <li>
    session not created
    <ul>
     <li><a href="#cddl-value-errorresponse-error-session-not-created">cddl-value for ErrorResponse/error</a><span>, in § 5.1</span>
     <li><a href="#error-code-session-not-created">dfn for error code</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#cddl-type-sessionresult">SessionResult</a><span>, in § 7.1.1</span>
   <li><a href="#session-session-websocket-connections">session WebSocket connections</a><span>, in § 6</span>
   <li><a href="#set-of-all-command-names">set of all command names</a><span>, in § 5.5</span>
   <li>
    "settings"
    <ul>
     <li><a href="#cddl-key-settingsgetsettingsparameters-settings">cddl-key for SettingsGetSettingsParameters</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsettingsresult-settings">cddl-key for SettingsGetSettingsResult</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparameters-settings">cddl-key for SettingsSetSettingsParameters</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    settings
    <ul>
     <li><a href="#cddl-key-settingsgetsettingsparameters-settings">cddl-key for SettingsGetSettingsParameters</a><span>, in § 7.2.3.2</span>
     <li><a href="#cddl-key-settingsgetsettingsresult-settings">cddl-key for SettingsGetSettingsResult</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparameters-settings">cddl-key for SettingsSetSettingsParameters</a><span>, in § 7.2.3.1</span>
    </ul>
   <li><a href="#cddl-type-settingscommand">SettingsCommand</a><span>, in § 7.2.1</span>
   <li><a href="#cddl-value-settingsgetsettingscommand-method-settingsgetsettings">"settings.getSettings"</a><span>, in § 7.2.3.2</span>
   <li><a href="#cddl-value-settingsgetsettingscommand-method-settingsgetsettings">settings.getSettings</a><span>, in § 7.2.3.2</span>
   <li><a href="#settingsgetsettings-command">settings.getSettings command</a><span>, in § 7.2.3.2</span>
   <li><a href="#cddl-type-settingsgetsettingscommand">SettingsGetSettingsCommand</a><span>, in § 7.2.3.2</span>
   <li><a href="#cddl-type-settingsgetsettingsparameters">SettingsGetSettingsParameters</a><span>, in § 7.2.3.2</span>
   <li><a href="#cddl-type-settingsgetsettingsparametersitem">SettingsGetSettingsParametersItem</a><span>, in § 7.2.3.2</span>
   <li><a href="#cddl-type-settingsgetsettingsresult">SettingsGetSettingsResult</a><span>, in § 7.2.2.1</span>
   <li><a href="#cddl-type-settingsgetsettingsresultitem">SettingsGetSettingsResultItem</a><span>, in § 7.2.2.1</span>
   <li><a href="#cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings">"settings.getSupportedSettings"</a><span>, in § 7.2.3.3</span>
   <li><a href="#cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings">settings.getSupportedSettings</a><span>, in § 7.2.3.3</span>
   <li><a href="#settingsgetsupportedsettings-command">settings.getSupportedSettings command</a><span>, in § 7.2.3.3</span>
   <li><a href="#cddl-type-settingsgetsupportedsettingscommand">SettingsGetSupportedSettingsCommand</a><span>, in § 7.2.3.3</span>
   <li><a href="#cddl-type-settingsresult">SettingsResult</a><span>, in § 7.2.1</span>
   <li><a href="#cddl-value-settingssetsettingscommand-method-settingssetsettings">"settings.setSettings"</a><span>, in § 7.2.3.1</span>
   <li>
    settings.setSettings
    <ul>
     <li><a href="#cddl-value-settingssetsettingscommand-method-settingssetsettings">cddl-value for SettingsSetSettingsCommand/method</a><span>, in § 7.2.3.1</span>
     <li><a href="#settingssetsettings">definition of</a><span>, in § 7.2.3.1</span>
    </ul>
   <li><a href="#cddl-type-settingssetsettingscommand">SettingsSetSettingsCommand</a><span>, in § 7.2.3.1</span>
   <li><a href="#cddl-type-settingssetsettingsparameters">SettingsSetSettingsParameters</a><span>, in § 7.2.3.1</span>
   <li><a href="#cddl-type-settingssetsettingsparametersitem">SettingsSetSettingsParametersItem</a><span>, in § 7.2.3.1</span>
   <li><a href="#should-be-withheld">should be withheld</a><span>, in § 5.8</span>
   <li><a href="#cddl-key-errorresponse-stacktrace">"stacktrace"</a><span>, in § 5.1</span>
   <li><a href="#cddl-key-errorresponse-stacktrace">stacktrace</a><span>, in § 5.1</span>
   <li><a href="#standard-capabilities">standard capabilities</a><span>, in § 5.2</span>
   <li><a href="#start-listening-for-a-websocket-connection">start listening for a WebSocket connection</a><span>, in § 6</span>
   <li><a href="#static-command">static command</a><span>, in § 5.5</span>
   <li><a href="#success">success</a><span>, in § 3</span>
   <li><a href="#remote-end-supported-settings">supported settings</a><span>, in § 7.2</span>
   <li><a href="#remote-end-table-of-extension-user-intents">table of extension user intents</a><span>, in § 7.3</span>
   <li><a href="#table-of-standard-user-intents">table of standard user intents</a><span>, in § 7.3</span>
   <li><a href="#try">try</a><span>, in § 3</span>
   <li><a href="#try">trying</a><span>, in § 3</span>
   <li><a href="#cddl-value-errorresponse-error-unknown-command">"unknown command"</a><span>, in § 5.1</span>
   <li>
    unknown command
    <ul>
     <li><a href="#cddl-value-errorresponse-error-unknown-command">cddl-value for ErrorResponse/error</a><span>, in § 5.1</span>
     <li><a href="#error-code-unknown-command">dfn for error code</a><span>, in § 5.7</span>
    </ul>
   <li><a href="#cddl-value-errorresponse-error-unknown-error">"unknown error"</a><span>, in § 5.1</span>
   <li><a href="#cddl-value-errorresponse-error-unknown-error">unknown error</a><span>, in § 5.1</span>
   <li><a href="#error-code-unknown-user-intent">unknown user intent</a><span>, in § 5.7</span>
   <li><a href="#uuid">UUID</a><span>, in § 3</span>
   <li><a href="#validate-setting-name">validate setting name</a><span>, in § 7.2</span>
   <li>
    "value"
    <ul>
     <li><a href="#cddl-key-settingsgetsettingsresultitem-value">cddl-key for SettingsGetSettingsResultItem</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparametersitem-value">cddl-key for SettingsSetSettingsParametersItem</a><span>, in § 7.2.3.1</span>
    </ul>
   <li>
    value
    <ul>
     <li><a href="#cddl-key-settingsgetsettingsresultitem-value">cddl-key for SettingsGetSettingsResultItem</a><span>, in § 7.2.2.1</span>
     <li><a href="#cddl-key-settingssetsettingsparametersitem-value">cddl-key for SettingsSetSettingsParametersItem</a><span>, in § 7.2.3.1</span>
    </ul>
   <li><a href="#websocket-connection">WebSocket connection</a><span>, in § 6</span>
   <li><a href="#remote-end-websocket-connections-not-associated-with-a-session">WebSocket connections not associated with a session</a><span>, in § 6</span>
   <li><a href="#websocket-listener">WebSocket listener</a><span>, in § 6</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a72449dd">in parallel</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="53275e46">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a3b18719">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="6f2dfa22">ASCII lowercase</span>
     <li><span class="dfn-paneled" id="77b4c09a">assert</span>
     <li><span class="dfn-paneled" id="ae8def21">contain <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a326add7">contain <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="03afaf9c">empty</span>
     <li><span class="dfn-paneled" id="1243a891">exist</span>
     <li><span class="dfn-paneled" id="16d07e10">for each <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="45209803">for each <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="860300d4">implementation-defined</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="3fca5a9e">map</span>
     <li><span class="dfn-paneled" id="8e8decb4">parse JSON into Infra values</span>
     <li><span class="dfn-paneled" id="762869d3">scalar value string</span>
     <li><span class="dfn-paneled" id="4c07280e">serialize an Infra value to JSON bytes</span>
     <li><span class="dfn-paneled" id="15e48c39">set</span>
     <li><span class="dfn-paneled" id="0e6b2056">set <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="653d0848">size</span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8610]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ef593226">any</span>
     <li><span class="dfn-paneled" id="523b9b71">null</span>
     <li><span class="dfn-paneled" id="c3bd1df0">text</span>
     <li><span class="dfn-paneled" id="6a303638">uint</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc6455">[RFC6455]
   <dd>I. Fette; A. Melnikov. <a href="https://www.rfc-editor.org/rfc/rfc6455"><cite>The WebSocket Protocol</cite></a>. December 2011. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6455">https://www.rfc-editor.org/rfc/rfc6455</a>
   <dt id="biblio-rfc8610">[RFC8610]
   <dd>H. Birkholz; C. Vigano; C. Bormann. <a href="https://www.rfc-editor.org/rfc/rfc8610"><cite>Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures</cite></a>. June 2019. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>
   <dt id="biblio-rfc9562">[RFC9562]
   <dd>K. Davis; B. Peabody; P. Leach. <a href="https://www.rfc-editor.org/rfc/rfc9562"><cite>Universally Unique IDentifiers (UUIDs)</cite></a>. May 2024. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9562">https://www.rfc-editor.org/rfc/rfc9562</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-rfc4632">[RFC4632]
   <dd>V. Fuller; T. Li. <a href="https://www.rfc-editor.org/rfc/rfc4632"><cite>Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</cite></a>. August 2006. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc4632">https://www.rfc-editor.org/rfc/rfc4632</a>
   <dt id="biblio-webdriver">[WEBDRIVER]
   <dd>Simon Stewart; David Burns. <a href="https://w3c.github.io/webdriver/"><cite>WebDriver</cite></a>. URL: <a href="https://w3c.github.io/webdriver/">https://w3c.github.io/webdriver/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="cddl-index"><span class="content">CDDL Index</span><a class="self-link" href="#cddl-index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="cddl-index-cddl-module-remote-end-definition"><span class="content">Remote end definition</span><a class="self-link" href="#cddl-index-cddl-module-remote-end-definition"></a></h3>
<pre class="cddl highlight def"><a href="#cddl-type-command"><code>Command</code></a> = {
  <a href="#cddl-key-command-id"><code>id</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">uint</a>,
  <a data-link-type="cddl" href="#cddl-type-commanddata">CommandData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-commanddata"><code>CommandData</code></a> = (
  <a data-link-type="cddl" href="#cddl-type-sessioncommand">SessionCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingscommand">SettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-interactioncommand">InteractionCommand</a>
)

<a href="#cddl-type-emptyparams"><code>EmptyParams</code></a> = { <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a> }

<a href="#cddl-type-extensible"><code>Extensible</code></a> = {
  *<a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a> => <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">any</a>
}

<a href="#cddl-type-sessioncommand"><code>SessionCommand</code></a> = (<a data-link-type="cddl" href="#cddl-type-sessionnewcommand">SessionNewCommand</a>)

<a href="#cddl-type-capabilitiesrequest"><code>CapabilitiesRequest</code></a> = {
  ?<a href="#cddl-key-capabilitiesrequest-atname"><code>atName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  ?<a href="#cddl-key-capabilitiesrequest-atversion"><code>atVersion</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  ?<a href="#cddl-key-capabilitiesrequest-platformname"><code>platformName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-sessionnewcommand"><code>SessionNewCommand</code></a> = {
  <a href="#cddl-key-sessionnewcommand-method"><code>method</code></a>: <a href="#cddl-value-sessionnewcommand-method-sessionnew"><code>"session.new"</code></a>,
  <a href="#cddl-key-sessionnewcommand-params"><code>params</code></a>: {<a href="#cddl-key-sessionnewcommand-params-capabilities"><code>capabilities</code></a>: <a data-link-type="cddl" href="#cddl-type-capabilitiesrequestparameters">CapabilitiesRequestParameters</a>},
}

<a href="#cddl-type-capabilitiesrequestparameters"><code>CapabilitiesRequestParameters</code></a> = {
  ?<a href="#cddl-key-capabilitiesrequestparameters-alwaysmatch"><code>alwaysMatch</code></a>: <a data-link-type="cddl" href="#cddl-type-capabilitiesrequest">CapabilitiesRequest</a>,
}

<a href="#cddl-type-settingscommand"><code>SettingsCommand</code></a> = {
  <a data-link-type="cddl" href="#cddl-type-settingssetsettingscommand">SettingsSetSettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingsgetsettingscommand">SettingsGetSettingsCommand</a> //
  <a data-link-type="cddl" href="#cddl-type-settingsgetsupportedsettingscommand">SettingsGetSupportedSettingsCommand</a>
}

<a href="#cddl-type-settingssetsettingscommand"><code>SettingsSetSettingsCommand</code></a> = {
  <a href="#cddl-key-settingssetsettingscommand-method"><code>method</code></a>: <a href="#cddl-value-settingssetsettingscommand-method-settingssetsettings"><code>"settings.setSettings"</code></a>,
  <a href="#cddl-key-settingssetsettingscommand-params"><code>params</code></a>: <a data-link-type="cddl" href="#cddl-type-settingssetsettingsparameters">SettingsSetSettingsParameters</a>
}

<a href="#cddl-type-settingssetsettingsparameters"><code>SettingsSetSettingsParameters</code></a> = {
  <a href="#cddl-key-settingssetsettingsparameters-settings"><code>settings</code></a>: [1* <a data-link-type="cddl" href="#cddl-type-settingssetsettingsparametersitem">SettingsSetSettingsParametersItem</a> ],
}

<a href="#cddl-type-settingssetsettingsparametersitem"><code>SettingsSetSettingsParametersItem</code></a> = {
  <a href="#cddl-key-settingssetsettingsparametersitem-name"><code>name</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a href="#cddl-key-settingssetsettingsparametersitem-value"><code>value</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">any</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-settingsgetsettingscommand"><code>SettingsGetSettingsCommand</code></a> = {
  <a href="#cddl-key-settingsgetsettingscommand-method"><code>method</code></a>: <a href="#cddl-value-settingsgetsettingscommand-method-settingsgetsettings"><code>"settings.getSettings"</code></a>,
  <a href="#cddl-key-settingsgetsettingscommand-params"><code>params</code></a>: <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsparameters">SettingsGetSettingsParameters</a>
}

<a href="#cddl-type-settingsgetsettingsparameters"><code>SettingsGetSettingsParameters</code></a> = {
  <a href="#cddl-key-settingsgetsettingsparameters-settings"><code>settings</code></a>: [1* <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsparametersitem">SettingsGetSettingsParametersItem</a> ],
}

<a href="#cddl-type-settingsgetsettingsparametersitem"><code>SettingsGetSettingsParametersItem</code></a> = {
  <a href="#cddl-key-settingsgetsettingsparametersitem-name"><code>name</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-settingsgetsupportedsettingscommand"><code>SettingsGetSupportedSettingsCommand</code></a> = {
  <a href="#cddl-key-settingsgetsupportedsettingscommand-method"><code>method</code></a>: <a href="#cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings"><code>"settings.getSupportedSettings"</code></a>,
  <a href="#cddl-key-settingsgetsupportedsettingscommand-params"><code>params</code></a>: <a data-link-type="cddl" href="#cddl-type-emptyparams">EmptyParams</a>
}

<a href="#cddl-type-interactioncommand"><code>InteractionCommand</code></a> = (<a data-link-type="cddl" href="#cddl-type-interactionuserintentcommand">InteractionUserIntentCommand</a>)

<a href="#cddl-type-interactionuserintentcommand"><code>InteractionUserIntentCommand</code></a> = {
  <a href="#cddl-key-interactionuserintentcommand-method"><code>method</code></a>: <a href="#cddl-value-interactionuserintentcommand-method-interactionuserintent"><code>"interaction.userIntent"</code></a>,
  <a href="#cddl-key-interactionuserintentcommand-params"><code>params</code></a>: <a data-link-type="cddl" href="#cddl-type-interactionuserintentparameters">InteractionUserIntentParameters</a>
}

<a href="#cddl-type-interactionuserintentparameters"><code>InteractionUserIntentParameters</code></a> = (
  <a data-link-type="cddl" href="#cddl-type-presskeysintentparameters">PressKeysIntentParameters</a> /
  <a data-link-type="cddl" href="#cddl-type-extensionintentparameters">ExtensionIntentParameters</a>
)

<a href="#cddl-type-presskeysintentparameters"><code>PressKeysIntentParameters</code></a> = {
  <a href="#cddl-key-presskeysintentparameters-name"><code>"name"</code></a> => <a href="#cddl-value-presskeysintentparameters-name-presskeys"><code>"pressKeys"</code></a>,
  <a href="#cddl-key-presskeysintentparameters-keys"><code>"keys"</code></a> => <a data-link-type="cddl" href="#cddl-type-keycombination">KeyCombination</a>,
}

<a href="#cddl-type-keycombination"><code>KeyCombination</code></a> = [
  1* <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>
]

<a href="#cddl-type-extensionintentparameters"><code>ExtensionIntentParameters</code></a> = {
  <a href="#cddl-key-extensionintentparameters-name"><code>"name"</code></a> => <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

</pre>
  <h3 class="no-num no-ref heading settled" id="cddl-index-cddl-module-local-end-definition"><span class="content">Local end definition</span><a class="self-link" href="#cddl-index-cddl-module-local-end-definition"></a></h3>
<pre class="cddl highlight def"><a href="#cddl-type-message"><code>Message</code></a> = (
  <a data-link-type="cddl" href="#cddl-type-commandresponse">CommandResponse</a> //
  <a data-link-type="cddl" href="#cddl-type-errorresponse">ErrorResponse</a> //
  <a data-link-type="cddl" href="#cddl-type-event">Event</a>
)

<a href="#cddl-type-commandresponse"><code>CommandResponse</code></a> = {
  <a href="#cddl-key-commandresponse-id"><code>id</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">uint</a>,
  <a href="#cddl-key-commandresponse-result"><code>result</code></a>: <a data-link-type="cddl" href="#cddl-type-resultdata">ResultData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-errorresponse"><code>ErrorResponse</code></a> = {
  <a href="#cddl-key-errorresponse-id"><code>id</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">uint</a> / <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">null</a>,
  <a href="#cddl-key-errorresponse-error"><code>error</code></a>: <a href="#cddl-value-errorresponse-error-unknown-error"><code>"unknown error"</code></a> / <a href="#cddl-value-errorresponse-error-unknown-command"><code>"unknown command"</code></a> / <a href="#cddl-value-errorresponse-error-invalid-argument"><code>"invalid argument"</code></a> / <a href="#cddl-value-errorresponse-error-session-not-created"><code>"session not created"</code></a>,
  <a href="#cddl-key-errorresponse-message"><code>message</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  ?<a href="#cddl-key-errorresponse-stacktrace"><code>stacktrace</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-resultdata"><code>ResultData</code></a> = (
  <a data-link-type="cddl" href="#cddl-type-emptyresult">EmptyResult</a> /
  <a data-link-type="cddl" href="#cddl-type-sessionresult">SessionResult</a> /
  <a data-link-type="cddl" href="#cddl-type-settingsresult">SettingsResult</a>
)

<a href="#cddl-type-emptyresult"><code>EmptyResult</code></a> = {}

<a href="#cddl-type-event"><code>Event</code></a> = {
  <a data-link-type="cddl" href="#cddl-type-eventdata">EventData</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-eventdata"><code>EventData</code></a> = (
  <a data-link-type="cddl" href="#cddl-type-interactionevent">InteractionEvent</a>
)

<a href="#cddl-type-extensible"><code>Extensible</code></a> = {
  *<a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a> => <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">any</a>
}

<a href="#cddl-type-sessionresult"><code>SessionResult</code></a> = (<a data-link-type="cddl" href="#cddl-type-sessionnewresult">SessionNewResult</a>)

<a href="#cddl-type-capabilitiesrequest"><code>CapabilitiesRequest</code></a> = {
  ?<a href="#cddl-key-capabilitiesrequest-atname"><code>atName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  ?<a href="#cddl-key-capabilitiesrequest-atversion"><code>atVersion</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  ?<a href="#cddl-key-capabilitiesrequest-platformname"><code>platformName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-sessionnewresult"><code>SessionNewResult</code></a> = {
  <a href="#cddl-key-sessionnewresult-sessionid"><code>sessionId</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a href="#cddl-key-sessionnewresult-capabilities"><code>capabilities</code></a>: {
    <a href="#cddl-key-sessionnewresult-capabilities-atname"><code>atName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
    <a href="#cddl-key-sessionnewresult-capabilities-atversion"><code>atVersion</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
    <a href="#cddl-key-sessionnewresult-capabilities-platformname"><code>platformName</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
    <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
  }
}

<a href="#cddl-type-settingsresult"><code>SettingsResult</code></a> = {
  <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsresult">SettingsGetSettingsResult</a>
}

<a href="#cddl-type-settingsgetsettingsresult"><code>SettingsGetSettingsResult</code></a> = {
  <a href="#cddl-key-settingsgetsettingsresult-settings"><code>settings</code></a>: [1* <a data-link-type="cddl" href="#cddl-type-settingsgetsettingsresultitem">SettingsGetSettingsResultItem</a> ],
}

<a href="#cddl-type-settingsgetsettingsresultitem"><code>SettingsGetSettingsResultItem</code></a> = {
  <a href="#cddl-key-settingsgetsettingsresultitem-name"><code>name</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a href="#cddl-key-settingsgetsettingsresultitem-value"><code>value</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">any</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-interactionevent"><code>InteractionEvent</code></a> = (<a data-link-type="cddl" href="#cddl-type-interactioncapturedoutputevent">InteractionCapturedOutputEvent</a>)


<a href="#cddl-type-interactioncapturedoutputparameters"><code>InteractionCapturedOutputParameters</code></a> = {
  <a href="#cddl-key-interactioncapturedoutputparameters-data"><code>data</code></a>: <a data-link-type="cddl-type" href="https://www.rfc-editor.org/rfc/rfc8610#appendix-D">text</a>,
  <a data-link-type="cddl" href="#cddl-type-extensible">Extensible</a>,
}

<a href="#cddl-type-interactioncapturedoutputevent"><code>InteractionCapturedOutputEvent</code></a> = {
  <a href="#cddl-key-interactioncapturedoutputevent-method"><code>method</code></a>: <a href="#cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput"><code>"interaction.capturedOutput"</code></a>,
  <a href="#cddl-key-interactioncapturedoutputevent-params"><code>params</code></a>: <a data-link-type="cddl" href="#cddl-type-interactioncapturedoutputparameters">InteractionCapturedOutputParameters</a>
}

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Is the "OS focus" check a viable security restriction for "send keys"? <a href="https://github.com/w3c/at-driver/issues/77">[Issue #77]</a> <a class="issue-return" href="#issue-e10bf837" title="Jump to section">↵</a></div>
   <div class="issue"> Require implementations to maintain a static list of supported settings. <a class="issue-return" href="#issue-b4b3c071" title="Jump to section">↵</a></div>
   <div class="issue"> Require implementations to report failures in settings modification operations. <a class="issue-return" href="#issue-c41981a9" title="Jump to section">↵</a></div>
   <div class="issue"> Do we need a "setting changed" event? <a class="issue-return" href="#issue-0b79b3d5" title="Jump to section">↵</a></div>
   <div class="issue"> This algorithm does not yet have a means for indicating a screen-reader specific modifier key (or keys). <a href="https://github.com/w3c/at-driver/issues/34">[Issue #34]</a> <a class="issue-return" href="#issue-e5a6d243" title="Jump to section">↵</a></div>
   <div class="issue"> This algorithm only supports one specific kind of press/release sequence, and it is not clear if that is sufficient to express all keyboard commands in all implementations. <a href="https://github.com/w3c/at-driver/issues/51">[Issue #51]</a> <a class="issue-return" href="#issue-1bd3afd8" title="Jump to section">↵</a></div>
   <div class="issue"> TODO sandbox (limit availability to information that apps usually can’t access, e.g. login screen). <a class="issue-return" href="#issue-f9e956aa" title="Jump to section">↵</a></div>
   <div class="issue"> TODO no HID level simulated keypresses. <a class="issue-return" href="#issue-0225dc78" title="Jump to section">↵</a></div>
   <div class="issue"> TODO exclude access to any security-sensitive settings. <a class="issue-return" href="#issue-fbd6fc51" title="Jump to section">↵</a></div>
   <div class="issue"> TODO exclude access to any security-sensitive commands. <a class="issue-return" href="#issue-398c181d" title="Jump to section">↵</a></div>
   <div class="issue"> The JSON Schema files are not yet generated from the CDDL and so might be out of date. <a href="https://github.com/w3c/at-driver/issues/23">[Issue #23]</a> <a class="issue-return" href="#issue-f906273a" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"03afaf9c": {"dfnID":"03afaf9c","dfnText":"empty","external":true,"refSections":[{"refs":[{"id":"ref-for-list-empty"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#list-empty"},
"0698d556": {"dfnID":"0698d556","dfnText":"string","external":true,"refSections":[{"refs":[{"id":"ref-for-string"},{"id":"ref-for-string\u2460"},{"id":"ref-for-string\u2461"},{"id":"ref-for-string\u2462"},{"id":"ref-for-string\u2463"},{"id":"ref-for-string\u2464"}],"title":"5.2. Capabilities"}],"url":"https://infra.spec.whatwg.org/#string"},
"0e6b2056": {"dfnID":"0e6b2056","dfnText":"set (for map)","external":true,"refSections":[{"refs":[{"id":"ref-for-map-set"}],"title":"5.2. Capabilities"}],"url":"https://infra.spec.whatwg.org/#map-set"},
"1243a891": {"dfnID":"1243a891","dfnText":"exist","external":true,"refSections":[{"refs":[{"id":"ref-for-map-exists"},{"id":"ref-for-map-exists\u2460"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-map-exists\u2461"},{"id":"ref-for-map-exists\u2462"},{"id":"ref-for-map-exists\u2463"},{"id":"ref-for-map-exists\u2464"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#map-exists"},
"15e48c39": {"dfnID":"15e48c39","dfnText":"set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-ordered-set\u2460"},{"id":"ref-for-ordered-set\u2461"},{"id":"ref-for-ordered-set\u2462"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-ordered-set\u2463"}],"title":"7.2. The settings Module"}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"16d07e10": {"dfnID":"16d07e10","dfnText":"for each (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-iterate"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-list-iterate\u2460"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-list-iterate\u2461"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-list-iterate\u2462"},{"id":"ref-for-list-iterate\u2463"}],"title":"7.3. The Interaction Module"},{"refs":[{"id":"ref-for-list-iterate\u2464"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"https://infra.spec.whatwg.org/#list-iterate"},
"3fca5a9e": {"dfnID":"3fca5a9e","dfnText":"map","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-map"},{"id":"ref-for-ordered-map\u2460"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-ordered-map\u2461"},{"id":"ref-for-ordered-map\u2462"},{"id":"ref-for-ordered-map\u2463"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-ordered-map\u2464"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-ordered-map\u2465"},{"id":"ref-for-ordered-map\u2466"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-ordered-map\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-ordered-map\u2468"}],"title":"7.3. The Interaction Module"},{"refs":[{"id":"ref-for-ordered-map\u2460\u24ea"},{"id":"ref-for-ordered-map\u2460\u2460"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"https://infra.spec.whatwg.org/#ordered-map"},
"45209803": {"dfnID":"45209803","dfnText":"for each (for map)","external":true,"refSections":[{"refs":[{"id":"ref-for-map-iterate"}],"title":"5.2. Capabilities"}],"url":"https://infra.spec.whatwg.org/#map-iterate"},
"4c07280e": {"dfnID":"4c07280e","dfnText":"serialize an Infra value to JSON bytes","external":true,"refSections":[{"refs":[{"id":"ref-for-serialize-an-infra-value-to-json-bytes"},{"id":"ref-for-serialize-an-infra-value-to-json-bytes\u2460"},{"id":"ref-for-serialize-an-infra-value-to-json-bytes\u2461"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"523b9b71": {"dfnID":"523b9b71","dfnText":"null","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-D"},{"id":"ref-for-appendix-D\u2460"},{"id":"ref-for-appendix-D\u2461"},{"id":"ref-for-appendix-D\u2462"},{"id":"ref-for-appendix-D\u2463"},{"id":"ref-for-appendix-D\u2464"},{"id":"ref-for-appendix-D\u2465"},{"id":"ref-for-appendix-D\u2466"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-appendix-D\u2467"},{"id":"ref-for-appendix-D\u2468"},{"id":"ref-for-appendix-D\u2460\u24ea"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2460"},{"id":"ref-for-appendix-D\u2460\u2461"},{"id":"ref-for-appendix-D\u2460\u2462"},{"id":"ref-for-appendix-D\u2460\u2463"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2464"},{"id":"ref-for-appendix-D\u2460\u2465"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2466"},{"id":"ref-for-appendix-D\u2460\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2468"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2461\u24ea"}],"title":"7.3.2. Types"},{"refs":[{"id":"ref-for-appendix-D\u2461\u2460"},{"id":"ref-for-appendix-D\u2461\u2461"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"https://www.rfc-editor.org/rfc/rfc8610#appendix-D"},
"53275e46": {"dfnID":"53275e46","dfnText":"append (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-append"}],"title":"7.2. The settings Module"}],"url":"https://infra.spec.whatwg.org/#list-append"},
"649608b9": {"dfnID":"649608b9","dfnText":"list","external":true,"refSections":[{"refs":[{"id":"ref-for-list"},{"id":"ref-for-list\u2460"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-list\u2461"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-list\u2462"}],"title":"7.3. The Interaction Module"}],"url":"https://infra.spec.whatwg.org/#list"},
"653d0848": {"dfnID":"653d0848","dfnText":"size","external":true,"refSections":[{"refs":[{"id":"ref-for-map-size"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#map-size"},
"6a303638": {"dfnID":"6a303638","dfnText":"uint","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-D"},{"id":"ref-for-appendix-D\u2460"},{"id":"ref-for-appendix-D\u2461"},{"id":"ref-for-appendix-D\u2462"},{"id":"ref-for-appendix-D\u2463"},{"id":"ref-for-appendix-D\u2464"},{"id":"ref-for-appendix-D\u2465"},{"id":"ref-for-appendix-D\u2466"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-appendix-D\u2467"},{"id":"ref-for-appendix-D\u2468"},{"id":"ref-for-appendix-D\u2460\u24ea"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2460"},{"id":"ref-for-appendix-D\u2460\u2461"},{"id":"ref-for-appendix-D\u2460\u2462"},{"id":"ref-for-appendix-D\u2460\u2463"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2464"},{"id":"ref-for-appendix-D\u2460\u2465"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2466"},{"id":"ref-for-appendix-D\u2460\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2468"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2461\u24ea"}],"title":"7.3.2. Types"},{"refs":[{"id":"ref-for-appendix-D\u2461\u2460"},{"id":"ref-for-appendix-D\u2461\u2461"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"https://www.rfc-editor.org/rfc/rfc8610#appendix-D"},
"6f2dfa22": {"dfnID":"6f2dfa22","dfnText":"ASCII lowercase","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-lowercase"},{"id":"ref-for-ascii-lowercase\u2460"}],"title":"5.2. Capabilities"}],"url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"762869d3": {"dfnID":"762869d3","dfnText":"scalar value string","external":true,"refSections":[{"refs":[{"id":"ref-for-scalar-value-string"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#scalar-value-string"},
"77b4c09a": {"dfnID":"77b4c09a","dfnText":"assert","external":true,"refSections":[{"refs":[{"id":"ref-for-assert"},{"id":"ref-for-assert\u2460"},{"id":"ref-for-assert\u2461"},{"id":"ref-for-assert\u2462"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-assert\u2463"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"}],"url":"https://infra.spec.whatwg.org/#assert"},
"860300d4": {"dfnID":"860300d4","dfnText":"implementation-defined","external":true,"refSections":[{"refs":[{"id":"ref-for-implementation-defined"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-implementation-defined\u2460"},{"id":"ref-for-implementation-defined\u2461"},{"id":"ref-for-implementation-defined\u2462"}],"title":"5.8. Security checks"},{"refs":[{"id":"ref-for-implementation-defined\u2463"},{"id":"ref-for-implementation-defined\u2464"},{"id":"ref-for-implementation-defined\u2465"},{"id":"ref-for-implementation-defined\u2466"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-implementation-defined\u2467"},{"id":"ref-for-implementation-defined\u2468"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-implementation-defined\u2460\u24ea"},{"id":"ref-for-implementation-defined\u2460\u2460"}],"title":"7.3. The Interaction Module"}],"url":"https://infra.spec.whatwg.org/#implementation-defined"},
"8e8decb4": {"dfnID":"8e8decb4","dfnText":"parse JSON into Infra values","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-json-string-to-an-infra-value"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value"},
"a326add7": {"dfnID":"a326add7","dfnText":"contain (for map)","external":true,"refSections":[{"refs":[{"id":"ref-for-map-exists"},{"id":"ref-for-map-exists\u2460"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-map-exists\u2461"},{"id":"ref-for-map-exists\u2462"},{"id":"ref-for-map-exists\u2463"},{"id":"ref-for-map-exists\u2464"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#map-exists"},
"a3b18719": {"dfnID":"a3b18719","dfnText":"append (for set)","external":true,"refSections":[{"refs":[{"id":"ref-for-set-append"},{"id":"ref-for-set-append\u2460"}],"title":"6. Transport"}],"url":"https://infra.spec.whatwg.org/#set-append"},
"a72449dd": {"dfnID":"a72449dd","dfnText":"in parallel","external":true,"refSections":[{"refs":[{"id":"ref-for-in-parallel"}],"title":"6. Transport"}],"url":"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"},
"ae8def21": {"dfnID":"ae8def21","dfnText":"contain (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-contain"}],"title":"7.2. The settings Module"}],"url":"https://infra.spec.whatwg.org/#list-contain"},
"c3bd1df0": {"dfnID":"c3bd1df0","dfnText":"text","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-D"},{"id":"ref-for-appendix-D\u2460"},{"id":"ref-for-appendix-D\u2461"},{"id":"ref-for-appendix-D\u2462"},{"id":"ref-for-appendix-D\u2463"},{"id":"ref-for-appendix-D\u2464"},{"id":"ref-for-appendix-D\u2465"},{"id":"ref-for-appendix-D\u2466"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-appendix-D\u2467"},{"id":"ref-for-appendix-D\u2468"},{"id":"ref-for-appendix-D\u2460\u24ea"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2460"},{"id":"ref-for-appendix-D\u2460\u2461"},{"id":"ref-for-appendix-D\u2460\u2462"},{"id":"ref-for-appendix-D\u2460\u2463"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2464"},{"id":"ref-for-appendix-D\u2460\u2465"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2466"},{"id":"ref-for-appendix-D\u2460\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2468"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2461\u24ea"}],"title":"7.3.2. Types"},{"refs":[{"id":"ref-for-appendix-D\u2461\u2460"},{"id":"ref-for-appendix-D\u2461\u2461"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"https://www.rfc-editor.org/rfc/rfc8610#appendix-D"},
"capabilities": {"dfnID":"capabilities","dfnText":"Capabilities","external":false,"refSections":[],"url":"#capabilities"},
"cddl-key-capabilitiesrequest-atname": {"dfnID":"cddl-key-capabilitiesrequest-atname","dfnText":"atName","external":false,"refSections":[],"url":"#cddl-key-capabilitiesrequest-atname"},
"cddl-key-capabilitiesrequest-atversion": {"dfnID":"cddl-key-capabilitiesrequest-atversion","dfnText":"atVersion","external":false,"refSections":[],"url":"#cddl-key-capabilitiesrequest-atversion"},
"cddl-key-capabilitiesrequest-platformname": {"dfnID":"cddl-key-capabilitiesrequest-platformname","dfnText":"platformName","external":false,"refSections":[],"url":"#cddl-key-capabilitiesrequest-platformname"},
"cddl-key-capabilitiesrequestparameters-alwaysmatch": {"dfnID":"cddl-key-capabilitiesrequestparameters-alwaysmatch","dfnText":"alwaysMatch","external":false,"refSections":[],"url":"#cddl-key-capabilitiesrequestparameters-alwaysmatch"},
"cddl-key-command-id": {"dfnID":"cddl-key-command-id","dfnText":"id","external":false,"refSections":[],"url":"#cddl-key-command-id"},
"cddl-key-commandresponse-id": {"dfnID":"cddl-key-commandresponse-id","dfnText":"id","external":false,"refSections":[],"url":"#cddl-key-commandresponse-id"},
"cddl-key-commandresponse-result": {"dfnID":"cddl-key-commandresponse-result","dfnText":"result","external":false,"refSections":[],"url":"#cddl-key-commandresponse-result"},
"cddl-key-errorresponse-error": {"dfnID":"cddl-key-errorresponse-error","dfnText":"error","external":false,"refSections":[],"url":"#cddl-key-errorresponse-error"},
"cddl-key-errorresponse-id": {"dfnID":"cddl-key-errorresponse-id","dfnText":"id","external":false,"refSections":[],"url":"#cddl-key-errorresponse-id"},
"cddl-key-errorresponse-message": {"dfnID":"cddl-key-errorresponse-message","dfnText":"message","external":false,"refSections":[],"url":"#cddl-key-errorresponse-message"},
"cddl-key-errorresponse-stacktrace": {"dfnID":"cddl-key-errorresponse-stacktrace","dfnText":"stacktrace","external":false,"refSections":[],"url":"#cddl-key-errorresponse-stacktrace"},
"cddl-key-extensionintentparameters-name": {"dfnID":"cddl-key-extensionintentparameters-name","dfnText":"\"name\"","external":false,"refSections":[],"url":"#cddl-key-extensionintentparameters-name"},
"cddl-key-interactioncapturedoutputevent-method": {"dfnID":"cddl-key-interactioncapturedoutputevent-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-interactioncapturedoutputevent-method"},
"cddl-key-interactioncapturedoutputevent-params": {"dfnID":"cddl-key-interactioncapturedoutputevent-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-interactioncapturedoutputevent-params"},
"cddl-key-interactioncapturedoutputparameters-data": {"dfnID":"cddl-key-interactioncapturedoutputparameters-data","dfnText":"data","external":false,"refSections":[],"url":"#cddl-key-interactioncapturedoutputparameters-data"},
"cddl-key-interactionuserintentcommand-method": {"dfnID":"cddl-key-interactionuserintentcommand-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-interactionuserintentcommand-method"},
"cddl-key-interactionuserintentcommand-params": {"dfnID":"cddl-key-interactionuserintentcommand-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-interactionuserintentcommand-params"},
"cddl-key-presskeysintentparameters-keys": {"dfnID":"cddl-key-presskeysintentparameters-keys","dfnText":"\"keys\"","external":false,"refSections":[],"url":"#cddl-key-presskeysintentparameters-keys"},
"cddl-key-presskeysintentparameters-name": {"dfnID":"cddl-key-presskeysintentparameters-name","dfnText":"\"name\"","external":false,"refSections":[],"url":"#cddl-key-presskeysintentparameters-name"},
"cddl-key-sessionnewcommand-method": {"dfnID":"cddl-key-sessionnewcommand-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-sessionnewcommand-method"},
"cddl-key-sessionnewcommand-params": {"dfnID":"cddl-key-sessionnewcommand-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-sessionnewcommand-params"},
"cddl-key-sessionnewcommand-params-capabilities": {"dfnID":"cddl-key-sessionnewcommand-params-capabilities","dfnText":"capabilities","external":false,"refSections":[],"url":"#cddl-key-sessionnewcommand-params-capabilities"},
"cddl-key-sessionnewresult-capabilities": {"dfnID":"cddl-key-sessionnewresult-capabilities","dfnText":"capabilities","external":false,"refSections":[],"url":"#cddl-key-sessionnewresult-capabilities"},
"cddl-key-sessionnewresult-capabilities-atname": {"dfnID":"cddl-key-sessionnewresult-capabilities-atname","dfnText":"atName","external":false,"refSections":[],"url":"#cddl-key-sessionnewresult-capabilities-atname"},
"cddl-key-sessionnewresult-capabilities-atversion": {"dfnID":"cddl-key-sessionnewresult-capabilities-atversion","dfnText":"atVersion","external":false,"refSections":[],"url":"#cddl-key-sessionnewresult-capabilities-atversion"},
"cddl-key-sessionnewresult-capabilities-platformname": {"dfnID":"cddl-key-sessionnewresult-capabilities-platformname","dfnText":"platformName","external":false,"refSections":[],"url":"#cddl-key-sessionnewresult-capabilities-platformname"},
"cddl-key-sessionnewresult-sessionid": {"dfnID":"cddl-key-sessionnewresult-sessionid","dfnText":"sessionId","external":false,"refSections":[],"url":"#cddl-key-sessionnewresult-sessionid"},
"cddl-key-settingsgetsettingscommand-method": {"dfnID":"cddl-key-settingsgetsettingscommand-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingscommand-method"},
"cddl-key-settingsgetsettingscommand-params": {"dfnID":"cddl-key-settingsgetsettingscommand-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingscommand-params"},
"cddl-key-settingsgetsettingsparameters-settings": {"dfnID":"cddl-key-settingsgetsettingsparameters-settings","dfnText":"settings","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingsparameters-settings"},
"cddl-key-settingsgetsettingsparametersitem-name": {"dfnID":"cddl-key-settingsgetsettingsparametersitem-name","dfnText":"name","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingsparametersitem-name"},
"cddl-key-settingsgetsettingsresult-settings": {"dfnID":"cddl-key-settingsgetsettingsresult-settings","dfnText":"settings","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingsresult-settings"},
"cddl-key-settingsgetsettingsresultitem-name": {"dfnID":"cddl-key-settingsgetsettingsresultitem-name","dfnText":"name","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingsresultitem-name"},
"cddl-key-settingsgetsettingsresultitem-value": {"dfnID":"cddl-key-settingsgetsettingsresultitem-value","dfnText":"value","external":false,"refSections":[],"url":"#cddl-key-settingsgetsettingsresultitem-value"},
"cddl-key-settingsgetsupportedsettingscommand-method": {"dfnID":"cddl-key-settingsgetsupportedsettingscommand-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-settingsgetsupportedsettingscommand-method"},
"cddl-key-settingsgetsupportedsettingscommand-params": {"dfnID":"cddl-key-settingsgetsupportedsettingscommand-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-settingsgetsupportedsettingscommand-params"},
"cddl-key-settingssetsettingscommand-method": {"dfnID":"cddl-key-settingssetsettingscommand-method","dfnText":"method","external":false,"refSections":[],"url":"#cddl-key-settingssetsettingscommand-method"},
"cddl-key-settingssetsettingscommand-params": {"dfnID":"cddl-key-settingssetsettingscommand-params","dfnText":"params","external":false,"refSections":[],"url":"#cddl-key-settingssetsettingscommand-params"},
"cddl-key-settingssetsettingsparameters-settings": {"dfnID":"cddl-key-settingssetsettingsparameters-settings","dfnText":"settings","external":false,"refSections":[],"url":"#cddl-key-settingssetsettingsparameters-settings"},
"cddl-key-settingssetsettingsparametersitem-name": {"dfnID":"cddl-key-settingssetsettingsparametersitem-name","dfnText":"name","external":false,"refSections":[],"url":"#cddl-key-settingssetsettingsparametersitem-name"},
"cddl-key-settingssetsettingsparametersitem-value": {"dfnID":"cddl-key-settingssetsettingsparametersitem-value","dfnText":"value","external":false,"refSections":[],"url":"#cddl-key-settingssetsettingsparametersitem-value"},
"cddl-module-local-end-definition": {"dfnID":"cddl-module-local-end-definition","dfnText":"local end definition","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-module-local-end-definition"},{"id":"ref-for-cddl-module-local-end-definition\u2460"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2461"}],"title":"5.4. Modules"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2462"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2463"}],"title":"5.6. Events"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2464"},{"id":"ref-for-cddl-module-local-end-definition\u2465"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2466"}],"title":"7.1.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2467"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2468"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2460\u24ea"}],"title":"7.2.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2460\u2460"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2460\u2461"}],"title":"7.3.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-local-end-definition\u2460\u2462"}],"title":"Appendix A: Schemas"}],"url":"#cddl-module-local-end-definition"},
"cddl-module-remote-end-definition": {"dfnID":"cddl-module-remote-end-definition","dfnText":"remote end definition","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-module-remote-end-definition"},{"id":"ref-for-cddl-module-remote-end-definition\u2460"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2461"},{"id":"ref-for-cddl-module-remote-end-definition\u2462"}],"title":"5.4. Modules"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2463"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2464"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2465"}],"title":"7.1.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2466"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2467"}],"title":"7.2.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2468"}],"title":"7.3.1. Definition"},{"refs":[{"id":"ref-for-cddl-module-remote-end-definition\u2460\u24ea"}],"title":"Appendix A: Schemas"}],"url":"#cddl-module-remote-end-definition"},
"cddl-type-capabilitiesrequest": {"dfnID":"cddl-type-capabilitiesrequest","dfnText":"CapabilitiesRequest","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-capabilitiesrequest"}],"title":"7.1.3.1. The session.new Command"}],"url":"#cddl-type-capabilitiesrequest"},
"cddl-type-capabilitiesrequestparameters": {"dfnID":"cddl-type-capabilitiesrequestparameters","dfnText":"CapabilitiesRequestParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-capabilitiesrequestparameters"}],"title":"7.1.3.1. The session.new Command"}],"url":"#cddl-type-capabilitiesrequestparameters"},
"cddl-type-command": {"dfnID":"cddl-type-command","dfnText":"Command","external":false,"refSections":[],"url":"#cddl-type-command"},
"cddl-type-commanddata": {"dfnID":"cddl-type-commanddata","dfnText":"CommandData","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-commanddata"}],"title":"5.1. Definition"}],"url":"#cddl-type-commanddata"},
"cddl-type-commandresponse": {"dfnID":"cddl-type-commandresponse","dfnText":"CommandResponse","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-commandresponse"}],"title":"5.1. Definition"}],"url":"#cddl-type-commandresponse"},
"cddl-type-emptyparams": {"dfnID":"cddl-type-emptyparams","dfnText":"EmptyParams","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-emptyparams"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"}],"url":"#cddl-type-emptyparams"},
"cddl-type-emptyresult": {"dfnID":"cddl-type-emptyresult","dfnText":"EmptyResult","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-emptyresult"}],"title":"5.1. Definition"}],"url":"#cddl-type-emptyresult"},
"cddl-type-errorresponse": {"dfnID":"cddl-type-errorresponse","dfnText":"ErrorResponse","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-errorresponse"}],"title":"5.1. Definition"}],"url":"#cddl-type-errorresponse"},
"cddl-type-event": {"dfnID":"cddl-type-event","dfnText":"Event","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-event"}],"title":"5.1. Definition"}],"url":"#cddl-type-event"},
"cddl-type-eventdata": {"dfnID":"cddl-type-eventdata","dfnText":"EventData","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-eventdata"}],"title":"5.1. Definition"}],"url":"#cddl-type-eventdata"},
"cddl-type-extensible": {"dfnID":"cddl-type-extensible","dfnText":"Extensible","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-extensible"},{"id":"ref-for-cddl-type-extensible\u2460"},{"id":"ref-for-cddl-type-extensible\u2461"},{"id":"ref-for-cddl-type-extensible\u2462"},{"id":"ref-for-cddl-type-extensible\u2463"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2464"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2465"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2466"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2468"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2460\u24ea"}],"title":"7.3.2. Types"},{"refs":[{"id":"ref-for-cddl-type-extensible\u2460\u2460"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#cddl-type-extensible"},
"cddl-type-extensionintentparameters": {"dfnID":"cddl-type-extensionintentparameters","dfnText":"ExtensionIntentParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-extensionintentparameters"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#cddl-type-extensionintentparameters"},
"cddl-type-interactioncapturedoutputevent": {"dfnID":"cddl-type-interactioncapturedoutputevent","dfnText":"InteractionCapturedOutputEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactioncapturedoutputevent"}],"title":"7.3.1. Definition"}],"url":"#cddl-type-interactioncapturedoutputevent"},
"cddl-type-interactioncapturedoutputparameters": {"dfnID":"cddl-type-interactioncapturedoutputparameters","dfnText":"InteractionCapturedOutputParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactioncapturedoutputparameters"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"#cddl-type-interactioncapturedoutputparameters"},
"cddl-type-interactioncommand": {"dfnID":"cddl-type-interactioncommand","dfnText":"InteractionCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactioncommand"}],"title":"5.1. Definition"}],"url":"#cddl-type-interactioncommand"},
"cddl-type-interactionevent": {"dfnID":"cddl-type-interactionevent","dfnText":"InteractionEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactionevent"}],"title":"5.1. Definition"}],"url":"#cddl-type-interactionevent"},
"cddl-type-interactionuserintentcommand": {"dfnID":"cddl-type-interactionuserintentcommand","dfnText":"InteractionUserIntentCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactionuserintentcommand"}],"title":"7.3.1. Definition"}],"url":"#cddl-type-interactionuserintentcommand"},
"cddl-type-interactionuserintentparameters": {"dfnID":"cddl-type-interactionuserintentparameters","dfnText":"InteractionUserIntentParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-interactionuserintentparameters"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#cddl-type-interactionuserintentparameters"},
"cddl-type-keycombination": {"dfnID":"cddl-type-keycombination","dfnText":"KeyCombination","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-keycombination"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#cddl-type-keycombination"},
"cddl-type-message": {"dfnID":"cddl-type-message","dfnText":"Message","external":false,"refSections":[],"url":"#cddl-type-message"},
"cddl-type-presskeysintentparameters": {"dfnID":"cddl-type-presskeysintentparameters","dfnText":"PressKeysIntentParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-presskeysintentparameters"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#cddl-type-presskeysintentparameters"},
"cddl-type-resultdata": {"dfnID":"cddl-type-resultdata","dfnText":"ResultData","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-resultdata"}],"title":"5.1. Definition"}],"url":"#cddl-type-resultdata"},
"cddl-type-sessioncommand": {"dfnID":"cddl-type-sessioncommand","dfnText":"SessionCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-sessioncommand"}],"title":"5.1. Definition"}],"url":"#cddl-type-sessioncommand"},
"cddl-type-sessionnewcommand": {"dfnID":"cddl-type-sessionnewcommand","dfnText":"SessionNewCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-sessionnewcommand"}],"title":"7.1.1. Definition"}],"url":"#cddl-type-sessionnewcommand"},
"cddl-type-sessionnewresult": {"dfnID":"cddl-type-sessionnewresult","dfnText":"SessionNewResult","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-sessionnewresult"}],"title":"7.1.1. Definition"}],"url":"#cddl-type-sessionnewresult"},
"cddl-type-sessionresult": {"dfnID":"cddl-type-sessionresult","dfnText":"SessionResult","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-sessionresult"}],"title":"5.1. Definition"}],"url":"#cddl-type-sessionresult"},
"cddl-type-settingscommand": {"dfnID":"cddl-type-settingscommand","dfnText":"SettingsCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingscommand"}],"title":"5.1. Definition"}],"url":"#cddl-type-settingscommand"},
"cddl-type-settingsgetsettingscommand": {"dfnID":"cddl-type-settingsgetsettingscommand","dfnText":"SettingsGetSettingsCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsettingscommand"}],"title":"7.2.1. Definition"}],"url":"#cddl-type-settingsgetsettingscommand"},
"cddl-type-settingsgetsettingsparameters": {"dfnID":"cddl-type-settingsgetsettingsparameters","dfnText":"SettingsGetSettingsParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsettingsparameters"}],"title":"7.2.3.2. The settings.getSettings Command"}],"url":"#cddl-type-settingsgetsettingsparameters"},
"cddl-type-settingsgetsettingsparametersitem": {"dfnID":"cddl-type-settingsgetsettingsparametersitem","dfnText":"SettingsGetSettingsParametersItem","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsettingsparametersitem"}],"title":"7.2.3.2. The settings.getSettings Command"}],"url":"#cddl-type-settingsgetsettingsparametersitem"},
"cddl-type-settingsgetsettingsresult": {"dfnID":"cddl-type-settingsgetsettingsresult","dfnText":"SettingsGetSettingsResult","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsettingsresult"}],"title":"7.2.1. Definition"}],"url":"#cddl-type-settingsgetsettingsresult"},
"cddl-type-settingsgetsettingsresultitem": {"dfnID":"cddl-type-settingsgetsettingsresultitem","dfnText":"SettingsGetSettingsResultItem","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsettingsresultitem"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"}],"url":"#cddl-type-settingsgetsettingsresultitem"},
"cddl-type-settingsgetsupportedsettingscommand": {"dfnID":"cddl-type-settingsgetsupportedsettingscommand","dfnText":"SettingsGetSupportedSettingsCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsgetsupportedsettingscommand"}],"title":"7.2.1. Definition"}],"url":"#cddl-type-settingsgetsupportedsettingscommand"},
"cddl-type-settingsresult": {"dfnID":"cddl-type-settingsresult","dfnText":"SettingsResult","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingsresult"}],"title":"5.1. Definition"}],"url":"#cddl-type-settingsresult"},
"cddl-type-settingssetsettingscommand": {"dfnID":"cddl-type-settingssetsettingscommand","dfnText":"SettingsSetSettingsCommand","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingssetsettingscommand"}],"title":"7.2.1. Definition"}],"url":"#cddl-type-settingssetsettingscommand"},
"cddl-type-settingssetsettingsparameters": {"dfnID":"cddl-type-settingssetsettingsparameters","dfnText":"SettingsSetSettingsParameters","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingssetsettingsparameters"}],"title":"7.2.3.1. The settings.setSettings Command"}],"url":"#cddl-type-settingssetsettingsparameters"},
"cddl-type-settingssetsettingsparametersitem": {"dfnID":"cddl-type-settingssetsettingsparametersitem","dfnText":"SettingsSetSettingsParametersItem","external":false,"refSections":[{"refs":[{"id":"ref-for-cddl-type-settingssetsettingsparametersitem"}],"title":"7.2.3.1. The settings.setSettings Command"}],"url":"#cddl-type-settingssetsettingsparametersitem"},
"cddl-value-errorresponse-error-invalid-argument": {"dfnID":"cddl-value-errorresponse-error-invalid-argument","dfnText":"\"invalid argument\"","external":false,"refSections":[],"url":"#cddl-value-errorresponse-error-invalid-argument"},
"cddl-value-errorresponse-error-session-not-created": {"dfnID":"cddl-value-errorresponse-error-session-not-created","dfnText":"\"session not created\"","external":false,"refSections":[],"url":"#cddl-value-errorresponse-error-session-not-created"},
"cddl-value-errorresponse-error-unknown-command": {"dfnID":"cddl-value-errorresponse-error-unknown-command","dfnText":"\"unknown command\"","external":false,"refSections":[],"url":"#cddl-value-errorresponse-error-unknown-command"},
"cddl-value-errorresponse-error-unknown-error": {"dfnID":"cddl-value-errorresponse-error-unknown-error","dfnText":"\"unknown error\"","external":false,"refSections":[],"url":"#cddl-value-errorresponse-error-unknown-error"},
"cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput": {"dfnID":"cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput","dfnText":"\"interaction.capturedOutput\"","external":false,"refSections":[],"url":"#cddl-value-interactioncapturedoutputevent-method-interactioncapturedoutput"},
"cddl-value-interactionuserintentcommand-method-interactionuserintent": {"dfnID":"cddl-value-interactionuserintentcommand-method-interactionuserintent","dfnText":"\"interaction.userIntent\"","external":false,"refSections":[],"url":"#cddl-value-interactionuserintentcommand-method-interactionuserintent"},
"cddl-value-presskeysintentparameters-name-presskeys": {"dfnID":"cddl-value-presskeysintentparameters-name-presskeys","dfnText":"\"pressKeys\"","external":false,"refSections":[],"url":"#cddl-value-presskeysintentparameters-name-presskeys"},
"cddl-value-sessionnewcommand-method-sessionnew": {"dfnID":"cddl-value-sessionnewcommand-method-sessionnew","dfnText":"\"session.new\"","external":false,"refSections":[],"url":"#cddl-value-sessionnewcommand-method-sessionnew"},
"cddl-value-settingsgetsettingscommand-method-settingsgetsettings": {"dfnID":"cddl-value-settingsgetsettingscommand-method-settingsgetsettings","dfnText":"\"settings.getSettings\"","external":false,"refSections":[],"url":"#cddl-value-settingsgetsettingscommand-method-settingsgetsettings"},
"cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings": {"dfnID":"cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings","dfnText":"\"settings.getSupportedSettings\"","external":false,"refSections":[],"url":"#cddl-value-settingsgetsupportedsettingscommand-method-settingsgetsupportedsettings"},
"cddl-value-settingssetsettingscommand-method-settingssetsettings": {"dfnID":"cddl-value-settingssetsettingscommand-method-settingssetsettings","dfnText":"\"settings.setSettings\"","external":false,"refSections":[],"url":"#cddl-value-settingssetsettingscommand-method-settingssetsettings"},
"check-that-keyboard-interaction-can-be-simulated": {"dfnID":"check-that-keyboard-interaction-can-be-simulated","dfnText":"check that keyboard interaction can be simulated","external":false,"refSections":[{"refs":[{"id":"ref-for-check-that-keyboard-interaction-can-be-simulated"}],"title":"7.3. The Interaction Module"}],"url":"#check-that-keyboard-interaction-can-be-simulated"},
"check-that-one-of-the-expected-applications-has-focus": {"dfnID":"check-that-one-of-the-expected-applications-has-focus","dfnText":"check that one of the expected applications has focus","external":false,"refSections":[{"refs":[{"id":"ref-for-check-that-one-of-the-expected-applications-has-focus"}],"title":"7.3. The Interaction Module"}],"url":"#check-that-one-of-the-expected-applications-has-focus"},
"command": {"dfnID":"command","dfnText":"command","external":false,"refSections":[{"refs":[{"id":"ref-for-command"},{"id":"ref-for-command\u2460"},{"id":"ref-for-command\u2461"}],"title":"5.4. Modules"},{"refs":[{"id":"ref-for-command\u2462"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-command\u2463"},{"id":"ref-for-command\u2464"}],"title":"5.7. Errors"}],"url":"#command"},
"command-name": {"dfnID":"command-name","dfnText":"command name","external":false,"refSections":[{"refs":[{"id":"ref-for-command-name"}],"title":"5.4. Modules"},{"refs":[{"id":"ref-for-command-name\u2460"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-command-name\u2461"},{"id":"ref-for-command-name\u2462"}],"title":"6. Transport"}],"url":"#command-name"},
"command-parameters": {"dfnID":"command-parameters","dfnText":"command parameters","external":false,"refSections":[{"refs":[{"id":"ref-for-command-parameters"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-command-parameters\u2460"}],"title":"6. Transport"}],"url":"#command-parameters"},
"command-type": {"dfnID":"command-type","dfnText":"command type","external":false,"refSections":[{"refs":[{"id":"ref-for-command-type"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-command-type\u2460"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-command-type\u2461"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-command-type\u2462"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-command-type\u2463"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#command-type"},
"ef593226": {"dfnID":"ef593226","dfnText":"any","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-D"},{"id":"ref-for-appendix-D\u2460"},{"id":"ref-for-appendix-D\u2461"},{"id":"ref-for-appendix-D\u2462"},{"id":"ref-for-appendix-D\u2463"},{"id":"ref-for-appendix-D\u2464"},{"id":"ref-for-appendix-D\u2465"},{"id":"ref-for-appendix-D\u2466"}],"title":"5.1. Definition"},{"refs":[{"id":"ref-for-appendix-D\u2467"},{"id":"ref-for-appendix-D\u2468"},{"id":"ref-for-appendix-D\u2460\u24ea"}],"title":"7.1.2.1. The session.CapabilitiesRequest Type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2460"},{"id":"ref-for-appendix-D\u2460\u2461"},{"id":"ref-for-appendix-D\u2460\u2462"},{"id":"ref-for-appendix-D\u2460\u2463"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2464"},{"id":"ref-for-appendix-D\u2460\u2465"}],"title":"7.2.2.1. The SettingsGetSettingsResult type"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2466"},{"id":"ref-for-appendix-D\u2460\u2467"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2460\u2468"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-appendix-D\u2461\u24ea"}],"title":"7.3.2. Types"},{"refs":[{"id":"ref-for-appendix-D\u2461\u2460"},{"id":"ref-for-appendix-D\u2461\u2461"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"https://www.rfc-editor.org/rfc/rfc8610#appendix-D"},
"emit-an-event": {"dfnID":"emit-an-event","dfnText":"emit an event","external":false,"refSections":[{"refs":[{"id":"ref-for-emit-an-event"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"#emit-an-event"},
"error": {"dfnID":"error","dfnText":"error","external":false,"refSections":[{"refs":[{"id":"ref-for-error"},{"id":"ref-for-error\u2460"}],"title":"3. Infrastructure"},{"refs":[{"id":"ref-for-error\u2461"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-error\u2462"},{"id":"ref-for-error\u2463"}],"title":"5.8. Security checks"},{"refs":[{"id":"ref-for-error\u2464"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-error\u2465"},{"id":"ref-for-error\u2466"},{"id":"ref-for-error\u2467"},{"id":"ref-for-error\u2468"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-error\u2460\u24ea"},{"id":"ref-for-error\u2460\u2460"},{"id":"ref-for-error\u2460\u2461"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-error\u2460\u2462"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#error"},
"error-code": {"dfnID":"error-code","dfnText":"error code","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code"}],"title":"3. Infrastructure"},{"refs":[{"id":"ref-for-error-code\u2460"},{"id":"ref-for-error-code\u2461"}],"title":"5.8. Security checks"},{"refs":[{"id":"ref-for-error-code\u2462"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-error-code\u2463"},{"id":"ref-for-error-code\u2464"},{"id":"ref-for-error-code\u2465"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-error-code\u2466"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#error-code"},
"error-code-cannot-simulate-keyboard-interaction": {"dfnID":"error-code-cannot-simulate-keyboard-interaction","dfnText":"cannot simulate keyboard interaction","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-cannot-simulate-keyboard-interaction"}],"title":"5.8. Security checks"}],"url":"#error-code-cannot-simulate-keyboard-interaction"},
"error-code-invalid-argument": {"dfnID":"error-code-invalid-argument","dfnText":"invalid argument","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-invalid-argument"},{"id":"ref-for-error-code-invalid-argument\u2460"},{"id":"ref-for-error-code-invalid-argument\u2461"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-error-code-invalid-argument\u2462"},{"id":"ref-for-error-code-invalid-argument\u2463"},{"id":"ref-for-error-code-invalid-argument\u2464"}],"title":"7.2. The settings Module"}],"url":"#error-code-invalid-argument"},
"error-code-invalid-os-focus-state": {"dfnID":"error-code-invalid-os-focus-state","dfnText":"invalid OS focus state","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-invalid-os-focus-state"}],"title":"5.8. Security checks"}],"url":"#error-code-invalid-os-focus-state"},
"error-code-invalid-session-id": {"dfnID":"error-code-invalid-session-id","dfnText":"invalid session id","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-invalid-session-id"}],"title":"6. Transport"}],"url":"#error-code-invalid-session-id"},
"error-code-session-not-created": {"dfnID":"error-code-session-not-created","dfnText":"session not created","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-session-not-created"},{"id":"ref-for-error-code-session-not-created\u2460"},{"id":"ref-for-error-code-session-not-created\u2461"},{"id":"ref-for-error-code-session-not-created\u2462"}],"title":"7.1.3.1. The session.new Command"}],"url":"#error-code-session-not-created"},
"error-code-unknown-command": {"dfnID":"error-code-unknown-command","dfnText":"unknown command","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-unknown-command"}],"title":"6. Transport"}],"url":"#error-code-unknown-command"},
"error-code-unknown-user-intent": {"dfnID":"error-code-unknown-user-intent","dfnText":"unknown user intent","external":false,"refSections":[{"refs":[{"id":"ref-for-error-code-unknown-user-intent"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#error-code-unknown-user-intent"},
"event": {"dfnID":"event","dfnText":"event","external":false,"refSections":[{"refs":[{"id":"ref-for-event"},{"id":"ref-for-event\u2460"}],"title":"5.4. Modules"}],"url":"#event"},
"event-name": {"dfnID":"event-name","dfnText":"event name","external":false,"refSections":[{"refs":[{"id":"ref-for-event-name"}],"title":"5.4. Modules"}],"url":"#event-name"},
"event-parameters": {"dfnID":"event-parameters","dfnText":"event parameters","external":false,"refSections":[],"url":"#event-parameters"},
"event-type": {"dfnID":"event-type","dfnText":"event type","external":false,"refSections":[{"refs":[{"id":"ref-for-event-type"}],"title":"5.6. Events"}],"url":"#event-type"},
"extension-capabilities": {"dfnID":"extension-capabilities","dfnText":"extension capabilities","external":false,"refSections":[{"refs":[{"id":"ref-for-extension-capabilities"},{"id":"ref-for-extension-capabilities\u2460"}],"title":"5.2. Capabilities"}],"url":"#extension-capabilities"},
"extension-modules": {"dfnID":"extension-modules","dfnText":"extension modules","external":false,"refSections":[{"refs":[{"id":"ref-for-extension-modules"}],"title":"5.5. Commands"}],"url":"#extension-modules"},
"generating-a-uuid": {"dfnID":"generating-a-uuid","dfnText":"Generating a UUID","external":false,"refSections":[{"refs":[{"id":"ref-for-generating-a-uuid"}],"title":"7.1.3.1. The session.new Command"}],"url":"#generating-a-uuid"},
"get-settings": {"dfnID":"get-settings","dfnText":"get settings","external":false,"refSections":[{"refs":[{"id":"ref-for-get-settings"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-get-settings\u2460"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"}],"url":"#get-settings"},
"handle-a-connection-closing": {"dfnID":"handle-a-connection-closing","dfnText":"handle a connection closing","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-a-connection-closing"}],"title":"6. Transport"}],"url":"#handle-a-connection-closing"},
"handle-an-incoming-message": {"dfnID":"handle-an-incoming-message","dfnText":"handle an incoming message","external":false,"refSections":[{"refs":[{"id":"ref-for-handle-an-incoming-message"}],"title":"6. Transport"}],"url":"#handle-an-incoming-message"},
"interactionuserintent": {"dfnID":"interactionuserintent","dfnText":"interaction.userIntent","external":false,"refSections":[],"url":"#interactionuserintent"},
"local-end": {"dfnID":"local-end","dfnText":"local end","external":false,"refSections":[{"refs":[{"id":"ref-for-local-end"},{"id":"ref-for-local-end\u2460"}],"title":"5. Protocol"},{"refs":[{"id":"ref-for-local-end\u2461"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-local-end\u2462"}],"title":"5.3. Session"},{"refs":[{"id":"ref-for-local-end\u2463"},{"id":"ref-for-local-end\u2464"},{"id":"ref-for-local-end\u2465"},{"id":"ref-for-local-end\u2466"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-local-end\u2467"}],"title":"5.6. Events"},{"refs":[{"id":"ref-for-local-end\u2468"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-local-end\u2460\u24ea"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-local-end\u2460\u2460"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-local-end\u2460\u2461"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-local-end\u2460\u2462"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#local-end"},
"match-capabilities": {"dfnID":"match-capabilities","dfnText":"match capabilities","external":false,"refSections":[{"refs":[{"id":"ref-for-match-capabilities"}],"title":"5.2. Capabilities"}],"url":"#match-capabilities"},
"modify-setting": {"dfnID":"modify-setting","dfnText":"modify setting","external":false,"refSections":[{"refs":[{"id":"ref-for-modify-setting"}],"title":"7.2.3.1. The settings.setSettings Command"}],"url":"#modify-setting"},
"module": {"dfnID":"module","dfnText":"module","external":false,"refSections":[{"refs":[{"id":"ref-for-module"}],"title":"2. Explainer"},{"refs":[{"id":"ref-for-module\u2460"},{"id":"ref-for-module\u2461"}],"title":"7.2. The settings Module"}],"url":"#module"},
"module-name": {"dfnID":"module-name","dfnText":"module name","external":false,"refSections":[{"refs":[{"id":"ref-for-module-name"}],"title":"5.4. Modules"}],"url":"#module-name"},
"press-keys": {"dfnID":"press-keys","dfnText":"press keys","external":false,"refSections":[{"refs":[{"id":"ref-for-press-keys"}],"title":"7.3. The Interaction Module"}],"url":"#press-keys"},
"process-capabilities": {"dfnID":"process-capabilities","dfnText":"process capabilities","external":false,"refSections":[{"refs":[{"id":"ref-for-process-capabilities"}],"title":"7.1.3.1. The session.new Command"}],"url":"#process-capabilities"},
"remote-end": {"dfnID":"remote-end","dfnText":"remote end","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end"},{"id":"ref-for-remote-end\u2460"}],"title":"5. Protocol"},{"refs":[{"id":"ref-for-remote-end\u2461"},{"id":"ref-for-remote-end\u2462"},{"id":"ref-for-remote-end\u2463"},{"id":"ref-for-remote-end\u2464"},{"id":"ref-for-remote-end\u2465"},{"id":"ref-for-remote-end\u2466"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-remote-end\u2467"},{"id":"ref-for-remote-end\u2468"}],"title":"5.3. Session"},{"refs":[{"id":"ref-for-remote-end\u2460\u24ea"},{"id":"ref-for-remote-end\u2460\u2460"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-remote-end\u2460\u2461"},{"id":"ref-for-remote-end\u2460\u2462"}],"title":"5.6. Events"},{"refs":[{"id":"ref-for-remote-end\u2460\u2463"},{"id":"ref-for-remote-end\u2460\u2464"}],"title":"5.7. Errors"},{"refs":[{"id":"ref-for-remote-end\u2460\u2465"}],"title":"5.8. Security checks"},{"refs":[{"id":"ref-for-remote-end\u2460\u2466"},{"id":"ref-for-remote-end\u2460\u2467"},{"id":"ref-for-remote-end\u2460\u2468"},{"id":"ref-for-remote-end\u2461\u24ea"},{"id":"ref-for-remote-end\u2461\u2460"},{"id":"ref-for-remote-end\u2461\u2461"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-remote-end\u2461\u2462"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-remote-end\u2461\u2463"},{"id":"ref-for-remote-end\u2461\u2464"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-remote-end\u2461\u2465"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-remote-end\u2461\u2466"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-remote-end\u2461\u2467"},{"id":"ref-for-remote-end\u2461\u2468"},{"id":"ref-for-remote-end\u2462\u24ea"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-remote-end\u2462\u2460"}],"title":"7.3. The Interaction Module"},{"refs":[{"id":"ref-for-remote-end\u2462\u2461"}],"title":"7.3.3.1. The interaction.userIntent Command"},{"refs":[{"id":"ref-for-remote-end\u2462\u2462"}],"title":"8. Privacy"}],"url":"#remote-end"},
"remote-end-active-listeners": {"dfnID":"remote-end-active-listeners","dfnText":"active listeners","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-active-listeners"},{"id":"ref-for-remote-end-active-listeners\u2460"}],"title":"6. Transport"}],"url":"#remote-end-active-listeners"},
"remote-end-active-sessions": {"dfnID":"remote-end-active-sessions","dfnText":"active sessions","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-active-sessions"}],"title":"5.3. Session"},{"refs":[{"id":"ref-for-remote-end-active-sessions\u2460"},{"id":"ref-for-remote-end-active-sessions\u2461"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-remote-end-active-sessions\u2462"},{"id":"ref-for-remote-end-active-sessions\u2463"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-remote-end-active-sessions\u2464"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"#remote-end-active-sessions"},
"remote-end-event-trigger": {"dfnID":"remote-end-event-trigger","dfnText":"remote end event trigger","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-event-trigger"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"#remote-end-event-trigger"},
"remote-end-steps": {"dfnID":"remote-end-steps","dfnText":"remote end steps","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-steps"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-remote-end-steps\u2460"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-remote-end-steps\u2461"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-remote-end-steps\u2462"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-remote-end-steps\u2463"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-remote-end-steps\u2464"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#remote-end-steps"},
"remote-end-supported-settings": {"dfnID":"remote-end-supported-settings","dfnText":"supported settings","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-supported-settings"},{"id":"ref-for-remote-end-supported-settings\u2460"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-remote-end-supported-settings\u2461"},{"id":"ref-for-remote-end-supported-settings\u2462"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"}],"url":"#remote-end-supported-settings"},
"remote-end-table-of-extension-user-intents": {"dfnID":"remote-end-table-of-extension-user-intents","dfnText":"table of extension user intents","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-table-of-extension-user-intents"},{"id":"ref-for-remote-end-table-of-extension-user-intents\u2460"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#remote-end-table-of-extension-user-intents"},
"remote-end-websocket-connections-not-associated-with-a-session": {"dfnID":"remote-end-websocket-connections-not-associated-with-a-session","dfnText":"WebSocket connections not associated with a session","external":false,"refSections":[{"refs":[{"id":"ref-for-remote-end-websocket-connections-not-associated-with-a-session"},{"id":"ref-for-remote-end-websocket-connections-not-associated-with-a-session\u2460"},{"id":"ref-for-remote-end-websocket-connections-not-associated-with-a-session\u2461"},{"id":"ref-for-remote-end-websocket-connections-not-associated-with-a-session\u2462"}],"title":"6. Transport"}],"url":"#remote-end-websocket-connections-not-associated-with-a-session"},
"result-type": {"dfnID":"result-type","dfnText":"result type","external":false,"refSections":[{"refs":[{"id":"ref-for-result-type"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-result-type\u2460"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-result-type\u2461"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-result-type\u2462"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-result-type\u2463"}],"title":"7.2.3.2. The settings.getSettings Command"},{"refs":[{"id":"ref-for-result-type\u2464"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"}],"url":"#result-type"},
"send-an-error-response": {"dfnID":"send-an-error-response","dfnText":"send an error response","external":false,"refSections":[{"refs":[{"id":"ref-for-send-an-error-response"},{"id":"ref-for-send-an-error-response\u2460"},{"id":"ref-for-send-an-error-response\u2461"},{"id":"ref-for-send-an-error-response\u2462"},{"id":"ref-for-send-an-error-response\u2463"}],"title":"6. Transport"}],"url":"#send-an-error-response"},
"session": {"dfnID":"session","dfnText":"session","external":false,"refSections":[{"refs":[{"id":"ref-for-session"},{"id":"ref-for-session\u2460"}],"title":"2. Explainer"},{"refs":[{"id":"ref-for-session\u2461"},{"id":"ref-for-session\u2462"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-session\u2463"},{"id":"ref-for-session\u2464"}],"title":"5.3. Session"},{"refs":[{"id":"ref-for-session\u2465"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-session\u2466"},{"id":"ref-for-session\u2467"}],"title":"5.7. Errors"},{"refs":[{"id":"ref-for-session\u2468"},{"id":"ref-for-session\u2460\u24ea"},{"id":"ref-for-session\u2460\u2460"},{"id":"ref-for-session\u2460\u2461"},{"id":"ref-for-session\u2460\u2462"},{"id":"ref-for-session\u2460\u2463"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-session\u2460\u2464"},{"id":"ref-for-session\u2460\u2465"},{"id":"ref-for-session\u2460\u2466"}],"title":"7.1.3.1. The session.new Command"}],"url":"#session"},
"session-associated-with-connection": {"dfnID":"session-associated-with-connection","dfnText":"associated with connection","external":false,"refSections":[{"refs":[{"id":"ref-for-session-associated-with-connection"},{"id":"ref-for-session-associated-with-connection\u2460"},{"id":"ref-for-session-associated-with-connection\u2461"}],"title":"6. Transport"}],"url":"#session-associated-with-connection"},
"session-session-id": {"dfnID":"session-session-id","dfnText":"session ID","external":false,"refSections":[{"refs":[{"id":"ref-for-session-session-id"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-session-session-id\u2460"},{"id":"ref-for-session-session-id\u2461"}],"title":"7.1.3.1. The session.new Command"}],"url":"#session-session-id"},
"session-session-websocket-connections": {"dfnID":"session-session-websocket-connections","dfnText":"session WebSocket connections","external":false,"refSections":[{"refs":[{"id":"ref-for-session-session-websocket-connections"},{"id":"ref-for-session-session-websocket-connections\u2460"},{"id":"ref-for-session-session-websocket-connections\u2461"},{"id":"ref-for-session-session-websocket-connections\u2462"},{"id":"ref-for-session-session-websocket-connections\u2463"}],"title":"6. Transport"}],"url":"#session-session-websocket-connections"},
"sessionnew": {"dfnID":"sessionnew","dfnText":"session.new","external":false,"refSections":[],"url":"#sessionnew"},
"set-of-all-command-names": {"dfnID":"set-of-all-command-names","dfnText":"set of all command names","external":false,"refSections":[{"refs":[{"id":"ref-for-set-of-all-command-names"}],"title":"6. Transport"}],"url":"#set-of-all-command-names"},
"settingsgetsettings-command": {"dfnID":"settingsgetsettings-command","dfnText":"settings.getSettings command","external":false,"refSections":[],"url":"#settingsgetsettings-command"},
"settingsgetsupportedsettings-command": {"dfnID":"settingsgetsupportedsettings-command","dfnText":"settings.getSupportedSettings command","external":false,"refSections":[],"url":"#settingsgetsupportedsettings-command"},
"settingssetsettings": {"dfnID":"settingssetsettings","dfnText":"settings.setSettings","external":false,"refSections":[{"refs":[{"id":"ref-for-settingssetsettings"}],"title":"7.2.3.1. The settings.setSettings Command"}],"url":"#settingssetsettings"},
"should-be-withheld": {"dfnID":"should-be-withheld","dfnText":"should be withheld","external":false,"refSections":[{"refs":[{"id":"ref-for-should-be-withheld"}],"title":"7.3.4.1. The interaction.capturedOutput Event"}],"url":"#should-be-withheld"},
"standard-capabilities": {"dfnID":"standard-capabilities","dfnText":"standard capabilities","external":false,"refSections":[],"url":"#standard-capabilities"},
"standard-capabilities-at-name": {"dfnID":"standard-capabilities-at-name","dfnText":"AT name","external":false,"refSections":[],"url":"#standard-capabilities-at-name"},
"standard-capabilities-at-version": {"dfnID":"standard-capabilities-at-version","dfnText":"AT version","external":false,"refSections":[],"url":"#standard-capabilities-at-version"},
"standard-capabilities-platform": {"dfnID":"standard-capabilities-platform","dfnText":"Platform","external":false,"refSections":[],"url":"#standard-capabilities-platform"},
"start-listening-for-a-websocket-connection": {"dfnID":"start-listening-for-a-websocket-connection","dfnText":"start listening for a WebSocket connection","external":false,"refSections":[{"refs":[{"id":"ref-for-start-listening-for-a-websocket-connection"}],"title":"6.1. Establishing a Connection"}],"url":"#start-listening-for-a-websocket-connection"},
"static-command": {"dfnID":"static-command","dfnText":"static command","external":false,"refSections":[{"refs":[{"id":"ref-for-static-command"}],"title":"6. Transport"},{"refs":[{"id":"ref-for-static-command\u2460"}],"title":"7.1.3.1. The session.new Command"}],"url":"#static-command"},
"success": {"dfnID":"success","dfnText":"success","external":false,"refSections":[{"refs":[{"id":"ref-for-success"}],"title":"3. Infrastructure"},{"refs":[{"id":"ref-for-success\u2460"},{"id":"ref-for-success\u2461"},{"id":"ref-for-success\u2462"},{"id":"ref-for-success\u2463"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-success\u2464"}],"title":"5.5. Commands"},{"refs":[{"id":"ref-for-success\u2465"},{"id":"ref-for-success\u2466"}],"title":"5.8. Security checks"},{"refs":[{"id":"ref-for-success\u2467"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-success\u2468"},{"id":"ref-for-success\u2460\u24ea"}],"title":"7.2. The settings Module"},{"refs":[{"id":"ref-for-success\u2460\u2460"},{"id":"ref-for-success\u2460\u2461"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-success\u2460\u2462"}],"title":"7.2.3.3. The settings.getSupportedSettings Command"},{"refs":[{"id":"ref-for-success\u2460\u2463"}],"title":"7.3. The Interaction Module"}],"url":"#success"},
"table-of-standard-user-intents": {"dfnID":"table-of-standard-user-intents","dfnText":"table of standard user intents","external":false,"refSections":[{"refs":[{"id":"ref-for-table-of-standard-user-intents"},{"id":"ref-for-table-of-standard-user-intents\u2460"}],"title":"7.3.3.1. The interaction.userIntent Command"}],"url":"#table-of-standard-user-intents"},
"try": {"dfnID":"try","dfnText":"trying","external":false,"refSections":[{"refs":[{"id":"ref-for-try"}],"title":"5.2. Capabilities"},{"refs":[{"id":"ref-for-try\u2460"}],"title":"7.1.3.1. The session.new Command"},{"refs":[{"id":"ref-for-try\u2461"}],"title":"7.2.3.1. The settings.setSettings Command"},{"refs":[{"id":"ref-for-try\u2462"},{"id":"ref-for-try\u2463"}],"title":"7.3. The Interaction Module"}],"url":"#try"},
"uuid": {"dfnID":"uuid","dfnText":"Universally Unique Identifier (UUID)","external":false,"refSections":[{"refs":[{"id":"ref-for-uuid"}],"title":"5.3. Session"}],"url":"#uuid"},
"validate-setting-name": {"dfnID":"validate-setting-name","dfnText":"validate setting name","external":false,"refSections":[{"refs":[{"id":"ref-for-validate-setting-name"},{"id":"ref-for-validate-setting-name\u2460"}],"title":"7.2. The settings Module"}],"url":"#validate-setting-name"},
"websocket-connection": {"dfnID":"websocket-connection","dfnText":"WebSocket connection","external":false,"refSections":[{"refs":[{"id":"ref-for-websocket-connection"},{"id":"ref-for-websocket-connection\u2460"},{"id":"ref-for-websocket-connection\u2461"},{"id":"ref-for-websocket-connection\u2462"},{"id":"ref-for-websocket-connection\u2463"},{"id":"ref-for-websocket-connection\u2464"},{"id":"ref-for-websocket-connection\u2465"}],"title":"6. Transport"}],"url":"#websocket-connection"},
"websocket-listener": {"dfnID":"websocket-listener","dfnText":"WebSocket listener","external":false,"refSections":[{"refs":[{"id":"ref-for-websocket-listener"},{"id":"ref-for-websocket-listener\u2460"},{"id":"ref-for-websocket-listener\u2461"},{"id":"ref-for-websocket-listener\u2462"}],"title":"6. Transport"}],"url":"#websocket-listener"},
"websocket-listener-host": {"dfnID":"websocket-listener-host","dfnText":"host","external":false,"refSections":[{"refs":[{"id":"ref-for-websocket-listener-host"}],"title":"6. Transport"}],"url":"#websocket-listener-host"},
"websocket-listener-port": {"dfnID":"websocket-listener-port","dfnText":"port","external":false,"refSections":[{"refs":[{"id":"ref-for-websocket-listener-port"}],"title":"6. Transport"}],"url":"#websocket-listener-port"},
"websocket-listener-secure-flag": {"dfnID":"websocket-listener-secure-flag","dfnText":"secure flag","external":false,"refSections":[{"refs":[{"id":"ref-for-websocket-listener-secure-flag"},{"id":"ref-for-websocket-listener-secure-flag\u2460"}],"title":"6. Transport"}],"url":"#websocket-listener-secure-flag"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#cddl-module-local-end-definition": {"displayText":"Local end definition","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"Local end definition","type":"cddl-module","url":"#cddl-module-local-end-definition"},
"#cddl-module-remote-end-definition": {"displayText":"Remote end definition","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"Remote end definition","type":"cddl-module","url":"#cddl-module-remote-end-definition"},
"#cddl-type-capabilitiesrequest": {"displayText":"CapabilitiesRequest","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"CapabilitiesRequest","type":"cddl-type","url":"#cddl-type-capabilitiesrequest"},
"#cddl-type-capabilitiesrequestparameters": {"displayText":"CapabilitiesRequestParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"CapabilitiesRequestParameters","type":"cddl-type","url":"#cddl-type-capabilitiesrequestparameters"},
"#cddl-type-commanddata": {"displayText":"CommandData","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"CommandData","type":"cddl-type","url":"#cddl-type-commanddata"},
"#cddl-type-commandresponse": {"displayText":"CommandResponse","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"CommandResponse","type":"cddl-type","url":"#cddl-type-commandresponse"},
"#cddl-type-emptyparams": {"displayText":"EmptyParams","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"EmptyParams","type":"cddl-type","url":"#cddl-type-emptyparams"},
"#cddl-type-emptyresult": {"displayText":"EmptyResult","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"EmptyResult","type":"cddl-type","url":"#cddl-type-emptyresult"},
"#cddl-type-errorresponse": {"displayText":"ErrorResponse","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"ErrorResponse","type":"cddl-type","url":"#cddl-type-errorresponse"},
"#cddl-type-event": {"displayText":"Event","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"Event","type":"cddl-type","url":"#cddl-type-event"},
"#cddl-type-eventdata": {"displayText":"EventData","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"EventData","type":"cddl-type","url":"#cddl-type-eventdata"},
"#cddl-type-extensible": {"displayText":"Extensible","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"Extensible","type":"cddl-type","url":"#cddl-type-extensible"},
"#cddl-type-extensionintentparameters": {"displayText":"ExtensionIntentParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"ExtensionIntentParameters","type":"cddl-type","url":"#cddl-type-extensionintentparameters"},
"#cddl-type-interactioncapturedoutputevent": {"displayText":"InteractionCapturedOutputEvent","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionCapturedOutputEvent","type":"cddl-type","url":"#cddl-type-interactioncapturedoutputevent"},
"#cddl-type-interactioncapturedoutputparameters": {"displayText":"InteractionCapturedOutputParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionCapturedOutputParameters","type":"cddl-type","url":"#cddl-type-interactioncapturedoutputparameters"},
"#cddl-type-interactioncommand": {"displayText":"InteractionCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionCommand","type":"cddl-type","url":"#cddl-type-interactioncommand"},
"#cddl-type-interactionevent": {"displayText":"InteractionEvent","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionEvent","type":"cddl-type","url":"#cddl-type-interactionevent"},
"#cddl-type-interactionuserintentcommand": {"displayText":"InteractionUserIntentCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionUserIntentCommand","type":"cddl-type","url":"#cddl-type-interactionuserintentcommand"},
"#cddl-type-interactionuserintentparameters": {"displayText":"InteractionUserIntentParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"InteractionUserIntentParameters","type":"cddl-type","url":"#cddl-type-interactionuserintentparameters"},
"#cddl-type-keycombination": {"displayText":"KeyCombination","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"KeyCombination","type":"cddl-type","url":"#cddl-type-keycombination"},
"#cddl-type-presskeysintentparameters": {"displayText":"PressKeysIntentParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"PressKeysIntentParameters","type":"cddl-type","url":"#cddl-type-presskeysintentparameters"},
"#cddl-type-resultdata": {"displayText":"ResultData","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"ResultData","type":"cddl-type","url":"#cddl-type-resultdata"},
"#cddl-type-sessioncommand": {"displayText":"SessionCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SessionCommand","type":"cddl-type","url":"#cddl-type-sessioncommand"},
"#cddl-type-sessionnewcommand": {"displayText":"SessionNewCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SessionNewCommand","type":"cddl-type","url":"#cddl-type-sessionnewcommand"},
"#cddl-type-sessionnewresult": {"displayText":"SessionNewResult","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SessionNewResult","type":"cddl-type","url":"#cddl-type-sessionnewresult"},
"#cddl-type-sessionresult": {"displayText":"SessionResult","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SessionResult","type":"cddl-type","url":"#cddl-type-sessionresult"},
"#cddl-type-settingscommand": {"displayText":"SettingsCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsCommand","type":"cddl-type","url":"#cddl-type-settingscommand"},
"#cddl-type-settingsgetsettingscommand": {"displayText":"SettingsGetSettingsCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSettingsCommand","type":"cddl-type","url":"#cddl-type-settingsgetsettingscommand"},
"#cddl-type-settingsgetsettingsparameters": {"displayText":"SettingsGetSettingsParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSettingsParameters","type":"cddl-type","url":"#cddl-type-settingsgetsettingsparameters"},
"#cddl-type-settingsgetsettingsparametersitem": {"displayText":"SettingsGetSettingsParametersItem","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSettingsParametersItem","type":"cddl-type","url":"#cddl-type-settingsgetsettingsparametersitem"},
"#cddl-type-settingsgetsettingsresult": {"displayText":"SettingsGetSettingsResult","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSettingsResult","type":"cddl-type","url":"#cddl-type-settingsgetsettingsresult"},
"#cddl-type-settingsgetsettingsresultitem": {"displayText":"SettingsGetSettingsResultItem","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSettingsResultItem","type":"cddl-type","url":"#cddl-type-settingsgetsettingsresultitem"},
"#cddl-type-settingsgetsupportedsettingscommand": {"displayText":"SettingsGetSupportedSettingsCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsGetSupportedSettingsCommand","type":"cddl-type","url":"#cddl-type-settingsgetsupportedsettingscommand"},
"#cddl-type-settingsresult": {"displayText":"SettingsResult","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsResult","type":"cddl-type","url":"#cddl-type-settingsresult"},
"#cddl-type-settingssetsettingscommand": {"displayText":"SettingsSetSettingsCommand","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsSetSettingsCommand","type":"cddl-type","url":"#cddl-type-settingssetsettingscommand"},
"#cddl-type-settingssetsettingsparameters": {"displayText":"SettingsSetSettingsParameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsSetSettingsParameters","type":"cddl-type","url":"#cddl-type-settingssetsettingsparameters"},
"#cddl-type-settingssetsettingsparametersitem": {"displayText":"SettingsSetSettingsParametersItem","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"SettingsSetSettingsParametersItem","type":"cddl-type","url":"#cddl-type-settingssetsettingsparametersitem"},
"#check-that-keyboard-interaction-can-be-simulated": {"displayText":"check that keyboard interaction can be simulated","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"check that keyboard interaction can be simulated","type":"dfn","url":"#check-that-keyboard-interaction-can-be-simulated"},
"#check-that-one-of-the-expected-applications-has-focus": {"displayText":"check that one of the expected applications has focus","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"check that one of the expected applications has focus","type":"dfn","url":"#check-that-one-of-the-expected-applications-has-focus"},
"#command": {"displayText":"command","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"command","type":"dfn","url":"#command"},
"#command-name": {"displayText":"command name","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"command name","type":"dfn","url":"#command-name"},
"#command-parameters": {"displayText":"command parameters","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"command parameters","type":"dfn","url":"#command-parameters"},
"#command-type": {"displayText":"command type","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"command type","type":"dfn","url":"#command-type"},
"#emit-an-event": {"displayText":"emit an event","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"emit an event","type":"dfn","url":"#emit-an-event"},
"#error": {"displayText":"error","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"error","type":"dfn","url":"#error"},
"#error-code": {"displayText":"error code","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"error code","type":"dfn","url":"#error-code"},
"#error-code-cannot-simulate-keyboard-interaction": {"displayText":"cannot simulate keyboard interaction","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"cannot simulate keyboard interaction","type":"dfn","url":"#error-code-cannot-simulate-keyboard-interaction"},
"#error-code-invalid-argument": {"displayText":"invalid argument","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"invalid argument","type":"dfn","url":"#error-code-invalid-argument"},
"#error-code-invalid-os-focus-state": {"displayText":"invalid os focus state","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"invalid os focus state","type":"dfn","url":"#error-code-invalid-os-focus-state"},
"#error-code-invalid-session-id": {"displayText":"invalid session id","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"invalid session id","type":"dfn","url":"#error-code-invalid-session-id"},
"#error-code-session-not-created": {"displayText":"session not created","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"session not created","type":"dfn","url":"#error-code-session-not-created"},
"#error-code-unknown-command": {"displayText":"unknown command","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"unknown command","type":"dfn","url":"#error-code-unknown-command"},
"#error-code-unknown-user-intent": {"displayText":"unknown user intent","export":true,"for_":["error code"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"unknown user intent","type":"dfn","url":"#error-code-unknown-user-intent"},
"#event": {"displayText":"event","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"event","type":"dfn","url":"#event"},
"#event-name": {"displayText":"event name","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"event name","type":"dfn","url":"#event-name"},
"#event-type": {"displayText":"event type","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"event type","type":"dfn","url":"#event-type"},
"#extension-capabilities": {"displayText":"extension capabilities","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"extension capabilities","type":"dfn","url":"#extension-capabilities"},
"#extension-modules": {"displayText":"extension modules","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"extension modules","type":"dfn","url":"#extension-modules"},
"#generating-a-uuid": {"displayText":"generating a uuid","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"generating a uuid","type":"dfn","url":"#generating-a-uuid"},
"#get-settings": {"displayText":"get settings","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"get settings","type":"dfn","url":"#get-settings"},
"#handle-a-connection-closing": {"displayText":"handle a connection closing","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"handle a connection closing","type":"dfn","url":"#handle-a-connection-closing"},
"#handle-an-incoming-message": {"displayText":"handle an incoming message","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"handle an incoming message","type":"dfn","url":"#handle-an-incoming-message"},
"#local-end": {"displayText":"local end","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"local end","type":"dfn","url":"#local-end"},
"#match-capabilities": {"displayText":"match capabilities","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"match capabilities","type":"dfn","url":"#match-capabilities"},
"#modify-setting": {"displayText":"modify setting","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"modify setting","type":"dfn","url":"#modify-setting"},
"#module": {"displayText":"module","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"module","type":"dfn","url":"#module"},
"#module-name": {"displayText":"module name","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"module name","type":"dfn","url":"#module-name"},
"#press-keys": {"displayText":"press keys","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"press keys","type":"dfn","url":"#press-keys"},
"#process-capabilities": {"displayText":"process capabilities","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"process capabilities","type":"dfn","url":"#process-capabilities"},
"#remote-end": {"displayText":"remote end","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"remote end","type":"dfn","url":"#remote-end"},
"#remote-end-active-listeners": {"displayText":"active listeners","export":true,"for_":["remote end"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"active listeners","type":"dfn","url":"#remote-end-active-listeners"},
"#remote-end-active-sessions": {"displayText":"active sessions","export":true,"for_":["remote end"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"active sessions","type":"dfn","url":"#remote-end-active-sessions"},
"#remote-end-event-trigger": {"displayText":"remote end event trigger","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"remote end event trigger","type":"dfn","url":"#remote-end-event-trigger"},
"#remote-end-steps": {"displayText":"remote end steps","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"remote end steps","type":"dfn","url":"#remote-end-steps"},
"#remote-end-supported-settings": {"displayText":"supported settings","export":true,"for_":["remote end"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"supported settings","type":"dfn","url":"#remote-end-supported-settings"},
"#remote-end-table-of-extension-user-intents": {"displayText":"table of extension user intents","export":true,"for_":["remote end"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"table of extension user intents","type":"dfn","url":"#remote-end-table-of-extension-user-intents"},
"#remote-end-websocket-connections-not-associated-with-a-session": {"displayText":"websocket connections not associated with a session","export":true,"for_":["remote end"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"websocket connections not associated with a session","type":"dfn","url":"#remote-end-websocket-connections-not-associated-with-a-session"},
"#result-type": {"displayText":"result type","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"result type","type":"dfn","url":"#result-type"},
"#send-an-error-response": {"displayText":"send an error response","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"send an error response","type":"dfn","url":"#send-an-error-response"},
"#session": {"displayText":"session","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"session","type":"dfn","url":"#session"},
"#session-associated-with-connection": {"displayText":"associated with connection","export":true,"for_":["session"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"associated with connection","type":"dfn","url":"#session-associated-with-connection"},
"#session-session-id": {"displayText":"session id","export":true,"for_":["session"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"session id","type":"dfn","url":"#session-session-id"},
"#session-session-websocket-connections": {"displayText":"session websocket connections","export":true,"for_":["session"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"session websocket connections","type":"dfn","url":"#session-session-websocket-connections"},
"#set-of-all-command-names": {"displayText":"set of all command names","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"set of all command names","type":"dfn","url":"#set-of-all-command-names"},
"#settingssetsettings": {"displayText":"settings.setsettings","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"settings.setsettings","type":"dfn","url":"#settingssetsettings"},
"#should-be-withheld": {"displayText":"should be withheld","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"should be withheld","type":"dfn","url":"#should-be-withheld"},
"#start-listening-for-a-websocket-connection": {"displayText":"start listening for a websocket connection","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"start listening for a websocket connection","type":"dfn","url":"#start-listening-for-a-websocket-connection"},
"#static-command": {"displayText":"static command","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"static command","type":"dfn","url":"#static-command"},
"#success": {"displayText":"success","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"success","type":"dfn","url":"#success"},
"#table-of-standard-user-intents": {"displayText":"table of standard user intents","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"table of standard user intents","type":"dfn","url":"#table-of-standard-user-intents"},
"#try": {"displayText":"trying","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"trying","type":"dfn","url":"#try"},
"#uuid": {"displayText":"uuid","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"uuid","type":"dfn","url":"#uuid"},
"#validate-setting-name": {"displayText":"validate setting name","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"validate setting name","type":"dfn","url":"#validate-setting-name"},
"#websocket-connection": {"displayText":"websocket connection","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"websocket connection","type":"dfn","url":"#websocket-connection"},
"#websocket-listener": {"displayText":"websocket listener","export":true,"for_":[],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"websocket listener","type":"dfn","url":"#websocket-listener"},
"#websocket-listener-host": {"displayText":"host","export":true,"for_":["WebSocket listener"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"host","type":"dfn","url":"#websocket-listener-host"},
"#websocket-listener-port": {"displayText":"port","export":true,"for_":["WebSocket listener"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"port","type":"dfn","url":"#websocket-listener-port"},
"#websocket-listener-secure-flag": {"displayText":"secure flag","export":true,"for_":["WebSocket listener"],"level":"1","normative":true,"shortname":"at-driver","spec":"at-driver-1","status":"local","text":"secure flag","type":"dfn","url":"#websocket-listener-secure-flag"},
"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel": {"displayText":"in parallel","export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"in parallel","type":"dfn","url":"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel"},
"https://infra.spec.whatwg.org/#ascii-lowercase": {"displayText":"ASCII lowercase","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii lowercase","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"https://infra.spec.whatwg.org/#assert": {"displayText":"assert","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"assert","type":"dfn","url":"https://infra.spec.whatwg.org/#assert"},
"https://infra.spec.whatwg.org/#implementation-defined": {"displayText":"implementation-defined","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"implementation-defined","type":"dfn","url":"https://infra.spec.whatwg.org/#implementation-defined"},
"https://infra.spec.whatwg.org/#list": {"displayText":"list","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"list","type":"dfn","url":"https://infra.spec.whatwg.org/#list"},
"https://infra.spec.whatwg.org/#list-append": {"displayText":"append","export":true,"for_":["list"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#list-append"},
"https://infra.spec.whatwg.org/#list-contain": {"displayText":"contain","export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"contain","type":"dfn","url":"https://infra.spec.whatwg.org/#list-contain"},
"https://infra.spec.whatwg.org/#list-empty": {"displayText":"empty","export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"empty","type":"dfn","url":"https://infra.spec.whatwg.org/#list-empty"},
"https://infra.spec.whatwg.org/#list-iterate": {"displayText":"for each","export":true,"for_":["list","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"for each","type":"dfn","url":"https://infra.spec.whatwg.org/#list-iterate"},
"https://infra.spec.whatwg.org/#map-exists": {"displayText":"exist","export":true,"for_":["map"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"exist","type":"dfn","url":"https://infra.spec.whatwg.org/#map-exists"},
"https://infra.spec.whatwg.org/#map-iterate": {"displayText":"for each","export":true,"for_":["map"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"for each","type":"dfn","url":"https://infra.spec.whatwg.org/#map-iterate"},
"https://infra.spec.whatwg.org/#map-set": {"displayText":"set","export":true,"for_":["map"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"set","type":"dfn","url":"https://infra.spec.whatwg.org/#map-set"},
"https://infra.spec.whatwg.org/#map-size": {"displayText":"size","export":true,"for_":["map"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"size","type":"dfn","url":"https://infra.spec.whatwg.org/#map-size"},
"https://infra.spec.whatwg.org/#ordered-map": {"displayText":"map","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"map","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-map"},
"https://infra.spec.whatwg.org/#ordered-set": {"displayText":"set","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"set","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-set"},
"https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value": {"displayText":"parse JSON into Infra values","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"parse json into infra values","type":"dfn","url":"https://infra.spec.whatwg.org/#parse-a-json-string-to-an-infra-value"},
"https://infra.spec.whatwg.org/#scalar-value-string": {"displayText":"scalar value string","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"scalar value string","type":"dfn","url":"https://infra.spec.whatwg.org/#scalar-value-string"},
"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes": {"displayText":"serialize an Infra value to JSON bytes","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"serialize an infra value to json bytes","type":"dfn","url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"https://infra.spec.whatwg.org/#set-append": {"displayText":"append","export":true,"for_":["set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#set-append"},
"https://infra.spec.whatwg.org/#string": {"displayText":"string","export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"string","type":"dfn","url":"https://infra.spec.whatwg.org/#string"},
"https://www.rfc-editor.org/rfc/rfc8610#appendix-D": {"displayText":"uint","export":true,"for_":[],"level":"1","normative":true,"shortname":"rfc8610","spec":"rfc8610","status":"current","text":"uint","type":"cddl-type","url":"https://www.rfc-editor.org/rfc/rfc8610#appendix-D"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.displayText.toLowerCase() != linkText.toLowerCase()) {
        // Give the original term if it's being displayed in a different way.
        // But allow casing differences, they're insignificant.
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.displayText)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const refHintKey = link.getAttribute("data-refhint-key");
    let key = url;
    if(refHintKey) {
        key = refHintKey + "_" + url;
    }
    const ref = refsData[key];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>